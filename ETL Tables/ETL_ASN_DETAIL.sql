-- GOLD
CREATE OR REPLACE TABLE ETL.GOLD_ARCH.ASN_DETAIL
AS
    SELECT 
    ASN_DETAIL_ID,
	ASN_ID,
	WEIGHT_UOM_ID_BASE,
	CHECKSUM,
	INV_DISPOSITION,
	PPACK_GRP_CODE,
	PROCESSED_FOR_TRLR_MOVES,
	HIBERNATE_VERSION,
	TIER_PER_PALLET,
	SEQ_NBR,
	NBR_OF_PACK_FOR_CATCH_WT,
	TC_PURCHASE_ORDERS_ID,
	ORDER_TYPE_DESC,
	PACKAGE_TYPE_DESC,
	SKU_ATTR_2,
	SKU_ATTR_3,
	SKU_ATTR_1,
	SKU_ATTR_4,
	SKU_ATTR_5,
	TC_ORDER_LINE_ID,
	SHIPPED_LPN_COUNT,
	QTY_UOM_ID,
	CREATED_SOURCE_TYPE,
	STD_CASE_QTY,
	MFG_DATE,
	STD_SUB_PACK_QTY,
	RECEIVED_QTY,
	BUSINESS_PARTNER_ID,
	ACTUAL_WEIGHT_PACK_COUNT,
	CREATED_DTTM,
	RECEIVED_LPN_COUNT,
	EXP_RECEIVE_CONDITION_CODE,
	ACTUAL_WEIGHT_RECEIVED,
	SKU_NAME,
	INVN_TYPE,
	ACTUAL_WEIGHT,
	QTY_UOM_ID_BASE,
	EPC_TRACKING_RFID_VALUE,
	SKU_ID,
	PRE_RECEIPT_STATUS,
	TC_ORDER_ID,
	PRICE_TIX_AVAIL,
	REF_FIELD_9,
	TC_PO_LINE_ID,
	REF_FIELD_1,
	REF_FIELD_2,
	REF_FIELD_3,
	REF_FIELD_4,
	REF_FIELD_5,
	REF_FIELD_6,
	REF_FIELD_7,
	LPN_PER_TIER,
	REF_FIELD_8,
	LAST_UPDATED_SOURCE_TYPE,
	CREATED_SOURCE,
	WEIGHT_UOM_ID,
	CUT_NBR,
	QUALITY_CHECK_HOLD_UPON_RCPT,
	EXPIRE_DATE,
	LAST_UPDATED_DTTM,
	DISPOSITION_TYPE,
	PURCHASE_ORDERS_LINE_ITEM_ID,
	MFG_PLNT,
	REFERENCE_ORDER_NBR,
	PUTWY_TYPE,
	IS_ASSOCIATED_TO_OUTBOUND,
	BATCH_NBR,
	TC_COMPANY_ID,
	CNTRY_OF_ORGN,
	REF_FIELD_10,
	PACKAGE_TYPE_ID,
	IS_CLOSED,
	REGION_ID,
	SHIPPED_QTY,
	PROD_STAT,
	PACKAGE_TYPE_INSTANCE,
	LAST_UPDATED_SOURCE,
	RETAIL_PRICE,
	INVENTORY_SEGMENT_ID,
	ASN_RECV_RULES,
	INCUBATION_DATE,
	ORDER_LINE_ITEM_ID,
	IS_CANCELLED,
	STD_PACK_QTY,
	REF_NUM1,
	QTY_CONV_FACTOR,
	REF_NUM3,
	REF_NUM2,
	REF_NUM5,
	PROC_IMMD_NEEDS,
	REF_NUM4,
	ASN_DETAIL_STATUS,
	PURCHASE_ORDERS_ID,
	EPC_REQ_ON_ALL_CASES,
	SHIP_BY_DATE,
	EXT_PLAN_ID,
	GTIN,
	ORDER_ID,
	UNITS_ASSIGNED_TO_LPN,
	current_timestamp() AS ARCHIVE_DTTM,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED

    FROM XBPRDWMGOLD.PRD_GOLD_GB_XBWM19WM.ASN_DETAIL
    WHERE ASN_DETAIL.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())

    UNION

    SELECT 
	ASN_DETAIL_ID,
	ASN_ID,
	WEIGHT_UOM_ID_BASE,
	CHECKSUM,
	INV_DISPOSITION,
	PPACK_GRP_CODE,
	PROCESSED_FOR_TRLR_MOVES,
	HIBERNATE_VERSION,
	TIER_PER_PALLET,
	SEQ_NBR,
	NBR_OF_PACK_FOR_CATCH_WT,
	TC_PURCHASE_ORDERS_ID,
	ORDER_TYPE_DESC,
	PACKAGE_TYPE_DESC,
	SKU_ATTR_2,
	SKU_ATTR_3,
	SKU_ATTR_1,
	SKU_ATTR_4,
	SKU_ATTR_5,
	TC_ORDER_LINE_ID,
	SHIPPED_LPN_COUNT,
	QTY_UOM_ID,
	CREATED_SOURCE_TYPE,
	STD_CASE_QTY,
	MFG_DATE,
	STD_SUB_PACK_QTY,
	RECEIVED_QTY,
	BUSINESS_PARTNER_ID,
	ACTUAL_WEIGHT_PACK_COUNT,
	CREATED_DTTM,
	RECEIVED_LPN_COUNT,
	EXP_RECEIVE_CONDITION_CODE,
	ACTUAL_WEIGHT_RECEIVED,
	SKU_NAME,
	INVN_TYPE,
	ACTUAL_WEIGHT,
	QTY_UOM_ID_BASE,
	EPC_TRACKING_RFID_VALUE,
	SKU_ID,
	PRE_RECEIPT_STATUS,
	TC_ORDER_ID,
	PRICE_TIX_AVAIL,
	REF_FIELD_9,
	TC_PO_LINE_ID,
	REF_FIELD_1,
	REF_FIELD_2,
	REF_FIELD_3,
	REF_FIELD_4,
	REF_FIELD_5,
	REF_FIELD_6,
	REF_FIELD_7,
	LPN_PER_TIER,
	REF_FIELD_8,
	LAST_UPDATED_SOURCE_TYPE,
	CREATED_SOURCE,
	WEIGHT_UOM_ID,
	CUT_NBR,
	QUALITY_CHECK_HOLD_UPON_RCPT,
	EXPIRE_DATE,
	LAST_UPDATED_DTTM,
	DISPOSITION_TYPE,
	PURCHASE_ORDERS_LINE_ITEM_ID,
	MFG_PLNT,
	REFERENCE_ORDER_NBR,
	PUTWY_TYPE,
	IS_ASSOCIATED_TO_OUTBOUND,
	BATCH_NBR,
	TC_COMPANY_ID,
	CNTRY_OF_ORGN,
	REF_FIELD_10,
	PACKAGE_TYPE_ID,
	IS_CLOSED,
	REGION_ID,
	SHIPPED_QTY,
	PROD_STAT,
	PACKAGE_TYPE_INSTANCE,
	LAST_UPDATED_SOURCE,
	RETAIL_PRICE,
	INVENTORY_SEGMENT_ID,
	ASN_RECV_RULES,
	INCUBATION_DATE,
	ORDER_LINE_ITEM_ID,
	IS_CANCELLED,
	STD_PACK_QTY,
	REF_NUM1,
	QTY_CONV_FACTOR,
	REF_NUM3,
	REF_NUM2,
	REF_NUM5,
	PROC_IMMD_NEEDS,
	REF_NUM4,
	ASN_DETAIL_STATUS,
	PURCHASE_ORDERS_ID,
	EPC_REQ_ON_ALL_CASES,
	SHIP_BY_DATE,
	EXT_PLAN_ID,
	GTIN,
	ORDER_ID,
	UNITS_ASSIGNED_TO_LPN,
	current_timestamp() AS ARCHIVE_DTTM,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED

    FROM XBPRDWMGOLD.PRD_GOLD_J_XBWM19WM.ASN_DETAIL
    WHERE ASN_DETAIL.ASN_DETAIL_ID  NOT IN (SELECT ASN_DETAIL_ID FROM XBPRDWMGOLD.PRD_GOLD_GB_XBWM19WM.ASN_DETAIL WHERE CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE()))

    UNION

    SELECT 
    ASN_DETAIL_ID,
	ASN_ID,
	WEIGHT_UOM_ID_BASE,
	CHECKSUM,
	INV_DISPOSITION,
	PPACK_GRP_CODE,
	PROCESSED_FOR_TRLR_MOVES,
	HIBERNATE_VERSION,
	TIER_PER_PALLET,
	SEQ_NBR,
	NBR_OF_PACK_FOR_CATCH_WT,
	TC_PURCHASE_ORDERS_ID,
	ORDER_TYPE_DESC,
	PACKAGE_TYPE_DESC,
	SKU_ATTR_2,
	SKU_ATTR_3,
	SKU_ATTR_1,
	SKU_ATTR_4,
	SKU_ATTR_5,
	TC_ORDER_LINE_ID,
	SHIPPED_LPN_COUNT,
	QTY_UOM_ID,
	CREATED_SOURCE_TYPE,
	STD_CASE_QTY,
	MFG_DATE,
	STD_SUB_PACK_QTY,
	RECEIVED_QTY,
	BUSINESS_PARTNER_ID,
	ACTUAL_WEIGHT_PACK_COUNT,
	CREATED_DTTM,
	RECEIVED_LPN_COUNT,
	EXP_RECEIVE_CONDITION_CODE,
	ACTUAL_WEIGHT_RECEIVED,
	SKU_NAME,
	INVN_TYPE,
	ACTUAL_WEIGHT,
	QTY_UOM_ID_BASE,
	EPC_TRACKING_RFID_VALUE,
	SKU_ID,
	PRE_RECEIPT_STATUS,
	TC_ORDER_ID,
	PRICE_TIX_AVAIL,
	REF_FIELD_9,
	TC_PO_LINE_ID,
	REF_FIELD_1,
	REF_FIELD_2,
	REF_FIELD_3,
	REF_FIELD_4,
	REF_FIELD_5,
	REF_FIELD_6,
	REF_FIELD_7,
	LPN_PER_TIER,
	REF_FIELD_8,
	LAST_UPDATED_SOURCE_TYPE,
	CREATED_SOURCE,
	WEIGHT_UOM_ID,
	CUT_NBR,
	QUALITY_CHECK_HOLD_UPON_RCPT,
	EXPIRE_DATE,
	LAST_UPDATED_DTTM,
	DISPOSITION_TYPE,
	PURCHASE_ORDERS_LINE_ITEM_ID,
	MFG_PLNT,
	REFERENCE_ORDER_NBR,
	PUTWY_TYPE,
	IS_ASSOCIATED_TO_OUTBOUND,
	BATCH_NBR,
	TC_COMPANY_ID,
	CNTRY_OF_ORGN,
	REF_FIELD_10,
	PACKAGE_TYPE_ID,
	IS_CLOSED,
	REGION_ID,
	SHIPPED_QTY,
	PROD_STAT,
	PACKAGE_TYPE_INSTANCE,
	LAST_UPDATED_SOURCE,
	RETAIL_PRICE,
	INVENTORY_SEGMENT_ID,
	ASN_RECV_RULES,
	INCUBATION_DATE,
	ORDER_LINE_ITEM_ID,
	IS_CANCELLED,
	STD_PACK_QTY,
	REF_NUM1,
	QTY_CONV_FACTOR,
	REF_NUM3,
	REF_NUM2,
	REF_NUM5,
	PROC_IMMD_NEEDS,
	REF_NUM4,
	ASN_DETAIL_STATUS,
	PURCHASE_ORDERS_ID,
	EPC_REQ_ON_ALL_CASES,
	SHIP_BY_DATE,
	EXT_PLAN_ID,
	GTIN,
	ORDER_ID,
	UNITS_ASSIGNED_TO_LPN,
	ARCHIVE_DTTM,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED
    
    FROM XBPRDARCHGOLD.ARCH_GOLD_G_XBWM19ARCH.ASN_DETAIL
    WHERE ASN_DETAIL.ASN_DETAIL_ID  NOT IN (
    SELECT ASN_DETAIL_ID FROM XBPRDWMGOLD.PRD_GOLD_GB_XBWM19WM.ASN_DETAIL WHERE ASN_DETAIL.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())
    )
    AND ASN_DETAIL.ASN_DETAIL_ID  NOT IN (SELECT ASN_DETAIL_ID FROM XBPRDWMGOLD.PRD_GOLD_J_XBWM19WM.ASN_DETAIL)
    
;

-- SILVER
CREATE OR REPLACE TABLE ETL.SILVER_ARCH.ASN_DETAIL
AS
    SELECT 
 
	ASN_DETAIL_ID,
	ASN_ID,
	WEIGHT_UOM_ID_BASE,
	CHECKSUM,
	INV_DISPOSITION,
	PPACK_GRP_CODE,
	PROCESSED_FOR_TRLR_MOVES,
	HIBERNATE_VERSION,
	TIER_PER_PALLET,
	SEQ_NBR,
	NBR_OF_PACK_FOR_CATCH_WT,
	TC_PURCHASE_ORDERS_ID,
	ORDER_TYPE_DESC,
	PACKAGE_TYPE_DESC,
	SKU_ATTR_2,
	SKU_ATTR_3,
	SKU_ATTR_1,
	SKU_ATTR_4,
	SKU_ATTR_5,
	TC_ORDER_LINE_ID,
	SHIPPED_LPN_COUNT,
	QTY_UOM_ID,
	CREATED_SOURCE_TYPE,
	STD_CASE_QTY,
	MFG_DATE,
	STD_SUB_PACK_QTY,
	RECEIVED_QTY,
	BUSINESS_PARTNER_ID,
	ACTUAL_WEIGHT_PACK_COUNT,
	CREATED_DTTM,
	RECEIVED_LPN_COUNT,
	EXP_RECEIVE_CONDITION_CODE,
	ACTUAL_WEIGHT_RECEIVED,
	SKU_NAME,
	INVN_TYPE,
	ACTUAL_WEIGHT,
	QTY_UOM_ID_BASE,
	EPC_TRACKING_RFID_VALUE,
	SKU_ID,
	PRE_RECEIPT_STATUS,
	TC_ORDER_ID,
	PRICE_TIX_AVAIL,
	REF_FIELD_9,
	TC_PO_LINE_ID,
	REF_FIELD_1,
	REF_FIELD_2,
	REF_FIELD_3,
	REF_FIELD_4,
	REF_FIELD_5,
	REF_FIELD_6,
	REF_FIELD_7,
	LPN_PER_TIER,
	REF_FIELD_8,
	LAST_UPDATED_SOURCE_TYPE,
	CREATED_SOURCE,
	WEIGHT_UOM_ID,
	CUT_NBR,
	QUALITY_CHECK_HOLD_UPON_RCPT,
	EXPIRE_DATE,
	LAST_UPDATED_DTTM,
	DISPOSITION_TYPE,
	PURCHASE_ORDERS_LINE_ITEM_ID,
	MFG_PLNT,
	REFERENCE_ORDER_NBR,
	PUTWY_TYPE,
	IS_ASSOCIATED_TO_OUTBOUND,
	BATCH_NBR,
	TC_COMPANY_ID,
	CNTRY_OF_ORGN,
	REF_FIELD_10,
	PACKAGE_TYPE_ID,
	IS_CLOSED,
	REGION_ID,
	SHIPPED_QTY,
	PROD_STAT,
	PACKAGE_TYPE_INSTANCE,
	LAST_UPDATED_SOURCE,
	RETAIL_PRICE,
	INVENTORY_SEGMENT_ID,
	ASN_RECV_RULES,
	INCUBATION_DATE,
	ORDER_LINE_ITEM_ID,
	IS_CANCELLED,
	STD_PACK_QTY,
	REF_NUM1,
	QTY_CONV_FACTOR,
	REF_NUM3,
	REF_NUM2,
	REF_NUM5,
	PROC_IMMD_NEEDS,
	REF_NUM4,
	ASN_DETAIL_STATUS,
	PURCHASE_ORDERS_ID,
	EPC_REQ_ON_ALL_CASES,
	SHIP_BY_DATE,
	EXT_PLAN_ID,
	GTIN,
	ORDER_ID,
	UNITS_ASSIGNED_TO_LPN,
	current_timestamp() AS ARCHIVE_DTTM,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED

    FROM XBPRDWMSILVER.PRD_SILVER_GB_XBDBTJ3WM.ASN_DETAIL
    WHERE ASN_DETAIL.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())

    UNION

    SELECT 
   
	ASN_DETAIL_ID,
	ASN_ID,
	WEIGHT_UOM_ID_BASE,
	CHECKSUM,
	INV_DISPOSITION,
	PPACK_GRP_CODE,
	PROCESSED_FOR_TRLR_MOVES,
	HIBERNATE_VERSION,
	TIER_PER_PALLET,
	SEQ_NBR,
	NBR_OF_PACK_FOR_CATCH_WT,
	TC_PURCHASE_ORDERS_ID,
	ORDER_TYPE_DESC,
	PACKAGE_TYPE_DESC,
	SKU_ATTR_2,
	SKU_ATTR_3,
	SKU_ATTR_1,
	SKU_ATTR_4,
	SKU_ATTR_5,
	TC_ORDER_LINE_ID,
	SHIPPED_LPN_COUNT,
	QTY_UOM_ID,
	CREATED_SOURCE_TYPE,
	STD_CASE_QTY,
	MFG_DATE,
	STD_SUB_PACK_QTY,
	RECEIVED_QTY,
	BUSINESS_PARTNER_ID,
	ACTUAL_WEIGHT_PACK_COUNT,
	CREATED_DTTM,
	RECEIVED_LPN_COUNT,
	EXP_RECEIVE_CONDITION_CODE,
	ACTUAL_WEIGHT_RECEIVED,
	SKU_NAME,
	INVN_TYPE,
	ACTUAL_WEIGHT,
	QTY_UOM_ID_BASE,
	EPC_TRACKING_RFID_VALUE,
	SKU_ID,
	PRE_RECEIPT_STATUS,
	TC_ORDER_ID,
	PRICE_TIX_AVAIL,
	REF_FIELD_9,
	TC_PO_LINE_ID,
	REF_FIELD_1,
	REF_FIELD_2,
	REF_FIELD_3,
	REF_FIELD_4,
	REF_FIELD_5,
	REF_FIELD_6,
	REF_FIELD_7,
	LPN_PER_TIER,
	REF_FIELD_8,
	LAST_UPDATED_SOURCE_TYPE,
	CREATED_SOURCE,
	WEIGHT_UOM_ID,
	CUT_NBR,
	QUALITY_CHECK_HOLD_UPON_RCPT,
	EXPIRE_DATE,
	LAST_UPDATED_DTTM,
	DISPOSITION_TYPE,
	PURCHASE_ORDERS_LINE_ITEM_ID,
	MFG_PLNT,
	REFERENCE_ORDER_NBR,
	PUTWY_TYPE,
	IS_ASSOCIATED_TO_OUTBOUND,
	BATCH_NBR,
	TC_COMPANY_ID,
	CNTRY_OF_ORGN,
	REF_FIELD_10,
	PACKAGE_TYPE_ID,
	IS_CLOSED,
	REGION_ID,
	SHIPPED_QTY,
	PROD_STAT,
	PACKAGE_TYPE_INSTANCE,
	LAST_UPDATED_SOURCE,
	RETAIL_PRICE,
	INVENTORY_SEGMENT_ID,
	ASN_RECV_RULES,
	INCUBATION_DATE,
	ORDER_LINE_ITEM_ID,
	IS_CANCELLED,
	STD_PACK_QTY,
	REF_NUM1,
	QTY_CONV_FACTOR,
	REF_NUM3,
	REF_NUM2,
	REF_NUM5,
	PROC_IMMD_NEEDS,
	REF_NUM4,
	ASN_DETAIL_STATUS,
	PURCHASE_ORDERS_ID,
	EPC_REQ_ON_ALL_CASES,
	SHIP_BY_DATE,
	EXT_PLAN_ID,
	GTIN,
	ORDER_ID,
	UNITS_ASSIGNED_TO_LPN,
	current_timestamp() AS ARCHIVE_DTTM,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED

    FROM XBPRDWMSILVER.PRD_SILVER_J_XBDBTJ3WM.ASN_DETAIL
    WHERE ASN_DETAIL.ASN_DETAIL_ID  NOT IN (SELECT ASN_DETAIL_ID FROM XBPRDWMSILVER.PRD_SILVER_GB_XBDBTJ3WM.ASN_DETAIL WHERE CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE()))

    UNION

    SELECT 
    ASN_DETAIL_ID,
	ASN_ID,
	WEIGHT_UOM_ID_BASE,
	CHECKSUM,
	INV_DISPOSITION,
	PPACK_GRP_CODE,
	PROCESSED_FOR_TRLR_MOVES,
	HIBERNATE_VERSION,
	TIER_PER_PALLET,
	SEQ_NBR,
	NBR_OF_PACK_FOR_CATCH_WT,
	TC_PURCHASE_ORDERS_ID,
	ORDER_TYPE_DESC,
	PACKAGE_TYPE_DESC,
	SKU_ATTR_2,
	SKU_ATTR_3,
	SKU_ATTR_1,
	SKU_ATTR_4,
	SKU_ATTR_5,
	TC_ORDER_LINE_ID,
	SHIPPED_LPN_COUNT,
	QTY_UOM_ID,
	CREATED_SOURCE_TYPE,
	STD_CASE_QTY,
	MFG_DATE,
	STD_SUB_PACK_QTY,
	RECEIVED_QTY,
	BUSINESS_PARTNER_ID,
	ACTUAL_WEIGHT_PACK_COUNT,
	CREATED_DTTM,
	RECEIVED_LPN_COUNT,
	EXP_RECEIVE_CONDITION_CODE,
	ACTUAL_WEIGHT_RECEIVED,
	SKU_NAME,
	INVN_TYPE,
	ACTUAL_WEIGHT,
	QTY_UOM_ID_BASE,
	EPC_TRACKING_RFID_VALUE,
	SKU_ID,
	PRE_RECEIPT_STATUS,
	TC_ORDER_ID,
	PRICE_TIX_AVAIL,
	REF_FIELD_9,
	TC_PO_LINE_ID,
	REF_FIELD_1,
	REF_FIELD_2,
	REF_FIELD_3,
	REF_FIELD_4,
	REF_FIELD_5,
	REF_FIELD_6,
	REF_FIELD_7,
	LPN_PER_TIER,
	REF_FIELD_8,
	LAST_UPDATED_SOURCE_TYPE,
	CREATED_SOURCE,
	WEIGHT_UOM_ID,
	CUT_NBR,
	QUALITY_CHECK_HOLD_UPON_RCPT,
	EXPIRE_DATE,
	LAST_UPDATED_DTTM,
	DISPOSITION_TYPE,
	PURCHASE_ORDERS_LINE_ITEM_ID,
	MFG_PLNT,
	REFERENCE_ORDER_NBR,
	PUTWY_TYPE,
	IS_ASSOCIATED_TO_OUTBOUND,
	BATCH_NBR,
	TC_COMPANY_ID,
	CNTRY_OF_ORGN,
	REF_FIELD_10,
	PACKAGE_TYPE_ID,
	IS_CLOSED,
	REGION_ID,
	SHIPPED_QTY,
	PROD_STAT,
	PACKAGE_TYPE_INSTANCE,
	LAST_UPDATED_SOURCE,
	RETAIL_PRICE,
	INVENTORY_SEGMENT_ID,
	ASN_RECV_RULES,
	INCUBATION_DATE,
	ORDER_LINE_ITEM_ID,
	IS_CANCELLED,
	STD_PACK_QTY,
	REF_NUM1,
	QTY_CONV_FACTOR,
	REF_NUM3,
	REF_NUM2,
	REF_NUM5,
	PROC_IMMD_NEEDS,
	REF_NUM4,
	ASN_DETAIL_STATUS,
	PURCHASE_ORDERS_ID,
	EPC_REQ_ON_ALL_CASES,
	SHIP_BY_DATE,
	EXT_PLAN_ID,
	GTIN,
	ORDER_ID,
	UNITS_ASSIGNED_TO_LPN,
	ARCHIVE_DTTM,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED
  
    FROM XBPRDARCHSILVER.ARCH_SILVER_G_XBWM19ARCH.ASN_DETAIL
    WHERE ASN_DETAIL.ASN_DETAIL_ID  NOT IN (
    SELECT ASN_DETAIL_ID FROM XBPRDWMSILVER.PRD_SILVER_GB_XBDBTJ3WM.ASN_DETAIL WHERE ASN_DETAIL.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())
    )
    AND ASN_DETAIL.ASN_DETAIL_ID  NOT IN (SELECT ASN_DETAIL_ID FROM XBPRDWMSILVER.PRD_SILVER_J_XBDBTJ3WM.ASN_DETAIL)
    
;

-- RY
CREATE OR REPLACE TABLE ETL.RY_ARCH.ASN_DETAIL
AS
    SELECT 
   
	ASN_DETAIL_ID,
	ASN_ID,
	WEIGHT_UOM_ID_BASE,
	CHECKSUM,
	INV_DISPOSITION,
	PPACK_GRP_CODE,
	PROCESSED_FOR_TRLR_MOVES,
	HIBERNATE_VERSION,
	TIER_PER_PALLET,
	SEQ_NBR,
	NBR_OF_PACK_FOR_CATCH_WT,
	TC_PURCHASE_ORDERS_ID,
	ORDER_TYPE_DESC,
	PACKAGE_TYPE_DESC,
	SKU_ATTR_2,
	SKU_ATTR_3,
	SKU_ATTR_1,
	SKU_ATTR_4,
	SKU_ATTR_5,
	TC_ORDER_LINE_ID,
	SHIPPED_LPN_COUNT,
	QTY_UOM_ID,
	CREATED_SOURCE_TYPE,
	STD_CASE_QTY,
	MFG_DATE,
	STD_SUB_PACK_QTY,
	RECEIVED_QTY,
	BUSINESS_PARTNER_ID,
	ACTUAL_WEIGHT_PACK_COUNT,
	CREATED_DTTM,
	RECEIVED_LPN_COUNT,
	EXP_RECEIVE_CONDITION_CODE,
	ACTUAL_WEIGHT_RECEIVED,
	SKU_NAME,
	INVN_TYPE,
	ACTUAL_WEIGHT,
	QTY_UOM_ID_BASE,
	EPC_TRACKING_RFID_VALUE,
	SKU_ID,
	PRE_RECEIPT_STATUS,
	TC_ORDER_ID,
	PRICE_TIX_AVAIL,
	REF_FIELD_9,
	TC_PO_LINE_ID,
	REF_FIELD_1,
	REF_FIELD_2,
	REF_FIELD_3,
	REF_FIELD_4,
	REF_FIELD_5,
	REF_FIELD_6,
	REF_FIELD_7,
	LPN_PER_TIER,
	REF_FIELD_8,
	LAST_UPDATED_SOURCE_TYPE,
	CREATED_SOURCE,
	WEIGHT_UOM_ID,
	CUT_NBR,
	QUALITY_CHECK_HOLD_UPON_RCPT,
	EXPIRE_DATE,
	LAST_UPDATED_DTTM,
	DISPOSITION_TYPE,
	PURCHASE_ORDERS_LINE_ITEM_ID,
	MFG_PLNT,
	REFERENCE_ORDER_NBR,
	PUTWY_TYPE,
	IS_ASSOCIATED_TO_OUTBOUND,
	BATCH_NBR,
	TC_COMPANY_ID,
	CNTRY_OF_ORGN,
	REF_FIELD_10,
	PACKAGE_TYPE_ID,
	IS_CLOSED,
	REGION_ID,
	SHIPPED_QTY,
	PROD_STAT,
	PACKAGE_TYPE_INSTANCE,
	LAST_UPDATED_SOURCE,
	RETAIL_PRICE,
	INVENTORY_SEGMENT_ID,
	ASN_RECV_RULES,
	INCUBATION_DATE,
	ORDER_LINE_ITEM_ID,
	IS_CANCELLED,
	STD_PACK_QTY,
	REF_NUM1,
	QTY_CONV_FACTOR,
	REF_NUM3,
	REF_NUM2,
	REF_NUM5,
	PROC_IMMD_NEEDS,
	REF_NUM4,
	ASN_DETAIL_STATUS,
	PURCHASE_ORDERS_ID,
	EPC_REQ_ON_ALL_CASES,
	SHIP_BY_DATE,
	EXT_PLAN_ID,
	GTIN,
	ORDER_ID,
	UNITS_ASSIGNED_TO_LPN,
	current_timestamp() AS ARCHIVE_DTTM,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED

    FROM XBPRDWMRY.PRD_RY_GB_XBORPRDWM.ASN_DETAIL
    WHERE ASN_DETAIL.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())

    UNION

    SELECT 
   
	ASN_DETAIL_ID,
	ASN_ID,
	WEIGHT_UOM_ID_BASE,
	CHECKSUM,
	INV_DISPOSITION,
	PPACK_GRP_CODE,
	PROCESSED_FOR_TRLR_MOVES,
	HIBERNATE_VERSION,
	TIER_PER_PALLET,
	SEQ_NBR,
	NBR_OF_PACK_FOR_CATCH_WT,
	TC_PURCHASE_ORDERS_ID,
	ORDER_TYPE_DESC,
	PACKAGE_TYPE_DESC,
	SKU_ATTR_2,
	SKU_ATTR_3,
	SKU_ATTR_1,
	SKU_ATTR_4,
	SKU_ATTR_5,
	TC_ORDER_LINE_ID,
	SHIPPED_LPN_COUNT,
	QTY_UOM_ID,
	CREATED_SOURCE_TYPE,
	STD_CASE_QTY,
	MFG_DATE,
	STD_SUB_PACK_QTY,
	RECEIVED_QTY,
	BUSINESS_PARTNER_ID,
	ACTUAL_WEIGHT_PACK_COUNT,
	CREATED_DTTM,
	RECEIVED_LPN_COUNT,
	EXP_RECEIVE_CONDITION_CODE,
	ACTUAL_WEIGHT_RECEIVED,
	SKU_NAME,
	INVN_TYPE,
	ACTUAL_WEIGHT,
	QTY_UOM_ID_BASE,
	EPC_TRACKING_RFID_VALUE,
	SKU_ID,
	PRE_RECEIPT_STATUS,
	TC_ORDER_ID,
	PRICE_TIX_AVAIL,
	REF_FIELD_9,
	TC_PO_LINE_ID,
	REF_FIELD_1,
	REF_FIELD_2,
	REF_FIELD_3,
	REF_FIELD_4,
	REF_FIELD_5,
	REF_FIELD_6,
	REF_FIELD_7,
	LPN_PER_TIER,
	REF_FIELD_8,
	LAST_UPDATED_SOURCE_TYPE,
	CREATED_SOURCE,
	WEIGHT_UOM_ID,
	CUT_NBR,
	QUALITY_CHECK_HOLD_UPON_RCPT,
	EXPIRE_DATE,
	LAST_UPDATED_DTTM,
	DISPOSITION_TYPE,
	PURCHASE_ORDERS_LINE_ITEM_ID,
	MFG_PLNT,
	REFERENCE_ORDER_NBR,
	PUTWY_TYPE,
	IS_ASSOCIATED_TO_OUTBOUND,
	BATCH_NBR,
	TC_COMPANY_ID,
	CNTRY_OF_ORGN,
	REF_FIELD_10,
	PACKAGE_TYPE_ID,
	IS_CLOSED,
	REGION_ID,
	SHIPPED_QTY,
	PROD_STAT,
	PACKAGE_TYPE_INSTANCE,
	LAST_UPDATED_SOURCE,
	RETAIL_PRICE,
	INVENTORY_SEGMENT_ID,
	ASN_RECV_RULES,
	INCUBATION_DATE,
	ORDER_LINE_ITEM_ID,
	IS_CANCELLED,
	STD_PACK_QTY,
	REF_NUM1,
	QTY_CONV_FACTOR,
	REF_NUM3,
	REF_NUM2,
	REF_NUM5,
	PROC_IMMD_NEEDS,
	REF_NUM4,
	ASN_DETAIL_STATUS,
	PURCHASE_ORDERS_ID,
	EPC_REQ_ON_ALL_CASES,
	SHIP_BY_DATE,
	EXT_PLAN_ID,
	GTIN,
	ORDER_ID,
	UNITS_ASSIGNED_TO_LPN,
	current_timestamp() AS ARCHIVE_DTTM,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED

    FROM XBPRDWMRY.PRD_RY_J_XBORPRDWM.ASN_DETAIL
    WHERE ASN_DETAIL.ASN_DETAIL_ID  NOT IN (SELECT ASN_DETAIL_ID FROM XBPRDWMRY.PRD_RY_GB_XBORPRDWM.ASN_DETAIL WHERE CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE()))

    UNION

    SELECT 
    ASN_DETAIL_ID,
	ASN_ID,
	WEIGHT_UOM_ID_BASE,
	CHECKSUM,
	INV_DISPOSITION,
	PPACK_GRP_CODE,
	PROCESSED_FOR_TRLR_MOVES,
	HIBERNATE_VERSION,
	TIER_PER_PALLET,
	SEQ_NBR,
	NBR_OF_PACK_FOR_CATCH_WT,
	TC_PURCHASE_ORDERS_ID,
	ORDER_TYPE_DESC,
	PACKAGE_TYPE_DESC,
	SKU_ATTR_2,
	SKU_ATTR_3,
	SKU_ATTR_1,
	SKU_ATTR_4,
	SKU_ATTR_5,
	TC_ORDER_LINE_ID,
	SHIPPED_LPN_COUNT,
	QTY_UOM_ID,
	CREATED_SOURCE_TYPE,
	STD_CASE_QTY,
	MFG_DATE,
	STD_SUB_PACK_QTY,
	RECEIVED_QTY,
	BUSINESS_PARTNER_ID,
	ACTUAL_WEIGHT_PACK_COUNT,
	CREATED_DTTM,
	RECEIVED_LPN_COUNT,
	EXP_RECEIVE_CONDITION_CODE,
	ACTUAL_WEIGHT_RECEIVED,
	SKU_NAME,
	INVN_TYPE,
	ACTUAL_WEIGHT,
	QTY_UOM_ID_BASE,
	EPC_TRACKING_RFID_VALUE,
	SKU_ID,
	PRE_RECEIPT_STATUS,
	TC_ORDER_ID,
	PRICE_TIX_AVAIL,
	REF_FIELD_9,
	TC_PO_LINE_ID,
	REF_FIELD_1,
	REF_FIELD_2,
	REF_FIELD_3,
	REF_FIELD_4,
	REF_FIELD_5,
	REF_FIELD_6,
	REF_FIELD_7,
	LPN_PER_TIER,
	REF_FIELD_8,
	LAST_UPDATED_SOURCE_TYPE,
	CREATED_SOURCE,
	WEIGHT_UOM_ID,
	CUT_NBR,
	QUALITY_CHECK_HOLD_UPON_RCPT,
	EXPIRE_DATE,
	LAST_UPDATED_DTTM,
	DISPOSITION_TYPE,
	PURCHASE_ORDERS_LINE_ITEM_ID,
	MFG_PLNT,
	REFERENCE_ORDER_NBR,
	PUTWY_TYPE,
	IS_ASSOCIATED_TO_OUTBOUND,
	BATCH_NBR,
	TC_COMPANY_ID,
	CNTRY_OF_ORGN,
	REF_FIELD_10,
	PACKAGE_TYPE_ID,
	IS_CLOSED,
	REGION_ID,
	SHIPPED_QTY,
	PROD_STAT,
	PACKAGE_TYPE_INSTANCE,
	LAST_UPDATED_SOURCE,
	RETAIL_PRICE,
	INVENTORY_SEGMENT_ID,
	ASN_RECV_RULES,
	INCUBATION_DATE,
	ORDER_LINE_ITEM_ID,
	IS_CANCELLED,
	STD_PACK_QTY,
	REF_NUM1,
	QTY_CONV_FACTOR,
	REF_NUM3,
	REF_NUM2,
	REF_NUM5,
	PROC_IMMD_NEEDS,
	REF_NUM4,
	ASN_DETAIL_STATUS,
	PURCHASE_ORDERS_ID,
	EPC_REQ_ON_ALL_CASES,
	SHIP_BY_DATE,
	EXT_PLAN_ID,
	GTIN,
	ORDER_ID,
	UNITS_ASSIGNED_TO_LPN,
	ARCHIVE_DTTM,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED
   
    FROM XBPRDARCHREYNOSA.ARCHIVE_REYNOSA_XBORPRDARCH.ASN_DETAIL
    WHERE ASN_DETAIL.ASN_DETAIL_ID  NOT IN (
    SELECT ASN_DETAIL_ID FROM XBPRDWMRY.PRD_RY_GB_XBORPRDWM.ASN_DETAIL WHERE ASN_DETAIL.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())
    )
    AND ASN_DETAIL.ASN_DETAIL_ID  NOT IN (SELECT ASN_DETAIL_ID FROM XBPRDWMRY.PRD_RY_J_XBORPRDWM.ASN_DETAIL)
    
;


--------------------------------------
---------------- SP_ASN_DETAIL GOLD
CALL ETL.GOLD_ARCH.SP_UPDATE_ETL_ASN_DETAIL_GOLD();

CREATE OR REPLACE PROCEDURE ETL.GOLD_ARCH.SP_UPDATE_ETL_ASN_DETAIL_GOLD()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER 
   AS
        BEGIN 
            MERGE INTO ETL.GOLD_ARCH.ASN_DETAIL AS TARGET
            USING
            (
                SELECT *, current_timestamp() AS ARCHIVE_DTTM
                FROM XBPRDWMGOLD.PRD_GOLD_GB_XBWM19WM.ASN_DETAIL
                WHERE ASN_DETAIL.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())
            ) AS SOURCE

            ON TARGET.ASN_DETAIL_ID = SOURCE.ASN_DETAIL_ID
                WHEN MATCHED AND TARGET.LAST_UPDATED_DTTM < SOURCE.LAST_UPDATED_DTTM 
                    THEN UPDATE SET
                        TARGET.ASN_DETAIL_ID = SOURCE.ASN_DETAIL_ID,
                    	TARGET.ASN_ID = SOURCE.ASN_ID,
                    	TARGET.WEIGHT_UOM_ID_BASE = SOURCE.WEIGHT_UOM_ID_BASE,
                    	TARGET.CHECKSUM = SOURCE.CHECKSUM,
                    	TARGET.INV_DISPOSITION = SOURCE.INV_DISPOSITION,
                    	TARGET.PPACK_GRP_CODE = SOURCE.PPACK_GRP_CODE,
                    	TARGET.PROCESSED_FOR_TRLR_MOVES = SOURCE.PROCESSED_FOR_TRLR_MOVES,
                    	TARGET.HIBERNATE_VERSION = SOURCE.HIBERNATE_VERSION,
                    	TARGET.TIER_PER_PALLET = SOURCE.TIER_PER_PALLET,
                    	TARGET.SEQ_NBR = SOURCE.SEQ_NBR,
                    	TARGET.NBR_OF_PACK_FOR_CATCH_WT = SOURCE.NBR_OF_PACK_FOR_CATCH_WT,
                    	TARGET.TC_PURCHASE_ORDERS_ID = SOURCE.TC_PURCHASE_ORDERS_ID,
                    	TARGET.ORDER_TYPE_DESC = SOURCE.ORDER_TYPE_DESC,
                    	TARGET.PACKAGE_TYPE_DESC = SOURCE.PACKAGE_TYPE_DESC,
                    	TARGET.SKU_ATTR_2 = SOURCE.SKU_ATTR_2,
                    	TARGET.SKU_ATTR_3 = SOURCE.SKU_ATTR_3,
                    	TARGET.SKU_ATTR_1 = SOURCE.SKU_ATTR_1,
                    	TARGET.SKU_ATTR_4 = SOURCE.SKU_ATTR_4,
                    	TARGET.SKU_ATTR_5 = SOURCE.SKU_ATTR_5,
                    	TARGET.TC_ORDER_LINE_ID = SOURCE.TC_ORDER_LINE_ID,
                    	TARGET.SHIPPED_LPN_COUNT = SOURCE.SHIPPED_LPN_COUNT,
                    	TARGET.QTY_UOM_ID = SOURCE.QTY_UOM_ID,
                    	TARGET.CREATED_SOURCE_TYPE = SOURCE.CREATED_SOURCE_TYPE,
                    	TARGET.STD_CASE_QTY = SOURCE.STD_CASE_QTY,
                    	TARGET.MFG_DATE = SOURCE.MFG_DATE,
                    	TARGET.STD_SUB_PACK_QTY = SOURCE.STD_SUB_PACK_QTY,
                    	TARGET.RECEIVED_QTY = SOURCE.RECEIVED_QTY,
                    	TARGET.BUSINESS_PARTNER_ID = SOURCE.BUSINESS_PARTNER_ID,
                    	TARGET.ACTUAL_WEIGHT_PACK_COUNT = SOURCE.ACTUAL_WEIGHT_PACK_COUNT,
                    	TARGET.CREATED_DTTM = SOURCE.CREATED_DTTM,
                    	TARGET.RECEIVED_LPN_COUNT = SOURCE.RECEIVED_LPN_COUNT,
                    	TARGET.EXP_RECEIVE_CONDITION_CODE = SOURCE.EXP_RECEIVE_CONDITION_CODE,
                    	TARGET.ACTUAL_WEIGHT_RECEIVED = SOURCE.ACTUAL_WEIGHT_RECEIVED,
                    	TARGET.SKU_NAME = SOURCE.SKU_NAME,
                    	TARGET.INVN_TYPE = SOURCE.INVN_TYPE,
                    	TARGET.ACTUAL_WEIGHT = SOURCE.ACTUAL_WEIGHT,
                    	TARGET.QTY_UOM_ID_BASE = SOURCE.QTY_UOM_ID_BASE,
                    	TARGET.EPC_TRACKING_RFID_VALUE = SOURCE.EPC_TRACKING_RFID_VALUE,
                    	TARGET.SKU_ID = SOURCE.SKU_ID,
                    	TARGET.PRE_RECEIPT_STATUS = SOURCE.PRE_RECEIPT_STATUS,
                    	TARGET.TC_ORDER_ID = SOURCE.TC_ORDER_ID,
                    	TARGET.PRICE_TIX_AVAIL = SOURCE.PRICE_TIX_AVAIL,
                    	TARGET.REF_FIELD_9 = SOURCE.REF_FIELD_9,
                    	TARGET.TC_PO_LINE_ID = SOURCE.TC_PO_LINE_ID,
                    	TARGET.REF_FIELD_1 = SOURCE.REF_FIELD_1,
                    	TARGET.REF_FIELD_2 = SOURCE.REF_FIELD_2,
                    	TARGET.REF_FIELD_3 = SOURCE.REF_FIELD_3,
                    	TARGET.REF_FIELD_4 = SOURCE.REF_FIELD_4,
                    	TARGET.REF_FIELD_5 = SOURCE.REF_FIELD_5,
                    	TARGET.REF_FIELD_6 = SOURCE.REF_FIELD_6,
                    	TARGET.REF_FIELD_7 = SOURCE.REF_FIELD_7,
                    	TARGET.LPN_PER_TIER = SOURCE.LPN_PER_TIER,
                    	TARGET.REF_FIELD_8 = SOURCE.REF_FIELD_8,
                    	TARGET.LAST_UPDATED_SOURCE_TYPE = SOURCE.LAST_UPDATED_SOURCE_TYPE,
                    	TARGET.CREATED_SOURCE = SOURCE.CREATED_SOURCE,
                    	TARGET.WEIGHT_UOM_ID = SOURCE.WEIGHT_UOM_ID,
                    	TARGET.CUT_NBR = SOURCE.CUT_NBR,
                    	TARGET.QUALITY_CHECK_HOLD_UPON_RCPT = SOURCE.QUALITY_CHECK_HOLD_UPON_RCPT,
                    	TARGET.EXPIRE_DATE = SOURCE.EXPIRE_DATE,
                    	TARGET.LAST_UPDATED_DTTM = SOURCE.LAST_UPDATED_DTTM,
                    	TARGET.DISPOSITION_TYPE = SOURCE.DISPOSITION_TYPE,
                    	TARGET.PURCHASE_ORDERS_LINE_ITEM_ID = SOURCE.PURCHASE_ORDERS_LINE_ITEM_ID,
                    	TARGET.MFG_PLNT = SOURCE.MFG_PLNT,
                    	TARGET.REFERENCE_ORDER_NBR = SOURCE.REFERENCE_ORDER_NBR,
                    	TARGET.PUTWY_TYPE = SOURCE.PUTWY_TYPE,
                    	TARGET.IS_ASSOCIATED_TO_OUTBOUND = SOURCE.IS_ASSOCIATED_TO_OUTBOUND,
                    	TARGET.BATCH_NBR = SOURCE.BATCH_NBR,
                    	TARGET.TC_COMPANY_ID = SOURCE.TC_COMPANY_ID,
                    	TARGET.CNTRY_OF_ORGN = SOURCE.CNTRY_OF_ORGN,
                    	TARGET.REF_FIELD_10 = SOURCE.REF_FIELD_10,
                    	TARGET.PACKAGE_TYPE_ID = SOURCE.PACKAGE_TYPE_ID,
                    	TARGET.IS_CLOSED = SOURCE.IS_CLOSED,
                    	TARGET.REGION_ID = SOURCE.REGION_ID,
                    	TARGET.SHIPPED_QTY = SOURCE.SHIPPED_QTY,
                    	TARGET.PROD_STAT = SOURCE.PROD_STAT,
                    	TARGET.PACKAGE_TYPE_INSTANCE = SOURCE.PACKAGE_TYPE_INSTANCE,
                    	TARGET.LAST_UPDATED_SOURCE = SOURCE.LAST_UPDATED_SOURCE,
                    	TARGET.RETAIL_PRICE = SOURCE.RETAIL_PRICE,
                    	TARGET.INVENTORY_SEGMENT_ID = SOURCE.INVENTORY_SEGMENT_ID,
                    	TARGET.ASN_RECV_RULES = SOURCE.ASN_RECV_RULES,
                    	TARGET.INCUBATION_DATE = SOURCE.INCUBATION_DATE,
                    	TARGET.ORDER_LINE_ITEM_ID = SOURCE.ORDER_LINE_ITEM_ID,
                    	TARGET.IS_CANCELLED = SOURCE.IS_CANCELLED,
                    	TARGET.STD_PACK_QTY = SOURCE.STD_PACK_QTY,
                    	TARGET.REF_NUM1 = SOURCE.REF_NUM1,
                    	TARGET.QTY_CONV_FACTOR = SOURCE.QTY_CONV_FACTOR,
                    	TARGET.REF_NUM3 = SOURCE.REF_NUM3,
                    	TARGET.REF_NUM2 = SOURCE.REF_NUM2,
                    	TARGET.REF_NUM5 = SOURCE.REF_NUM5,
                    	TARGET.PROC_IMMD_NEEDS = SOURCE.PROC_IMMD_NEEDS,
                    	TARGET.REF_NUM4 = SOURCE.REF_NUM4,
                    	TARGET.ASN_DETAIL_STATUS = SOURCE.ASN_DETAIL_STATUS,
                    	TARGET.PURCHASE_ORDERS_ID = SOURCE.PURCHASE_ORDERS_ID,
                    	TARGET.EPC_REQ_ON_ALL_CASES = SOURCE.EPC_REQ_ON_ALL_CASES,
                    	TARGET.SHIP_BY_DATE = SOURCE.SHIP_BY_DATE,
                    	TARGET.EXT_PLAN_ID = SOURCE.EXT_PLAN_ID,
                    	TARGET.GTIN = SOURCE.GTIN,
                    	TARGET.ORDER_ID = SOURCE.ORDER_ID,
                    	TARGET.UNITS_ASSIGNED_TO_LPN = SOURCE.UNITS_ASSIGNED_TO_LPN,
                    	TARGET.ARCHIVE_DTTM = current_timestamp(),
                    	TARGET._FIVETRAN_DELETED = SOURCE._FIVETRAN_DELETED,
                    	TARGET._FIVETRAN_SYNCED = SOURCE._FIVETRAN_SYNCED
                WHEN NOT MATCHED 
                    THEN
                        INSERT (
                        ASN_DETAIL_ID,
                    	ASN_ID,
                    	WEIGHT_UOM_ID_BASE,
                    	CHECKSUM,
                    	INV_DISPOSITION,
                    	PPACK_GRP_CODE,
                    	PROCESSED_FOR_TRLR_MOVES,
                    	HIBERNATE_VERSION,
                    	TIER_PER_PALLET,
                    	SEQ_NBR,
                    	NBR_OF_PACK_FOR_CATCH_WT,
                    	TC_PURCHASE_ORDERS_ID,
                    	ORDER_TYPE_DESC,
                    	PACKAGE_TYPE_DESC,
                    	SKU_ATTR_2,
                    	SKU_ATTR_3,
                    	SKU_ATTR_1,
                    	SKU_ATTR_4,
                    	SKU_ATTR_5,
                    	TC_ORDER_LINE_ID,
                    	SHIPPED_LPN_COUNT,
                    	QTY_UOM_ID,
                    	CREATED_SOURCE_TYPE,
                    	STD_CASE_QTY,
                    	MFG_DATE,
                    	STD_SUB_PACK_QTY,
                    	RECEIVED_QTY,
                    	BUSINESS_PARTNER_ID,
                    	ACTUAL_WEIGHT_PACK_COUNT,
                    	CREATED_DTTM,
                    	RECEIVED_LPN_COUNT,
                    	EXP_RECEIVE_CONDITION_CODE,
                    	ACTUAL_WEIGHT_RECEIVED,
                    	SKU_NAME,
                    	INVN_TYPE,
                    	ACTUAL_WEIGHT,
                    	QTY_UOM_ID_BASE,
                    	EPC_TRACKING_RFID_VALUE,
                    	SKU_ID,
                    	PRE_RECEIPT_STATUS,
                    	TC_ORDER_ID,
                    	PRICE_TIX_AVAIL,
                    	REF_FIELD_9,
                    	TC_PO_LINE_ID,
                    	REF_FIELD_1,
                    	REF_FIELD_2,
                    	REF_FIELD_3,
                    	REF_FIELD_4,
                    	REF_FIELD_5,
                    	REF_FIELD_6,
                    	REF_FIELD_7,
                    	LPN_PER_TIER,
                    	REF_FIELD_8,
                    	LAST_UPDATED_SOURCE_TYPE,
                    	CREATED_SOURCE,
                    	WEIGHT_UOM_ID,
                    	CUT_NBR,
                    	QUALITY_CHECK_HOLD_UPON_RCPT,
                    	EXPIRE_DATE,
                    	LAST_UPDATED_DTTM,
                    	DISPOSITION_TYPE,
                    	PURCHASE_ORDERS_LINE_ITEM_ID,
                    	MFG_PLNT,
                    	REFERENCE_ORDER_NBR,
                    	PUTWY_TYPE,
                    	IS_ASSOCIATED_TO_OUTBOUND,
                    	BATCH_NBR,
                    	TC_COMPANY_ID,
                    	CNTRY_OF_ORGN,
                    	REF_FIELD_10,
                    	PACKAGE_TYPE_ID,
                    	IS_CLOSED,
                    	REGION_ID,
                    	SHIPPED_QTY,
                    	PROD_STAT,
                    	PACKAGE_TYPE_INSTANCE,
                    	LAST_UPDATED_SOURCE,
                    	RETAIL_PRICE,
                    	INVENTORY_SEGMENT_ID,
                    	ASN_RECV_RULES,
                    	INCUBATION_DATE,
                    	ORDER_LINE_ITEM_ID,
                    	IS_CANCELLED,
                    	STD_PACK_QTY,
                    	REF_NUM1,
                    	QTY_CONV_FACTOR,
                    	REF_NUM3,
                    	REF_NUM2,
                    	REF_NUM5,
                    	PROC_IMMD_NEEDS,
                    	REF_NUM4,
                    	ASN_DETAIL_STATUS,
                    	PURCHASE_ORDERS_ID,
                    	EPC_REQ_ON_ALL_CASES,
                    	SHIP_BY_DATE,
                    	EXT_PLAN_ID,
                    	GTIN,
                    	ORDER_ID,
                    	UNITS_ASSIGNED_TO_LPN,
                    	ARCHIVE_DTTM,
                    	_FIVETRAN_DELETED,
                    	_FIVETRAN_SYNCED
                        )
                        VALUES (
                        SOURCE.ASN_DETAIL_ID,
                        SOURCE.ASN_ID,
                        SOURCE.WEIGHT_UOM_ID_BASE,
                        SOURCE.CHECKSUM,
                        SOURCE.INV_DISPOSITION,
                        SOURCE.PPACK_GRP_CODE,
                        SOURCE.PROCESSED_FOR_TRLR_MOVES,
                        SOURCE.HIBERNATE_VERSION,
                        SOURCE.TIER_PER_PALLET,
                        SOURCE.SEQ_NBR,
                        SOURCE.NBR_OF_PACK_FOR_CATCH_WT,
                        SOURCE.TC_PURCHASE_ORDERS_ID,
                        SOURCE.ORDER_TYPE_DESC,
                        SOURCE.PACKAGE_TYPE_DESC,
                        SOURCE.SKU_ATTR_2,
                        SOURCE.SKU_ATTR_3,
                        SOURCE.SKU_ATTR_1,
                        SOURCE.SKU_ATTR_4,
                        SOURCE.SKU_ATTR_5,
                        SOURCE.TC_ORDER_LINE_ID,
                        SOURCE.SHIPPED_LPN_COUNT,
                        SOURCE.QTY_UOM_ID,
                        SOURCE.CREATED_SOURCE_TYPE,
                        SOURCE.STD_CASE_QTY,
                        SOURCE.MFG_DATE,
                        SOURCE.STD_SUB_PACK_QTY,
                        SOURCE.RECEIVED_QTY,
                        SOURCE.BUSINESS_PARTNER_ID,
                        SOURCE.ACTUAL_WEIGHT_PACK_COUNT,
                        SOURCE.CREATED_DTTM,
                        SOURCE.RECEIVED_LPN_COUNT,
                        SOURCE.EXP_RECEIVE_CONDITION_CODE,
                        SOURCE.ACTUAL_WEIGHT_RECEIVED,
                        SOURCE.SKU_NAME,
                        SOURCE.INVN_TYPE,
                        SOURCE.ACTUAL_WEIGHT,
                        SOURCE.QTY_UOM_ID_BASE,
                        SOURCE.EPC_TRACKING_RFID_VALUE,
                        SOURCE.SKU_ID,
                        SOURCE.PRE_RECEIPT_STATUS,
                        SOURCE.TC_ORDER_ID,
                        SOURCE.PRICE_TIX_AVAIL,
                        SOURCE.REF_FIELD_9,
                        SOURCE.TC_PO_LINE_ID,
                        SOURCE.REF_FIELD_1,
                        SOURCE.REF_FIELD_2,
                        SOURCE.REF_FIELD_3,
                        SOURCE.REF_FIELD_4,
                        SOURCE.REF_FIELD_5,
                        SOURCE.REF_FIELD_6,
                        SOURCE.REF_FIELD_7,
                        SOURCE.LPN_PER_TIER,
                        SOURCE.REF_FIELD_8,
                        SOURCE.LAST_UPDATED_SOURCE_TYPE,
                        SOURCE.CREATED_SOURCE,
                        SOURCE.WEIGHT_UOM_ID,
                        SOURCE.CUT_NBR,
                        SOURCE.QUALITY_CHECK_HOLD_UPON_RCPT,
                        SOURCE.EXPIRE_DATE,
                        SOURCE.LAST_UPDATED_DTTM,
                        SOURCE.DISPOSITION_TYPE,
                        SOURCE.PURCHASE_ORDERS_LINE_ITEM_ID,
                        SOURCE.MFG_PLNT,
                        SOURCE.REFERENCE_ORDER_NBR,
                        SOURCE.PUTWY_TYPE,
                        SOURCE.IS_ASSOCIATED_TO_OUTBOUND,
                        SOURCE.BATCH_NBR,
                        SOURCE.TC_COMPANY_ID,
                        SOURCE.CNTRY_OF_ORGN,
                        SOURCE.REF_FIELD_10,
                        SOURCE.PACKAGE_TYPE_ID,
                        SOURCE.IS_CLOSED,
                        SOURCE.REGION_ID,
                        SOURCE.SHIPPED_QTY,
                        SOURCE.PROD_STAT,
                        SOURCE.PACKAGE_TYPE_INSTANCE,
                        SOURCE.LAST_UPDATED_SOURCE,
                        SOURCE.RETAIL_PRICE,
                        SOURCE.INVENTORY_SEGMENT_ID,
                        SOURCE.ASN_RECV_RULES,
                        SOURCE.INCUBATION_DATE,
                        SOURCE.ORDER_LINE_ITEM_ID,
                        SOURCE.IS_CANCELLED,
                        SOURCE.STD_PACK_QTY,
                        SOURCE.REF_NUM1,
                        SOURCE.QTY_CONV_FACTOR,
                        SOURCE.REF_NUM3,
                        SOURCE.REF_NUM2,
                        SOURCE.REF_NUM5,
                        SOURCE.PROC_IMMD_NEEDS,
                        SOURCE.REF_NUM4,
                        SOURCE.ASN_DETAIL_STATUS,
                        SOURCE.PURCHASE_ORDERS_ID,
                        SOURCE.EPC_REQ_ON_ALL_CASES,
                        SOURCE.SHIP_BY_DATE,
                        SOURCE.EXT_PLAN_ID,
                        SOURCE.GTIN,
                        SOURCE.ORDER_ID,
                        SOURCE.UNITS_ASSIGNED_TO_LPN,
                        current_timestamp(),
                        SOURCE._FIVETRAN_DELETED,
                        SOURCE._FIVETRAN_SYNCED 
                        );
                RETURN ('SUCCESS');
        END;
    
---------------- SP_ASN_DETAIL SILVER

CALL ETL.SILVER_ARCH.SP_UPDATE_ETL_ASN_DETAIL_SILVER();

CREATE OR REPLACE PROCEDURE ETL.SILVER_ARCH.SP_UPDATE_ETL_ASN_DETAIL_SILVER()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER 
   AS
        BEGIN 
            MERGE INTO ETL.SILVER_ARCH.ASN_DETAIL AS TARGET
            USING
            (
                SELECT *, current_timestamp() AS ARCHIVE_DTTM
                FROM XBPRDWMSILVER.PRD_SILVER_GB_XBDBTJ3WM.ASN_DETAIL
                WHERE ASN_DETAIL.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())
            ) AS SOURCE

            ON TARGET.ASN_DETAIL_ID = SOURCE.ASN_DETAIL_ID
                WHEN MATCHED AND TARGET.LAST_UPDATED_DTTM < SOURCE.LAST_UPDATED_DTTM 
                    THEN UPDATE SET
                        TARGET.ASN_DETAIL_ID = SOURCE.ASN_DETAIL_ID,
                    	TARGET.ASN_ID = SOURCE.ASN_ID,
                    	TARGET.WEIGHT_UOM_ID_BASE = SOURCE.WEIGHT_UOM_ID_BASE,
                    	TARGET.CHECKSUM = SOURCE.CHECKSUM,
                    	TARGET.INV_DISPOSITION = SOURCE.INV_DISPOSITION,
                    	TARGET.PPACK_GRP_CODE = SOURCE.PPACK_GRP_CODE,
                    	TARGET.PROCESSED_FOR_TRLR_MOVES = SOURCE.PROCESSED_FOR_TRLR_MOVES,
                    	TARGET.HIBERNATE_VERSION = SOURCE.HIBERNATE_VERSION,
                    	TARGET.TIER_PER_PALLET = SOURCE.TIER_PER_PALLET,
                    	TARGET.SEQ_NBR = SOURCE.SEQ_NBR,
                    	TARGET.NBR_OF_PACK_FOR_CATCH_WT = SOURCE.NBR_OF_PACK_FOR_CATCH_WT,
                    	TARGET.TC_PURCHASE_ORDERS_ID = SOURCE.TC_PURCHASE_ORDERS_ID,
                    	TARGET.ORDER_TYPE_DESC = SOURCE.ORDER_TYPE_DESC,
                    	TARGET.PACKAGE_TYPE_DESC = SOURCE.PACKAGE_TYPE_DESC,
                    	TARGET.SKU_ATTR_2 = SOURCE.SKU_ATTR_2,
                    	TARGET.SKU_ATTR_3 = SOURCE.SKU_ATTR_3,
                    	TARGET.SKU_ATTR_1 = SOURCE.SKU_ATTR_1,
                    	TARGET.SKU_ATTR_4 = SOURCE.SKU_ATTR_4,
                    	TARGET.SKU_ATTR_5 = SOURCE.SKU_ATTR_5,
                    	TARGET.TC_ORDER_LINE_ID = SOURCE.TC_ORDER_LINE_ID,
                    	TARGET.SHIPPED_LPN_COUNT = SOURCE.SHIPPED_LPN_COUNT,
                    	TARGET.QTY_UOM_ID = SOURCE.QTY_UOM_ID,
                    	TARGET.CREATED_SOURCE_TYPE = SOURCE.CREATED_SOURCE_TYPE,
                    	TARGET.STD_CASE_QTY = SOURCE.STD_CASE_QTY,
                    	TARGET.MFG_DATE = SOURCE.MFG_DATE,
                    	TARGET.STD_SUB_PACK_QTY = SOURCE.STD_SUB_PACK_QTY,
                    	TARGET.RECEIVED_QTY = SOURCE.RECEIVED_QTY,
                    	TARGET.BUSINESS_PARTNER_ID = SOURCE.BUSINESS_PARTNER_ID,
                    	TARGET.ACTUAL_WEIGHT_PACK_COUNT = SOURCE.ACTUAL_WEIGHT_PACK_COUNT,
                    	TARGET.CREATED_DTTM = SOURCE.CREATED_DTTM,
                    	TARGET.RECEIVED_LPN_COUNT = SOURCE.RECEIVED_LPN_COUNT,
                    	TARGET.EXP_RECEIVE_CONDITION_CODE = SOURCE.EXP_RECEIVE_CONDITION_CODE,
                    	TARGET.ACTUAL_WEIGHT_RECEIVED = SOURCE.ACTUAL_WEIGHT_RECEIVED,
                    	TARGET.SKU_NAME = SOURCE.SKU_NAME,
                    	TARGET.INVN_TYPE = SOURCE.INVN_TYPE,
                    	TARGET.ACTUAL_WEIGHT = SOURCE.ACTUAL_WEIGHT,
                    	TARGET.QTY_UOM_ID_BASE = SOURCE.QTY_UOM_ID_BASE,
                    	TARGET.EPC_TRACKING_RFID_VALUE = SOURCE.EPC_TRACKING_RFID_VALUE,
                    	TARGET.SKU_ID = SOURCE.SKU_ID,
                    	TARGET.PRE_RECEIPT_STATUS = SOURCE.PRE_RECEIPT_STATUS,
                    	TARGET.TC_ORDER_ID = SOURCE.TC_ORDER_ID,
                    	TARGET.PRICE_TIX_AVAIL = SOURCE.PRICE_TIX_AVAIL,
                    	TARGET.REF_FIELD_9 = SOURCE.REF_FIELD_9,
                    	TARGET.TC_PO_LINE_ID = SOURCE.TC_PO_LINE_ID,
                    	TARGET.REF_FIELD_1 = SOURCE.REF_FIELD_1,
                    	TARGET.REF_FIELD_2 = SOURCE.REF_FIELD_2,
                    	TARGET.REF_FIELD_3 = SOURCE.REF_FIELD_3,
                    	TARGET.REF_FIELD_4 = SOURCE.REF_FIELD_4,
                    	TARGET.REF_FIELD_5 = SOURCE.REF_FIELD_5,
                    	TARGET.REF_FIELD_6 = SOURCE.REF_FIELD_6,
                    	TARGET.REF_FIELD_7 = SOURCE.REF_FIELD_7,
                    	TARGET.LPN_PER_TIER = SOURCE.LPN_PER_TIER,
                    	TARGET.REF_FIELD_8 = SOURCE.REF_FIELD_8,
                    	TARGET.LAST_UPDATED_SOURCE_TYPE = SOURCE.LAST_UPDATED_SOURCE_TYPE,
                    	TARGET.CREATED_SOURCE = SOURCE.CREATED_SOURCE,
                    	TARGET.WEIGHT_UOM_ID = SOURCE.WEIGHT_UOM_ID,
                    	TARGET.CUT_NBR = SOURCE.CUT_NBR,
                    	TARGET.QUALITY_CHECK_HOLD_UPON_RCPT = SOURCE.QUALITY_CHECK_HOLD_UPON_RCPT,
                    	TARGET.EXPIRE_DATE = SOURCE.EXPIRE_DATE,
                    	TARGET.LAST_UPDATED_DTTM = SOURCE.LAST_UPDATED_DTTM,
                    	TARGET.DISPOSITION_TYPE = SOURCE.DISPOSITION_TYPE,
                    	TARGET.PURCHASE_ORDERS_LINE_ITEM_ID = SOURCE.PURCHASE_ORDERS_LINE_ITEM_ID,
                    	TARGET.MFG_PLNT = SOURCE.MFG_PLNT,
                    	TARGET.REFERENCE_ORDER_NBR = SOURCE.REFERENCE_ORDER_NBR,
                    	TARGET.PUTWY_TYPE = SOURCE.PUTWY_TYPE,
                    	TARGET.IS_ASSOCIATED_TO_OUTBOUND = SOURCE.IS_ASSOCIATED_TO_OUTBOUND,
                    	TARGET.BATCH_NBR = SOURCE.BATCH_NBR,
                    	TARGET.TC_COMPANY_ID = SOURCE.TC_COMPANY_ID,
                    	TARGET.CNTRY_OF_ORGN = SOURCE.CNTRY_OF_ORGN,
                    	TARGET.REF_FIELD_10 = SOURCE.REF_FIELD_10,
                    	TARGET.PACKAGE_TYPE_ID = SOURCE.PACKAGE_TYPE_ID,
                    	TARGET.IS_CLOSED = SOURCE.IS_CLOSED,
                    	TARGET.REGION_ID = SOURCE.REGION_ID,
                    	TARGET.SHIPPED_QTY = SOURCE.SHIPPED_QTY,
                    	TARGET.PROD_STAT = SOURCE.PROD_STAT,
                    	TARGET.PACKAGE_TYPE_INSTANCE = SOURCE.PACKAGE_TYPE_INSTANCE,
                    	TARGET.LAST_UPDATED_SOURCE = SOURCE.LAST_UPDATED_SOURCE,
                    	TARGET.RETAIL_PRICE = SOURCE.RETAIL_PRICE,
                    	TARGET.INVENTORY_SEGMENT_ID = SOURCE.INVENTORY_SEGMENT_ID,
                    	TARGET.ASN_RECV_RULES = SOURCE.ASN_RECV_RULES,
                    	TARGET.INCUBATION_DATE = SOURCE.INCUBATION_DATE,
                    	TARGET.ORDER_LINE_ITEM_ID = SOURCE.ORDER_LINE_ITEM_ID,
                    	TARGET.IS_CANCELLED = SOURCE.IS_CANCELLED,
                    	TARGET.STD_PACK_QTY = SOURCE.STD_PACK_QTY,
                    	TARGET.REF_NUM1 = SOURCE.REF_NUM1,
                    	TARGET.QTY_CONV_FACTOR = SOURCE.QTY_CONV_FACTOR,
                    	TARGET.REF_NUM3 = SOURCE.REF_NUM3,
                    	TARGET.REF_NUM2 = SOURCE.REF_NUM2,
                    	TARGET.REF_NUM5 = SOURCE.REF_NUM5,
                    	TARGET.PROC_IMMD_NEEDS = SOURCE.PROC_IMMD_NEEDS,
                    	TARGET.REF_NUM4 = SOURCE.REF_NUM4,
                    	TARGET.ASN_DETAIL_STATUS = SOURCE.ASN_DETAIL_STATUS,
                    	TARGET.PURCHASE_ORDERS_ID = SOURCE.PURCHASE_ORDERS_ID,
                    	TARGET.EPC_REQ_ON_ALL_CASES = SOURCE.EPC_REQ_ON_ALL_CASES,
                    	TARGET.SHIP_BY_DATE = SOURCE.SHIP_BY_DATE,
                    	TARGET.EXT_PLAN_ID = SOURCE.EXT_PLAN_ID,
                    	TARGET.GTIN = SOURCE.GTIN,
                    	TARGET.ORDER_ID = SOURCE.ORDER_ID,
                    	TARGET.UNITS_ASSIGNED_TO_LPN = SOURCE.UNITS_ASSIGNED_TO_LPN,
                    	TARGET.ARCHIVE_DTTM = current_timestamp(),
                    	TARGET._FIVETRAN_DELETED = SOURCE._FIVETRAN_DELETED,
                    	TARGET._FIVETRAN_SYNCED = SOURCE._FIVETRAN_SYNCED
                WHEN NOT MATCHED 
                    THEN
                        INSERT (
                        ASN_DETAIL_ID,
                    	ASN_ID,
                    	WEIGHT_UOM_ID_BASE,
                    	CHECKSUM,
                    	INV_DISPOSITION,
                    	PPACK_GRP_CODE,
                    	PROCESSED_FOR_TRLR_MOVES,
                    	HIBERNATE_VERSION,
                    	TIER_PER_PALLET,
                    	SEQ_NBR,
                    	NBR_OF_PACK_FOR_CATCH_WT,
                    	TC_PURCHASE_ORDERS_ID,
                    	ORDER_TYPE_DESC,
                    	PACKAGE_TYPE_DESC,
                    	SKU_ATTR_2,
                    	SKU_ATTR_3,
                    	SKU_ATTR_1,
                    	SKU_ATTR_4,
                    	SKU_ATTR_5,
                    	TC_ORDER_LINE_ID,
                    	SHIPPED_LPN_COUNT,
                    	QTY_UOM_ID,
                    	CREATED_SOURCE_TYPE,
                    	STD_CASE_QTY,
                    	MFG_DATE,
                    	STD_SUB_PACK_QTY,
                    	RECEIVED_QTY,
                    	BUSINESS_PARTNER_ID,
                    	ACTUAL_WEIGHT_PACK_COUNT,
                    	CREATED_DTTM,
                    	RECEIVED_LPN_COUNT,
                    	EXP_RECEIVE_CONDITION_CODE,
                    	ACTUAL_WEIGHT_RECEIVED,
                    	SKU_NAME,
                    	INVN_TYPE,
                    	ACTUAL_WEIGHT,
                    	QTY_UOM_ID_BASE,
                    	EPC_TRACKING_RFID_VALUE,
                    	SKU_ID,
                    	PRE_RECEIPT_STATUS,
                    	TC_ORDER_ID,
                    	PRICE_TIX_AVAIL,
                    	REF_FIELD_9,
                    	TC_PO_LINE_ID,
                    	REF_FIELD_1,
                    	REF_FIELD_2,
                    	REF_FIELD_3,
                    	REF_FIELD_4,
                    	REF_FIELD_5,
                    	REF_FIELD_6,
                    	REF_FIELD_7,
                    	LPN_PER_TIER,
                    	REF_FIELD_8,
                    	LAST_UPDATED_SOURCE_TYPE,
                    	CREATED_SOURCE,
                    	WEIGHT_UOM_ID,
                    	CUT_NBR,
                    	QUALITY_CHECK_HOLD_UPON_RCPT,
                    	EXPIRE_DATE,
                    	LAST_UPDATED_DTTM,
                    	DISPOSITION_TYPE,
                    	PURCHASE_ORDERS_LINE_ITEM_ID,
                    	MFG_PLNT,
                    	REFERENCE_ORDER_NBR,
                    	PUTWY_TYPE,
                    	IS_ASSOCIATED_TO_OUTBOUND,
                    	BATCH_NBR,
                    	TC_COMPANY_ID,
                    	CNTRY_OF_ORGN,
                    	REF_FIELD_10,
                    	PACKAGE_TYPE_ID,
                    	IS_CLOSED,
                    	REGION_ID,
                    	SHIPPED_QTY,
                    	PROD_STAT,
                    	PACKAGE_TYPE_INSTANCE,
                    	LAST_UPDATED_SOURCE,
                    	RETAIL_PRICE,
                    	INVENTORY_SEGMENT_ID,
                    	ASN_RECV_RULES,
                    	INCUBATION_DATE,
                    	ORDER_LINE_ITEM_ID,
                    	IS_CANCELLED,
                    	STD_PACK_QTY,
                    	REF_NUM1,
                    	QTY_CONV_FACTOR,
                    	REF_NUM3,
                    	REF_NUM2,
                    	REF_NUM5,
                    	PROC_IMMD_NEEDS,
                    	REF_NUM4,
                    	ASN_DETAIL_STATUS,
                    	PURCHASE_ORDERS_ID,
                    	EPC_REQ_ON_ALL_CASES,
                    	SHIP_BY_DATE,
                    	EXT_PLAN_ID,
                    	GTIN,
                    	ORDER_ID,
                    	UNITS_ASSIGNED_TO_LPN,
                    	ARCHIVE_DTTM,
                    	_FIVETRAN_DELETED,
                    	_FIVETRAN_SYNCED
                        )
                        VALUES (
                        SOURCE.ASN_DETAIL_ID,
                        SOURCE.ASN_ID,
                        SOURCE.WEIGHT_UOM_ID_BASE,
                        SOURCE.CHECKSUM,
                        SOURCE.INV_DISPOSITION,
                        SOURCE.PPACK_GRP_CODE,
                        SOURCE.PROCESSED_FOR_TRLR_MOVES,
                        SOURCE.HIBERNATE_VERSION,
                        SOURCE.TIER_PER_PALLET,
                        SOURCE.SEQ_NBR,
                        SOURCE.NBR_OF_PACK_FOR_CATCH_WT,
                        SOURCE.TC_PURCHASE_ORDERS_ID,
                        SOURCE.ORDER_TYPE_DESC,
                        SOURCE.PACKAGE_TYPE_DESC,
                        SOURCE.SKU_ATTR_2,
                        SOURCE.SKU_ATTR_3,
                        SOURCE.SKU_ATTR_1,
                        SOURCE.SKU_ATTR_4,
                        SOURCE.SKU_ATTR_5,
                        SOURCE.TC_ORDER_LINE_ID,
                        SOURCE.SHIPPED_LPN_COUNT,
                        SOURCE.QTY_UOM_ID,
                        SOURCE.CREATED_SOURCE_TYPE,
                        SOURCE.STD_CASE_QTY,
                        SOURCE.MFG_DATE,
                        SOURCE.STD_SUB_PACK_QTY,
                        SOURCE.RECEIVED_QTY,
                        SOURCE.BUSINESS_PARTNER_ID,
                        SOURCE.ACTUAL_WEIGHT_PACK_COUNT,
                        SOURCE.CREATED_DTTM,
                        SOURCE.RECEIVED_LPN_COUNT,
                        SOURCE.EXP_RECEIVE_CONDITION_CODE,
                        SOURCE.ACTUAL_WEIGHT_RECEIVED,
                        SOURCE.SKU_NAME,
                        SOURCE.INVN_TYPE,
                        SOURCE.ACTUAL_WEIGHT,
                        SOURCE.QTY_UOM_ID_BASE,
                        SOURCE.EPC_TRACKING_RFID_VALUE,
                        SOURCE.SKU_ID,
                        SOURCE.PRE_RECEIPT_STATUS,
                        SOURCE.TC_ORDER_ID,
                        SOURCE.PRICE_TIX_AVAIL,
                        SOURCE.REF_FIELD_9,
                        SOURCE.TC_PO_LINE_ID,
                        SOURCE.REF_FIELD_1,
                        SOURCE.REF_FIELD_2,
                        SOURCE.REF_FIELD_3,
                        SOURCE.REF_FIELD_4,
                        SOURCE.REF_FIELD_5,
                        SOURCE.REF_FIELD_6,
                        SOURCE.REF_FIELD_7,
                        SOURCE.LPN_PER_TIER,
                        SOURCE.REF_FIELD_8,
                        SOURCE.LAST_UPDATED_SOURCE_TYPE,
                        SOURCE.CREATED_SOURCE,
                        SOURCE.WEIGHT_UOM_ID,
                        SOURCE.CUT_NBR,
                        SOURCE.QUALITY_CHECK_HOLD_UPON_RCPT,
                        SOURCE.EXPIRE_DATE,
                        SOURCE.LAST_UPDATED_DTTM,
                        SOURCE.DISPOSITION_TYPE,
                        SOURCE.PURCHASE_ORDERS_LINE_ITEM_ID,
                        SOURCE.MFG_PLNT,
                        SOURCE.REFERENCE_ORDER_NBR,
                        SOURCE.PUTWY_TYPE,
                        SOURCE.IS_ASSOCIATED_TO_OUTBOUND,
                        SOURCE.BATCH_NBR,
                        SOURCE.TC_COMPANY_ID,
                        SOURCE.CNTRY_OF_ORGN,
                        SOURCE.REF_FIELD_10,
                        SOURCE.PACKAGE_TYPE_ID,
                        SOURCE.IS_CLOSED,
                        SOURCE.REGION_ID,
                        SOURCE.SHIPPED_QTY,
                        SOURCE.PROD_STAT,
                        SOURCE.PACKAGE_TYPE_INSTANCE,
                        SOURCE.LAST_UPDATED_SOURCE,
                        SOURCE.RETAIL_PRICE,
                        SOURCE.INVENTORY_SEGMENT_ID,
                        SOURCE.ASN_RECV_RULES,
                        SOURCE.INCUBATION_DATE,
                        SOURCE.ORDER_LINE_ITEM_ID,
                        SOURCE.IS_CANCELLED,
                        SOURCE.STD_PACK_QTY,
                        SOURCE.REF_NUM1,
                        SOURCE.QTY_CONV_FACTOR,
                        SOURCE.REF_NUM3,
                        SOURCE.REF_NUM2,
                        SOURCE.REF_NUM5,
                        SOURCE.PROC_IMMD_NEEDS,
                        SOURCE.REF_NUM4,
                        SOURCE.ASN_DETAIL_STATUS,
                        SOURCE.PURCHASE_ORDERS_ID,
                        SOURCE.EPC_REQ_ON_ALL_CASES,
                        SOURCE.SHIP_BY_DATE,
                        SOURCE.EXT_PLAN_ID,
                        SOURCE.GTIN,
                        SOURCE.ORDER_ID,
                        SOURCE.UNITS_ASSIGNED_TO_LPN,
                        current_timestamp(),
                        SOURCE._FIVETRAN_DELETED,
                        SOURCE._FIVETRAN_SYNCED 
                        );
                RETURN ('SUCCESS');
        END;
    
---------------- SP_ASN RY

CALL ETL.RY_ARCH.SP_UPDATE_ETL_ASN_DETAIL_RY();

CREATE OR REPLACE PROCEDURE ETL.RY_ARCH.SP_UPDATE_ETL_ASN_DETAIL_RY()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER 
   AS
        BEGIN 
            MERGE INTO ETL.RY_ARCH.ASN_DETAIL AS TARGET
            USING
            (
                SELECT *, current_timestamp() AS ARCHIVE_DTTM
                FROM XBPRDWMRY.PRD_RY_GB_XBORPRDWM.ASN_DETAIL
                WHERE ASN_DETAIL.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())
            ) AS SOURCE

            ON TARGET.ASN_DETAIL_ID = SOURCE.ASN_DETAIL_ID
                WHEN MATCHED AND TARGET.LAST_UPDATED_DTTM < SOURCE.LAST_UPDATED_DTTM 
                    THEN UPDATE SET
                        TARGET.ASN_DETAIL_ID = SOURCE.ASN_DETAIL_ID,
                    	TARGET.ASN_ID = SOURCE.ASN_ID,
                    	TARGET.WEIGHT_UOM_ID_BASE = SOURCE.WEIGHT_UOM_ID_BASE,
                    	TARGET.CHECKSUM = SOURCE.CHECKSUM,
                    	TARGET.INV_DISPOSITION = SOURCE.INV_DISPOSITION,
                    	TARGET.PPACK_GRP_CODE = SOURCE.PPACK_GRP_CODE,
                    	TARGET.PROCESSED_FOR_TRLR_MOVES = SOURCE.PROCESSED_FOR_TRLR_MOVES,
                    	TARGET.HIBERNATE_VERSION = SOURCE.HIBERNATE_VERSION,
                    	TARGET.TIER_PER_PALLET = SOURCE.TIER_PER_PALLET,
                    	TARGET.SEQ_NBR = SOURCE.SEQ_NBR,
                    	TARGET.NBR_OF_PACK_FOR_CATCH_WT = SOURCE.NBR_OF_PACK_FOR_CATCH_WT,
                    	TARGET.TC_PURCHASE_ORDERS_ID = SOURCE.TC_PURCHASE_ORDERS_ID,
                    	TARGET.ORDER_TYPE_DESC = SOURCE.ORDER_TYPE_DESC,
                    	TARGET.PACKAGE_TYPE_DESC = SOURCE.PACKAGE_TYPE_DESC,
                    	TARGET.SKU_ATTR_2 = SOURCE.SKU_ATTR_2,
                    	TARGET.SKU_ATTR_3 = SOURCE.SKU_ATTR_3,
                    	TARGET.SKU_ATTR_1 = SOURCE.SKU_ATTR_1,
                    	TARGET.SKU_ATTR_4 = SOURCE.SKU_ATTR_4,
                    	TARGET.SKU_ATTR_5 = SOURCE.SKU_ATTR_5,
                    	TARGET.TC_ORDER_LINE_ID = SOURCE.TC_ORDER_LINE_ID,
                    	TARGET.SHIPPED_LPN_COUNT = SOURCE.SHIPPED_LPN_COUNT,
                    	TARGET.QTY_UOM_ID = SOURCE.QTY_UOM_ID,
                    	TARGET.CREATED_SOURCE_TYPE = SOURCE.CREATED_SOURCE_TYPE,
                    	TARGET.STD_CASE_QTY = SOURCE.STD_CASE_QTY,
                    	TARGET.MFG_DATE = SOURCE.MFG_DATE,
                    	TARGET.STD_SUB_PACK_QTY = SOURCE.STD_SUB_PACK_QTY,
                    	TARGET.RECEIVED_QTY = SOURCE.RECEIVED_QTY,
                    	TARGET.BUSINESS_PARTNER_ID = SOURCE.BUSINESS_PARTNER_ID,
                    	TARGET.ACTUAL_WEIGHT_PACK_COUNT = SOURCE.ACTUAL_WEIGHT_PACK_COUNT,
                    	TARGET.CREATED_DTTM = SOURCE.CREATED_DTTM,
                    	TARGET.RECEIVED_LPN_COUNT = SOURCE.RECEIVED_LPN_COUNT,
                    	TARGET.EXP_RECEIVE_CONDITION_CODE = SOURCE.EXP_RECEIVE_CONDITION_CODE,
                    	TARGET.ACTUAL_WEIGHT_RECEIVED = SOURCE.ACTUAL_WEIGHT_RECEIVED,
                    	TARGET.SKU_NAME = SOURCE.SKU_NAME,
                    	TARGET.INVN_TYPE = SOURCE.INVN_TYPE,
                    	TARGET.ACTUAL_WEIGHT = SOURCE.ACTUAL_WEIGHT,
                    	TARGET.QTY_UOM_ID_BASE = SOURCE.QTY_UOM_ID_BASE,
                    	TARGET.EPC_TRACKING_RFID_VALUE = SOURCE.EPC_TRACKING_RFID_VALUE,
                    	TARGET.SKU_ID = SOURCE.SKU_ID,
                    	TARGET.PRE_RECEIPT_STATUS = SOURCE.PRE_RECEIPT_STATUS,
                    	TARGET.TC_ORDER_ID = SOURCE.TC_ORDER_ID,
                    	TARGET.PRICE_TIX_AVAIL = SOURCE.PRICE_TIX_AVAIL,
                    	TARGET.REF_FIELD_9 = SOURCE.REF_FIELD_9,
                    	TARGET.TC_PO_LINE_ID = SOURCE.TC_PO_LINE_ID,
                    	TARGET.REF_FIELD_1 = SOURCE.REF_FIELD_1,
                    	TARGET.REF_FIELD_2 = SOURCE.REF_FIELD_2,
                    	TARGET.REF_FIELD_3 = SOURCE.REF_FIELD_3,
                    	TARGET.REF_FIELD_4 = SOURCE.REF_FIELD_4,
                    	TARGET.REF_FIELD_5 = SOURCE.REF_FIELD_5,
                    	TARGET.REF_FIELD_6 = SOURCE.REF_FIELD_6,
                    	TARGET.REF_FIELD_7 = SOURCE.REF_FIELD_7,
                    	TARGET.LPN_PER_TIER = SOURCE.LPN_PER_TIER,
                    	TARGET.REF_FIELD_8 = SOURCE.REF_FIELD_8,
                    	TARGET.LAST_UPDATED_SOURCE_TYPE = SOURCE.LAST_UPDATED_SOURCE_TYPE,
                    	TARGET.CREATED_SOURCE = SOURCE.CREATED_SOURCE,
                    	TARGET.WEIGHT_UOM_ID = SOURCE.WEIGHT_UOM_ID,
                    	TARGET.CUT_NBR = SOURCE.CUT_NBR,
                    	TARGET.QUALITY_CHECK_HOLD_UPON_RCPT = SOURCE.QUALITY_CHECK_HOLD_UPON_RCPT,
                    	TARGET.EXPIRE_DATE = SOURCE.EXPIRE_DATE,
                    	TARGET.LAST_UPDATED_DTTM = SOURCE.LAST_UPDATED_DTTM,
                    	TARGET.DISPOSITION_TYPE = SOURCE.DISPOSITION_TYPE,
                    	TARGET.PURCHASE_ORDERS_LINE_ITEM_ID = SOURCE.PURCHASE_ORDERS_LINE_ITEM_ID,
                    	TARGET.MFG_PLNT = SOURCE.MFG_PLNT,
                    	TARGET.REFERENCE_ORDER_NBR = SOURCE.REFERENCE_ORDER_NBR,
                    	TARGET.PUTWY_TYPE = SOURCE.PUTWY_TYPE,
                    	TARGET.IS_ASSOCIATED_TO_OUTBOUND = SOURCE.IS_ASSOCIATED_TO_OUTBOUND,
                    	TARGET.BATCH_NBR = SOURCE.BATCH_NBR,
                    	TARGET.TC_COMPANY_ID = SOURCE.TC_COMPANY_ID,
                    	TARGET.CNTRY_OF_ORGN = SOURCE.CNTRY_OF_ORGN,
                    	TARGET.REF_FIELD_10 = SOURCE.REF_FIELD_10,
                    	TARGET.PACKAGE_TYPE_ID = SOURCE.PACKAGE_TYPE_ID,
                    	TARGET.IS_CLOSED = SOURCE.IS_CLOSED,
                    	TARGET.REGION_ID = SOURCE.REGION_ID,
                    	TARGET.SHIPPED_QTY = SOURCE.SHIPPED_QTY,
                    	TARGET.PROD_STAT = SOURCE.PROD_STAT,
                    	TARGET.PACKAGE_TYPE_INSTANCE = SOURCE.PACKAGE_TYPE_INSTANCE,
                    	TARGET.LAST_UPDATED_SOURCE = SOURCE.LAST_UPDATED_SOURCE,
                    	TARGET.RETAIL_PRICE = SOURCE.RETAIL_PRICE,
                    	TARGET.INVENTORY_SEGMENT_ID = SOURCE.INVENTORY_SEGMENT_ID,
                    	TARGET.ASN_RECV_RULES = SOURCE.ASN_RECV_RULES,
                    	TARGET.INCUBATION_DATE = SOURCE.INCUBATION_DATE,
                    	TARGET.ORDER_LINE_ITEM_ID = SOURCE.ORDER_LINE_ITEM_ID,
                    	TARGET.IS_CANCELLED = SOURCE.IS_CANCELLED,
                    	TARGET.STD_PACK_QTY = SOURCE.STD_PACK_QTY,
                    	TARGET.REF_NUM1 = SOURCE.REF_NUM1,
                    	TARGET.QTY_CONV_FACTOR = SOURCE.QTY_CONV_FACTOR,
                    	TARGET.REF_NUM3 = SOURCE.REF_NUM3,
                    	TARGET.REF_NUM2 = SOURCE.REF_NUM2,
                    	TARGET.REF_NUM5 = SOURCE.REF_NUM5,
                    	TARGET.PROC_IMMD_NEEDS = SOURCE.PROC_IMMD_NEEDS,
                    	TARGET.REF_NUM4 = SOURCE.REF_NUM4,
                    	TARGET.ASN_DETAIL_STATUS = SOURCE.ASN_DETAIL_STATUS,
                    	TARGET.PURCHASE_ORDERS_ID = SOURCE.PURCHASE_ORDERS_ID,
                    	TARGET.EPC_REQ_ON_ALL_CASES = SOURCE.EPC_REQ_ON_ALL_CASES,
                    	TARGET.SHIP_BY_DATE = SOURCE.SHIP_BY_DATE,
                    	TARGET.EXT_PLAN_ID = SOURCE.EXT_PLAN_ID,
                    	TARGET.GTIN = SOURCE.GTIN,
                    	TARGET.ORDER_ID = SOURCE.ORDER_ID,
                    	TARGET.UNITS_ASSIGNED_TO_LPN = SOURCE.UNITS_ASSIGNED_TO_LPN,
                    	TARGET.ARCHIVE_DTTM = current_timestamp(),
                    	TARGET._FIVETRAN_DELETED = SOURCE._FIVETRAN_DELETED,
                    	TARGET._FIVETRAN_SYNCED = SOURCE._FIVETRAN_SYNCED
                WHEN NOT MATCHED 
                    THEN
                        INSERT (
                        ASN_DETAIL_ID,
                    	ASN_ID,
                    	WEIGHT_UOM_ID_BASE,
                    	CHECKSUM,
                    	INV_DISPOSITION,
                    	PPACK_GRP_CODE,
                    	PROCESSED_FOR_TRLR_MOVES,
                    	HIBERNATE_VERSION,
                    	TIER_PER_PALLET,
                    	SEQ_NBR,
                    	NBR_OF_PACK_FOR_CATCH_WT,
                    	TC_PURCHASE_ORDERS_ID,
                    	ORDER_TYPE_DESC,
                    	PACKAGE_TYPE_DESC,
                    	SKU_ATTR_2,
                    	SKU_ATTR_3,
                    	SKU_ATTR_1,
                    	SKU_ATTR_4,
                    	SKU_ATTR_5,
                    	TC_ORDER_LINE_ID,
                    	SHIPPED_LPN_COUNT,
                    	QTY_UOM_ID,
                    	CREATED_SOURCE_TYPE,
                    	STD_CASE_QTY,
                    	MFG_DATE,
                    	STD_SUB_PACK_QTY,
                    	RECEIVED_QTY,
                    	BUSINESS_PARTNER_ID,
                    	ACTUAL_WEIGHT_PACK_COUNT,
                    	CREATED_DTTM,
                    	RECEIVED_LPN_COUNT,
                    	EXP_RECEIVE_CONDITION_CODE,
                    	ACTUAL_WEIGHT_RECEIVED,
                    	SKU_NAME,
                    	INVN_TYPE,
                    	ACTUAL_WEIGHT,
                    	QTY_UOM_ID_BASE,
                    	EPC_TRACKING_RFID_VALUE,
                    	SKU_ID,
                    	PRE_RECEIPT_STATUS,
                    	TC_ORDER_ID,
                    	PRICE_TIX_AVAIL,
                    	REF_FIELD_9,
                    	TC_PO_LINE_ID,
                    	REF_FIELD_1,
                    	REF_FIELD_2,
                    	REF_FIELD_3,
                    	REF_FIELD_4,
                    	REF_FIELD_5,
                    	REF_FIELD_6,
                    	REF_FIELD_7,
                    	LPN_PER_TIER,
                    	REF_FIELD_8,
                    	LAST_UPDATED_SOURCE_TYPE,
                    	CREATED_SOURCE,
                    	WEIGHT_UOM_ID,
                    	CUT_NBR,
                    	QUALITY_CHECK_HOLD_UPON_RCPT,
                    	EXPIRE_DATE,
                    	LAST_UPDATED_DTTM,
                    	DISPOSITION_TYPE,
                    	PURCHASE_ORDERS_LINE_ITEM_ID,
                    	MFG_PLNT,
                    	REFERENCE_ORDER_NBR,
                    	PUTWY_TYPE,
                    	IS_ASSOCIATED_TO_OUTBOUND,
                    	BATCH_NBR,
                    	TC_COMPANY_ID,
                    	CNTRY_OF_ORGN,
                    	REF_FIELD_10,
                    	PACKAGE_TYPE_ID,
                    	IS_CLOSED,
                    	REGION_ID,
                    	SHIPPED_QTY,
                    	PROD_STAT,
                    	PACKAGE_TYPE_INSTANCE,
                    	LAST_UPDATED_SOURCE,
                    	RETAIL_PRICE,
                    	INVENTORY_SEGMENT_ID,
                    	ASN_RECV_RULES,
                    	INCUBATION_DATE,
                    	ORDER_LINE_ITEM_ID,
                    	IS_CANCELLED,
                    	STD_PACK_QTY,
                    	REF_NUM1,
                    	QTY_CONV_FACTOR,
                    	REF_NUM3,
                    	REF_NUM2,
                    	REF_NUM5,
                    	PROC_IMMD_NEEDS,
                    	REF_NUM4,
                    	ASN_DETAIL_STATUS,
                    	PURCHASE_ORDERS_ID,
                    	EPC_REQ_ON_ALL_CASES,
                    	SHIP_BY_DATE,
                    	EXT_PLAN_ID,
                    	GTIN,
                    	ORDER_ID,
                    	UNITS_ASSIGNED_TO_LPN,
                    	ARCHIVE_DTTM,
                    	_FIVETRAN_DELETED,
                    	_FIVETRAN_SYNCED
                        )
                        VALUES (
                        SOURCE.ASN_DETAIL_ID,
                        SOURCE.ASN_ID,
                        SOURCE.WEIGHT_UOM_ID_BASE,
                        SOURCE.CHECKSUM,
                        SOURCE.INV_DISPOSITION,
                        SOURCE.PPACK_GRP_CODE,
                        SOURCE.PROCESSED_FOR_TRLR_MOVES,
                        SOURCE.HIBERNATE_VERSION,
                        SOURCE.TIER_PER_PALLET,
                        SOURCE.SEQ_NBR,
                        SOURCE.NBR_OF_PACK_FOR_CATCH_WT,
                        SOURCE.TC_PURCHASE_ORDERS_ID,
                        SOURCE.ORDER_TYPE_DESC,
                        SOURCE.PACKAGE_TYPE_DESC,
                        SOURCE.SKU_ATTR_2,
                        SOURCE.SKU_ATTR_3,
                        SOURCE.SKU_ATTR_1,
                        SOURCE.SKU_ATTR_4,
                        SOURCE.SKU_ATTR_5,
                        SOURCE.TC_ORDER_LINE_ID,
                        SOURCE.SHIPPED_LPN_COUNT,
                        SOURCE.QTY_UOM_ID,
                        SOURCE.CREATED_SOURCE_TYPE,
                        SOURCE.STD_CASE_QTY,
                        SOURCE.MFG_DATE,
                        SOURCE.STD_SUB_PACK_QTY,
                        SOURCE.RECEIVED_QTY,
                        SOURCE.BUSINESS_PARTNER_ID,
                        SOURCE.ACTUAL_WEIGHT_PACK_COUNT,
                        SOURCE.CREATED_DTTM,
                        SOURCE.RECEIVED_LPN_COUNT,
                        SOURCE.EXP_RECEIVE_CONDITION_CODE,
                        SOURCE.ACTUAL_WEIGHT_RECEIVED,
                        SOURCE.SKU_NAME,
                        SOURCE.INVN_TYPE,
                        SOURCE.ACTUAL_WEIGHT,
                        SOURCE.QTY_UOM_ID_BASE,
                        SOURCE.EPC_TRACKING_RFID_VALUE,
                        SOURCE.SKU_ID,
                        SOURCE.PRE_RECEIPT_STATUS,
                        SOURCE.TC_ORDER_ID,
                        SOURCE.PRICE_TIX_AVAIL,
                        SOURCE.REF_FIELD_9,
                        SOURCE.TC_PO_LINE_ID,
                        SOURCE.REF_FIELD_1,
                        SOURCE.REF_FIELD_2,
                        SOURCE.REF_FIELD_3,
                        SOURCE.REF_FIELD_4,
                        SOURCE.REF_FIELD_5,
                        SOURCE.REF_FIELD_6,
                        SOURCE.REF_FIELD_7,
                        SOURCE.LPN_PER_TIER,
                        SOURCE.REF_FIELD_8,
                        SOURCE.LAST_UPDATED_SOURCE_TYPE,
                        SOURCE.CREATED_SOURCE,
                        SOURCE.WEIGHT_UOM_ID,
                        SOURCE.CUT_NBR,
                        SOURCE.QUALITY_CHECK_HOLD_UPON_RCPT,
                        SOURCE.EXPIRE_DATE,
                        SOURCE.LAST_UPDATED_DTTM,
                        SOURCE.DISPOSITION_TYPE,
                        SOURCE.PURCHASE_ORDERS_LINE_ITEM_ID,
                        SOURCE.MFG_PLNT,
                        SOURCE.REFERENCE_ORDER_NBR,
                        SOURCE.PUTWY_TYPE,
                        SOURCE.IS_ASSOCIATED_TO_OUTBOUND,
                        SOURCE.BATCH_NBR,
                        SOURCE.TC_COMPANY_ID,
                        SOURCE.CNTRY_OF_ORGN,
                        SOURCE.REF_FIELD_10,
                        SOURCE.PACKAGE_TYPE_ID,
                        SOURCE.IS_CLOSED,
                        SOURCE.REGION_ID,
                        SOURCE.SHIPPED_QTY,
                        SOURCE.PROD_STAT,
                        SOURCE.PACKAGE_TYPE_INSTANCE,
                        SOURCE.LAST_UPDATED_SOURCE,
                        SOURCE.RETAIL_PRICE,
                        SOURCE.INVENTORY_SEGMENT_ID,
                        SOURCE.ASN_RECV_RULES,
                        SOURCE.INCUBATION_DATE,
                        SOURCE.ORDER_LINE_ITEM_ID,
                        SOURCE.IS_CANCELLED,
                        SOURCE.STD_PACK_QTY,
                        SOURCE.REF_NUM1,
                        SOURCE.QTY_CONV_FACTOR,
                        SOURCE.REF_NUM3,
                        SOURCE.REF_NUM2,
                        SOURCE.REF_NUM5,
                        SOURCE.PROC_IMMD_NEEDS,
                        SOURCE.REF_NUM4,
                        SOURCE.ASN_DETAIL_STATUS,
                        SOURCE.PURCHASE_ORDERS_ID,
                        SOURCE.EPC_REQ_ON_ALL_CASES,
                        SOURCE.SHIP_BY_DATE,
                        SOURCE.EXT_PLAN_ID,
                        SOURCE.GTIN,
                        SOURCE.ORDER_ID,
                        SOURCE.UNITS_ASSIGNED_TO_LPN,
                        current_timestamp(),
                        SOURCE._FIVETRAN_DELETED,
                        SOURCE._FIVETRAN_SYNCED 
                        );
                RETURN ('SUCCESS');
        END;
    

