-- GOLD
CREATE OR REPLACE TABLE ETL.GOLD_ARCH.ASN
AS
    SELECT 
    ASN_ID,
	SYSTEM_ALLOCATED,
	WEIGHT_UOM_ID_BASE,
	HAS_NOTES,
	ROUTE_ID,
	TC_SHIPMENT_ID,
	ASSIGNED_CARRIER_CODE_ID,
	INVOICE_DATE,
	ASN_PRIORITY,
	DESTINATION_TYPE,
	TRACTOR_NUMBER,
	RECEIPT_TYPE,
	HIBERNATE_VERSION,
	CONTACT_NUMBER,
	PRE_ALLOCATION_FIT_PERCENTAGE,
	REP_NAME,
	ASSIGNED_CARRIER_CODE,
	ALLOCATION_COMPLETED,
	LAST_TRANSMITTED_DTTM,
	MANIF_TYPE,
	APPOINTMENT_DTTM,
	ASN_LEVEL,
	CONTACT_COUNTY,
	MANIF_NBR,
	MHE_SENT,
	SHIPPED_LPN_COUNT,
	OUTBOUND_REGION_NAME,
	TRAILER_NUMBER,
	DC_ORD_NBR,
	TOTAL_VOLUME,
	HAS_ALERTS,
	CREATED_SOURCE_TYPE,
	FLOWTHROUGH_ALLOCATION_STATUS,
	ORIGINAL_ASN_ID,
	ASN_ORGN_TYPE,
	DOCK_DOOR_ID,
	CONTACT_CITY,
	ORIGIN_FACILITY_ALIAS_ID,
	FLOW_THRU_ALLOC_IN_PROG,
	LABEL_PRINT_REQD,
	VERIFIED_DTTM,
	SHIPPING_COST_CURRENCY_CODE,
	BUSINESS_PARTNER_ID,
	PALLET_FOOTPRINT,
	BUYER_CODE,
	CREATED_DTTM,
	SCHEDULE_APPT,
	SHIPPING_COST,
	RECEIVED_LPN_COUNT,
	ORIGIN_FACILITY_ID,
	CONTACT_ADDRESS_1,
	CONTACT_ADDRESS_2,
	DESTINATION_FACILITY_ALIAS_ID,
	CONTACT_ADDRESS_3,
	ASN_TYPE,
	INITIATE_FLAG,
	HAS_SOFT_CHECK_ERROR,
	QTY_UOM_ID_BASE,
	VERIFICATION_ATTEMPTED,
	ASN_STATUS,
	PRE_RECEIPT_STATUS,
	FIRM_APPT_IND,
	ACTUAL_SHIPPED_DTTM,
	DELIVERY_START_DTTM,
	REF_FIELD_9,
	ORIGINAL_ORDER_NUMBER,
	IS_GIFT,
	FLOW_THROUGH_ALLOCATION_METHOD,
	REF_FIELD_1,
	REF_FIELD_2,
	REF_FIELD_3,
	DRIVER_NAME,
	WORK_ORD_NBR,
	REF_FIELD_4,
	PRO_NUMBER,
	REF_FIELD_5,
	REF_FIELD_6,
	REF_FIELD_7,
	REF_FIELD_8,
	TRAILER_CLOSED,
	RETURN_REFERENCE_NUMBER,
	LAST_UPDATED_SOURCE_TYPE,
	ACTUAL_ARRIVAL_DTTM,
	CONTACT_ZIP,
	CREATED_SOURCE,
	CUT_NBR,
	QUALITY_CHECK_HOLD_UPON_RCPT,
	LAST_UPDATED_DTTM,
	EQUIPMENT_CODE,
	QUALITY_AUDIT_PERCENT,
	MFG_PLNT,
	APPOINTMENT_DURATION,
	IS_ASSOCIATED_TO_OUTBOUND,
	DESTINATION_FACILITY_ID,
	ASN_SHPMT_TYPE,
	APPOINTMENT_ID,
	ACTUAL_DEPARTURE_DTTM,
	IS_WHSE_TRANSFER,
	TC_COMPANY_ID,
	TOTAL_RECEIVED_QTY,
	DELIVERY_STOP_SEQ,
	FIRST_RECEIPT_DTTM,
	RECEIPT_VARIANCE,
	REF_FIELD_10,
	EQUIPMENT_CODE_ID,
	IS_CLOSED,
	REGION_ID,
	SHIPMENT_ID,
	TOTAL_SHIPPED_QTY,
	OUTBOUND_REGION_ID,
	LAST_RECEIPT_DTTM,
	LAST_UPDATED_SOURCE,
	BILL_OF_LADING_NUMBER,
	MISC_INSTR_CODE_2,
	INBOUND_REGION_NAME,
	MISC_INSTR_CODE_1,
	TRACTOR_CARRIER_CODE_ID,
	IS_CANCELLED,
	VOLUME_UOM_ID_BASE,
	CONTACT_COUNTRY_CODE,
	REF_NUM1,
	REF_NUM3,
	PICKUP_END_DTTM,
	DELIVERY_END_DTTM,
	REF_NUM2,
	TC_ASN_ID,
	MODE_ID,
	REF_NUM5,
	REF_NUM4,
	RECEIPT_DTTM,
	IS_COGI_GENERATED,
	EQUIPMENT_TYPE,
	CONTRAC_LOCN,
	VARIANCE_TYPE,
	INVOICE_NUMBER,
	TRACTOR_CARRIER_CODE,
	INBOUND_REGION_ID,
	HAS_IMPORT_ERROR,
	TC_ASN_ID_U,
	TOTAL_WEIGHT,
	EXT_CREATED_DTTM,
	current_timestamp() AS ARCHIVE_DTTM,
	CONTACT_STATE_PROV,
	HAS_PHOTOS,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED
    FROM XBPRDWMGOLD.PRD_GOLD_GB_XBWM19WM.ASN
    WHERE ASN.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())

    UNION

    SELECT 
    ASN_ID,
	SYSTEM_ALLOCATED,
	WEIGHT_UOM_ID_BASE,
	HAS_NOTES,
	ROUTE_ID,
	TC_SHIPMENT_ID,
	ASSIGNED_CARRIER_CODE_ID,
	INVOICE_DATE,
	ASN_PRIORITY,
	DESTINATION_TYPE,
	TRACTOR_NUMBER,
	RECEIPT_TYPE,
	HIBERNATE_VERSION,
	CONTACT_NUMBER,
	PRE_ALLOCATION_FIT_PERCENTAGE,
	REP_NAME,
	ASSIGNED_CARRIER_CODE,
	ALLOCATION_COMPLETED,
	LAST_TRANSMITTED_DTTM,
	MANIF_TYPE,
	APPOINTMENT_DTTM,
	ASN_LEVEL,
	CONTACT_COUNTY,
	MANIF_NBR,
	MHE_SENT,
	SHIPPED_LPN_COUNT,
	OUTBOUND_REGION_NAME,
	TRAILER_NUMBER,
	DC_ORD_NBR,
	TOTAL_VOLUME,
	HAS_ALERTS,
	CREATED_SOURCE_TYPE,
	FLOWTHROUGH_ALLOCATION_STATUS,
	ORIGINAL_ASN_ID,
	ASN_ORGN_TYPE,
	DOCK_DOOR_ID,
	CONTACT_CITY,
	ORIGIN_FACILITY_ALIAS_ID,
	FLOW_THRU_ALLOC_IN_PROG,
	LABEL_PRINT_REQD,
	VERIFIED_DTTM,
	SHIPPING_COST_CURRENCY_CODE,
	BUSINESS_PARTNER_ID,
	PALLET_FOOTPRINT,
	BUYER_CODE,
	CREATED_DTTM,
	SCHEDULE_APPT,
	SHIPPING_COST,
	RECEIVED_LPN_COUNT,
	ORIGIN_FACILITY_ID,
	CONTACT_ADDRESS_1,
	CONTACT_ADDRESS_2,
	DESTINATION_FACILITY_ALIAS_ID,
	CONTACT_ADDRESS_3,
	ASN_TYPE,
	INITIATE_FLAG,
	HAS_SOFT_CHECK_ERROR,
	QTY_UOM_ID_BASE,
	VERIFICATION_ATTEMPTED,
	ASN_STATUS,
	PRE_RECEIPT_STATUS,
	FIRM_APPT_IND,
	ACTUAL_SHIPPED_DTTM,
	DELIVERY_START_DTTM,
	REF_FIELD_9,
	ORIGINAL_ORDER_NUMBER,
	IS_GIFT,
	FLOW_THROUGH_ALLOCATION_METHOD,
	REF_FIELD_1,
	REF_FIELD_2,
	REF_FIELD_3,
	DRIVER_NAME,
	WORK_ORD_NBR,
	REF_FIELD_4,
	PRO_NUMBER,
	REF_FIELD_5,
	REF_FIELD_6,
	REF_FIELD_7,
	REF_FIELD_8,
	TRAILER_CLOSED,
	RETURN_REFERENCE_NUMBER,
	LAST_UPDATED_SOURCE_TYPE,
	ACTUAL_ARRIVAL_DTTM,
	CONTACT_ZIP,
	CREATED_SOURCE,
	CUT_NBR,
	QUALITY_CHECK_HOLD_UPON_RCPT,
	LAST_UPDATED_DTTM,
	EQUIPMENT_CODE,
	QUALITY_AUDIT_PERCENT,
	MFG_PLNT,
	APPOINTMENT_DURATION,
	IS_ASSOCIATED_TO_OUTBOUND,
	DESTINATION_FACILITY_ID,
	ASN_SHPMT_TYPE,
	APPOINTMENT_ID,
	ACTUAL_DEPARTURE_DTTM,
	IS_WHSE_TRANSFER,
	TC_COMPANY_ID,
	TOTAL_RECEIVED_QTY,
	DELIVERY_STOP_SEQ,
	FIRST_RECEIPT_DTTM,
	RECEIPT_VARIANCE,
	REF_FIELD_10,
	EQUIPMENT_CODE_ID,
	IS_CLOSED,
	REGION_ID,
	SHIPMENT_ID,
	TOTAL_SHIPPED_QTY,
	OUTBOUND_REGION_ID,
	LAST_RECEIPT_DTTM,
	LAST_UPDATED_SOURCE,
	BILL_OF_LADING_NUMBER,
	MISC_INSTR_CODE_2,
	INBOUND_REGION_NAME,
	MISC_INSTR_CODE_1,
	TRACTOR_CARRIER_CODE_ID,
	IS_CANCELLED,
	VOLUME_UOM_ID_BASE,
	CONTACT_COUNTRY_CODE,
	REF_NUM1,
	REF_NUM3,
	PICKUP_END_DTTM,
	DELIVERY_END_DTTM,
	REF_NUM2,
	TC_ASN_ID,
	MODE_ID,
	REF_NUM5,
	REF_NUM4,
	RECEIPT_DTTM,
	IS_COGI_GENERATED,
	EQUIPMENT_TYPE,
	CONTRAC_LOCN,
	VARIANCE_TYPE,
	INVOICE_NUMBER,
	TRACTOR_CARRIER_CODE,
	INBOUND_REGION_ID,
	HAS_IMPORT_ERROR,
	TC_ASN_ID_U,
	TOTAL_WEIGHT,
	EXT_CREATED_DTTM,
	current_timestamp() AS ARCHIVE_DTTM,
	CONTACT_STATE_PROV,
	HAS_PHOTOS,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED
    FROM XBPRDWMGOLD.PRD_GOLD_J_XBWM19WM.ASN
    WHERE ASN.ASN_ID  NOT IN (SELECT ASN_ID FROM XBPRDWMGOLD.PRD_GOLD_GB_XBWM19WM.ASN WHERE CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE()))

    UNION

    SELECT 
    ASN_ID,
	SYSTEM_ALLOCATED,
	WEIGHT_UOM_ID_BASE,
	HAS_NOTES,
	ROUTE_ID,
	TC_SHIPMENT_ID,
	ASSIGNED_CARRIER_CODE_ID,
	INVOICE_DATE,
	ASN_PRIORITY,
	DESTINATION_TYPE,
	TRACTOR_NUMBER,
	RECEIPT_TYPE,
	HIBERNATE_VERSION,
	CONTACT_NUMBER,
	PRE_ALLOCATION_FIT_PERCENTAGE,
	REP_NAME,
	ASSIGNED_CARRIER_CODE,
	ALLOCATION_COMPLETED,
	LAST_TRANSMITTED_DTTM,
	MANIF_TYPE,
	APPOINTMENT_DTTM,
	ASN_LEVEL,
	CONTACT_COUNTY,
	MANIF_NBR,
	MHE_SENT,
	SHIPPED_LPN_COUNT,
	OUTBOUND_REGION_NAME,
	TRAILER_NUMBER,
	DC_ORD_NBR,
	TOTAL_VOLUME,
	HAS_ALERTS,
	CREATED_SOURCE_TYPE,
	FLOWTHROUGH_ALLOCATION_STATUS,
	ORIGINAL_ASN_ID,
	ASN_ORGN_TYPE,
	DOCK_DOOR_ID,
	CONTACT_CITY,
	ORIGIN_FACILITY_ALIAS_ID,
	FLOW_THRU_ALLOC_IN_PROG,
	LABEL_PRINT_REQD,
	VERIFIED_DTTM,
	SHIPPING_COST_CURRENCY_CODE,
	BUSINESS_PARTNER_ID,
	PALLET_FOOTPRINT,
	BUYER_CODE,
	CREATED_DTTM,
	SCHEDULE_APPT,
	SHIPPING_COST,
	RECEIVED_LPN_COUNT,
	ORIGIN_FACILITY_ID,
	CONTACT_ADDRESS_1,
	CONTACT_ADDRESS_2,
	DESTINATION_FACILITY_ALIAS_ID,
	CONTACT_ADDRESS_3,
	ASN_TYPE,
	INITIATE_FLAG,
	HAS_SOFT_CHECK_ERROR,
	QTY_UOM_ID_BASE,
	VERIFICATION_ATTEMPTED,
	ASN_STATUS,
	PRE_RECEIPT_STATUS,
	FIRM_APPT_IND,
	ACTUAL_SHIPPED_DTTM,
	DELIVERY_START_DTTM,
	REF_FIELD_9,
	ORIGINAL_ORDER_NUMBER,
	IS_GIFT,
	FLOW_THROUGH_ALLOCATION_METHOD,
	REF_FIELD_1,
	REF_FIELD_2,
	REF_FIELD_3,
	DRIVER_NAME,
	WORK_ORD_NBR,
	REF_FIELD_4,
	PRO_NUMBER,
	REF_FIELD_5,
	REF_FIELD_6,
	REF_FIELD_7,
	REF_FIELD_8,
	TRAILER_CLOSED,
	RETURN_REFERENCE_NUMBER,
	LAST_UPDATED_SOURCE_TYPE,
	ACTUAL_ARRIVAL_DTTM,
	CONTACT_ZIP,
	CREATED_SOURCE,
	CUT_NBR,
	QUALITY_CHECK_HOLD_UPON_RCPT,
	LAST_UPDATED_DTTM,
	EQUIPMENT_CODE,
	QUALITY_AUDIT_PERCENT,
	MFG_PLNT,
	APPOINTMENT_DURATION,
	IS_ASSOCIATED_TO_OUTBOUND,
	DESTINATION_FACILITY_ID,
	ASN_SHPMT_TYPE,
	APPOINTMENT_ID,
	ACTUAL_DEPARTURE_DTTM,
	IS_WHSE_TRANSFER,
	TC_COMPANY_ID,
	TOTAL_RECEIVED_QTY,
	DELIVERY_STOP_SEQ,
	FIRST_RECEIPT_DTTM,
	RECEIPT_VARIANCE,
	REF_FIELD_10,
	EQUIPMENT_CODE_ID,
	IS_CLOSED,
	REGION_ID,
	SHIPMENT_ID,
	TOTAL_SHIPPED_QTY,
	OUTBOUND_REGION_ID,
	LAST_RECEIPT_DTTM,
	LAST_UPDATED_SOURCE,
	BILL_OF_LADING_NUMBER,
	MISC_INSTR_CODE_2,
	INBOUND_REGION_NAME,
	MISC_INSTR_CODE_1,
	TRACTOR_CARRIER_CODE_ID,
	IS_CANCELLED,
	VOLUME_UOM_ID_BASE,
	CONTACT_COUNTRY_CODE,
	REF_NUM1,
	REF_NUM3,
	PICKUP_END_DTTM,
	DELIVERY_END_DTTM,
	REF_NUM2,
	TC_ASN_ID,
	MODE_ID,
	REF_NUM5,
	REF_NUM4,
	RECEIPT_DTTM,
	IS_COGI_GENERATED,
	EQUIPMENT_TYPE,
	CONTRAC_LOCN,
	VARIANCE_TYPE,
	INVOICE_NUMBER,
	TRACTOR_CARRIER_CODE,
	INBOUND_REGION_ID,
	HAS_IMPORT_ERROR,
	TC_ASN_ID_U,
	TOTAL_WEIGHT,
	EXT_CREATED_DTTM,
	ARCHIVE_DTTM,
	CONTACT_STATE_PROV,
	HAS_PHOTOS,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED
    FROM XBPRDARCHGOLD.ARCH_GOLD_G_XBWM19ARCH.ASN
    WHERE ASN.ASN_ID  NOT IN (
    SELECT ASN_ID FROM XBPRDWMGOLD.PRD_GOLD_GB_XBWM19WM.ASN WHERE ASN.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())
    )
    AND ASN.ASN_ID  NOT IN (SELECT ASN_ID FROM XBPRDWMGOLD.PRD_GOLD_J_XBWM19WM.ASN)
    
;

-- SILVER
CREATE OR REPLACE TABLE ETL.SILVER_ARCH.ASN
AS
    SELECT 
    ASN_ID,
	SYSTEM_ALLOCATED,
	WEIGHT_UOM_ID_BASE,
	HAS_NOTES,
	ROUTE_ID,
	TC_SHIPMENT_ID,
	ASSIGNED_CARRIER_CODE_ID,
	INVOICE_DATE,
	ASN_PRIORITY,
	DESTINATION_TYPE,
	TRACTOR_NUMBER,
	RECEIPT_TYPE,
	HIBERNATE_VERSION,
	CONTACT_NUMBER,
	PRE_ALLOCATION_FIT_PERCENTAGE,
	REP_NAME,
	ASSIGNED_CARRIER_CODE,
	ALLOCATION_COMPLETED,
	LAST_TRANSMITTED_DTTM,
	MANIF_TYPE,
	APPOINTMENT_DTTM,
	ASN_LEVEL,
	CONTACT_COUNTY,
	MANIF_NBR,
	MHE_SENT,
	SHIPPED_LPN_COUNT,
	OUTBOUND_REGION_NAME,
	TRAILER_NUMBER,
	DC_ORD_NBR,
	TOTAL_VOLUME,
	HAS_ALERTS,
	CREATED_SOURCE_TYPE,
	FLOWTHROUGH_ALLOCATION_STATUS,
	ORIGINAL_ASN_ID,
	ASN_ORGN_TYPE,
	DOCK_DOOR_ID,
	CONTACT_CITY,
	ORIGIN_FACILITY_ALIAS_ID,
	FLOW_THRU_ALLOC_IN_PROG,
	LABEL_PRINT_REQD,
	VERIFIED_DTTM,
	SHIPPING_COST_CURRENCY_CODE,
	BUSINESS_PARTNER_ID,
	PALLET_FOOTPRINT,
	BUYER_CODE,
	CREATED_DTTM,
	SCHEDULE_APPT,
	SHIPPING_COST,
	RECEIVED_LPN_COUNT,
	ORIGIN_FACILITY_ID,
	CONTACT_ADDRESS_1,
	CONTACT_ADDRESS_2,
	DESTINATION_FACILITY_ALIAS_ID,
	CONTACT_ADDRESS_3,
	ASN_TYPE,
	INITIATE_FLAG,
	HAS_SOFT_CHECK_ERROR,
	QTY_UOM_ID_BASE,
	VERIFICATION_ATTEMPTED,
	ASN_STATUS,
	PRE_RECEIPT_STATUS,
	FIRM_APPT_IND,
	ACTUAL_SHIPPED_DTTM,
	DELIVERY_START_DTTM,
	REF_FIELD_9,
	ORIGINAL_ORDER_NUMBER,
	IS_GIFT,
	FLOW_THROUGH_ALLOCATION_METHOD,
	REF_FIELD_1,
	REF_FIELD_2,
	REF_FIELD_3,
	DRIVER_NAME,
	WORK_ORD_NBR,
	REF_FIELD_4,
	PRO_NUMBER,
	REF_FIELD_5,
	REF_FIELD_6,
	REF_FIELD_7,
	REF_FIELD_8,
	TRAILER_CLOSED,
	RETURN_REFERENCE_NUMBER,
	LAST_UPDATED_SOURCE_TYPE,
	ACTUAL_ARRIVAL_DTTM,
	CONTACT_ZIP,
	CREATED_SOURCE,
	CUT_NBR,
	QUALITY_CHECK_HOLD_UPON_RCPT,
	LAST_UPDATED_DTTM,
	EQUIPMENT_CODE,
	QUALITY_AUDIT_PERCENT,
	MFG_PLNT,
	APPOINTMENT_DURATION,
	IS_ASSOCIATED_TO_OUTBOUND,
	DESTINATION_FACILITY_ID,
	ASN_SHPMT_TYPE,
	APPOINTMENT_ID,
	ACTUAL_DEPARTURE_DTTM,
	IS_WHSE_TRANSFER,
	TC_COMPANY_ID,
	TOTAL_RECEIVED_QTY,
	DELIVERY_STOP_SEQ,
	FIRST_RECEIPT_DTTM,
	RECEIPT_VARIANCE,
	REF_FIELD_10,
	EQUIPMENT_CODE_ID,
	IS_CLOSED,
	REGION_ID,
	SHIPMENT_ID,
	TOTAL_SHIPPED_QTY,
	OUTBOUND_REGION_ID,
	LAST_RECEIPT_DTTM,
	LAST_UPDATED_SOURCE,
	BILL_OF_LADING_NUMBER,
	MISC_INSTR_CODE_2,
	INBOUND_REGION_NAME,
	MISC_INSTR_CODE_1,
	TRACTOR_CARRIER_CODE_ID,
	IS_CANCELLED,
	VOLUME_UOM_ID_BASE,
	CONTACT_COUNTRY_CODE,
	REF_NUM1,
	REF_NUM3,
	PICKUP_END_DTTM,
	DELIVERY_END_DTTM,
	REF_NUM2,
	TC_ASN_ID,
	MODE_ID,
	REF_NUM5,
	REF_NUM4,
	RECEIPT_DTTM,
	IS_COGI_GENERATED,
	EQUIPMENT_TYPE,
	CONTRAC_LOCN,
	VARIANCE_TYPE,
	INVOICE_NUMBER,
	TRACTOR_CARRIER_CODE,
	INBOUND_REGION_ID,
	HAS_IMPORT_ERROR,
	TC_ASN_ID_U,
	TOTAL_WEIGHT,
	EXT_CREATED_DTTM,
	current_timestamp() AS ARCHIVE_DTTM,
	CONTACT_STATE_PROV,
	HAS_PHOTOS,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED
    FROM XBPRDWMSILVER.PRD_SILVER_GB_XBDBTJ3WM.ASN
    WHERE ASN.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())

    UNION

    SELECT 
    ASN_ID,
	SYSTEM_ALLOCATED,
	WEIGHT_UOM_ID_BASE,
	HAS_NOTES,
	ROUTE_ID,
	TC_SHIPMENT_ID,
	ASSIGNED_CARRIER_CODE_ID,
	INVOICE_DATE,
	ASN_PRIORITY,
	DESTINATION_TYPE,
	TRACTOR_NUMBER,
	RECEIPT_TYPE,
	HIBERNATE_VERSION,
	CONTACT_NUMBER,
	PRE_ALLOCATION_FIT_PERCENTAGE,
	REP_NAME,
	ASSIGNED_CARRIER_CODE,
	ALLOCATION_COMPLETED,
	LAST_TRANSMITTED_DTTM,
	MANIF_TYPE,
	APPOINTMENT_DTTM,
	ASN_LEVEL,
	CONTACT_COUNTY,
	MANIF_NBR,
	MHE_SENT,
	SHIPPED_LPN_COUNT,
	OUTBOUND_REGION_NAME,
	TRAILER_NUMBER,
	DC_ORD_NBR,
	TOTAL_VOLUME,
	HAS_ALERTS,
	CREATED_SOURCE_TYPE,
	FLOWTHROUGH_ALLOCATION_STATUS,
	ORIGINAL_ASN_ID,
	ASN_ORGN_TYPE,
	DOCK_DOOR_ID,
	CONTACT_CITY,
	ORIGIN_FACILITY_ALIAS_ID,
	FLOW_THRU_ALLOC_IN_PROG,
	LABEL_PRINT_REQD,
	VERIFIED_DTTM,
	SHIPPING_COST_CURRENCY_CODE,
	BUSINESS_PARTNER_ID,
	PALLET_FOOTPRINT,
	BUYER_CODE,
	CREATED_DTTM,
	SCHEDULE_APPT,
	SHIPPING_COST,
	RECEIVED_LPN_COUNT,
	ORIGIN_FACILITY_ID,
	CONTACT_ADDRESS_1,
	CONTACT_ADDRESS_2,
	DESTINATION_FACILITY_ALIAS_ID,
	CONTACT_ADDRESS_3,
	ASN_TYPE,
	INITIATE_FLAG,
	HAS_SOFT_CHECK_ERROR,
	QTY_UOM_ID_BASE,
	VERIFICATION_ATTEMPTED,
	ASN_STATUS,
	PRE_RECEIPT_STATUS,
	FIRM_APPT_IND,
	ACTUAL_SHIPPED_DTTM,
	DELIVERY_START_DTTM,
	REF_FIELD_9,
	ORIGINAL_ORDER_NUMBER,
	IS_GIFT,
	FLOW_THROUGH_ALLOCATION_METHOD,
	REF_FIELD_1,
	REF_FIELD_2,
	REF_FIELD_3,
	DRIVER_NAME,
	WORK_ORD_NBR,
	REF_FIELD_4,
	PRO_NUMBER,
	REF_FIELD_5,
	REF_FIELD_6,
	REF_FIELD_7,
	REF_FIELD_8,
	TRAILER_CLOSED,
	RETURN_REFERENCE_NUMBER,
	LAST_UPDATED_SOURCE_TYPE,
	ACTUAL_ARRIVAL_DTTM,
	CONTACT_ZIP,
	CREATED_SOURCE,
	CUT_NBR,
	QUALITY_CHECK_HOLD_UPON_RCPT,
	LAST_UPDATED_DTTM,
	EQUIPMENT_CODE,
	QUALITY_AUDIT_PERCENT,
	MFG_PLNT,
	APPOINTMENT_DURATION,
	IS_ASSOCIATED_TO_OUTBOUND,
	DESTINATION_FACILITY_ID,
	ASN_SHPMT_TYPE,
	APPOINTMENT_ID,
	ACTUAL_DEPARTURE_DTTM,
	IS_WHSE_TRANSFER,
	TC_COMPANY_ID,
	TOTAL_RECEIVED_QTY,
	DELIVERY_STOP_SEQ,
	FIRST_RECEIPT_DTTM,
	RECEIPT_VARIANCE,
	REF_FIELD_10,
	EQUIPMENT_CODE_ID,
	IS_CLOSED,
	REGION_ID,
	SHIPMENT_ID,
	TOTAL_SHIPPED_QTY,
	OUTBOUND_REGION_ID,
	LAST_RECEIPT_DTTM,
	LAST_UPDATED_SOURCE,
	BILL_OF_LADING_NUMBER,
	MISC_INSTR_CODE_2,
	INBOUND_REGION_NAME,
	MISC_INSTR_CODE_1,
	TRACTOR_CARRIER_CODE_ID,
	IS_CANCELLED,
	VOLUME_UOM_ID_BASE,
	CONTACT_COUNTRY_CODE,
	REF_NUM1,
	REF_NUM3,
	PICKUP_END_DTTM,
	DELIVERY_END_DTTM,
	REF_NUM2,
	TC_ASN_ID,
	MODE_ID,
	REF_NUM5,
	REF_NUM4,
	RECEIPT_DTTM,
	IS_COGI_GENERATED,
	EQUIPMENT_TYPE,
	CONTRAC_LOCN,
	VARIANCE_TYPE,
	INVOICE_NUMBER,
	TRACTOR_CARRIER_CODE,
	INBOUND_REGION_ID,
	HAS_IMPORT_ERROR,
	TC_ASN_ID_U,
	TOTAL_WEIGHT,
	EXT_CREATED_DTTM,
	current_timestamp() AS ARCHIVE_DTTM,
	CONTACT_STATE_PROV,
	HAS_PHOTOS,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED
    FROM XBPRDWMSILVER.PRD_SILVER_J_XBDBTJ3WM.ASN
    WHERE ASN.ASN_ID  NOT IN (SELECT ASN_ID FROM XBPRDWMSILVER.PRD_SILVER_GB_XBDBTJ3WM.ASN WHERE CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE()))

    UNION

    SELECT 
    ASN_ID,
	SYSTEM_ALLOCATED,
	WEIGHT_UOM_ID_BASE,
	HAS_NOTES,
	ROUTE_ID,
	TC_SHIPMENT_ID,
	ASSIGNED_CARRIER_CODE_ID,
	INVOICE_DATE,
	ASN_PRIORITY,
	DESTINATION_TYPE,
	TRACTOR_NUMBER,
	RECEIPT_TYPE,
	HIBERNATE_VERSION,
	CONTACT_NUMBER,
	PRE_ALLOCATION_FIT_PERCENTAGE,
	REP_NAME,
	ASSIGNED_CARRIER_CODE,
	ALLOCATION_COMPLETED,
	LAST_TRANSMITTED_DTTM,
	MANIF_TYPE,
	APPOINTMENT_DTTM,
	ASN_LEVEL,
	CONTACT_COUNTY,
	MANIF_NBR,
	MHE_SENT,
	SHIPPED_LPN_COUNT,
	OUTBOUND_REGION_NAME,
	TRAILER_NUMBER,
	DC_ORD_NBR,
	TOTAL_VOLUME,
	HAS_ALERTS,
	CREATED_SOURCE_TYPE,
	FLOWTHROUGH_ALLOCATION_STATUS,
	ORIGINAL_ASN_ID,
	ASN_ORGN_TYPE,
	DOCK_DOOR_ID,
	CONTACT_CITY,
	ORIGIN_FACILITY_ALIAS_ID,
	FLOW_THRU_ALLOC_IN_PROG,
	LABEL_PRINT_REQD,
	VERIFIED_DTTM,
	SHIPPING_COST_CURRENCY_CODE,
	BUSINESS_PARTNER_ID,
	PALLET_FOOTPRINT,
	BUYER_CODE,
	CREATED_DTTM,
	SCHEDULE_APPT,
	SHIPPING_COST,
	RECEIVED_LPN_COUNT,
	ORIGIN_FACILITY_ID,
	CONTACT_ADDRESS_1,
	CONTACT_ADDRESS_2,
	DESTINATION_FACILITY_ALIAS_ID,
	CONTACT_ADDRESS_3,
	ASN_TYPE,
	INITIATE_FLAG,
	HAS_SOFT_CHECK_ERROR,
	QTY_UOM_ID_BASE,
	VERIFICATION_ATTEMPTED,
	ASN_STATUS,
	PRE_RECEIPT_STATUS,
	FIRM_APPT_IND,
	ACTUAL_SHIPPED_DTTM,
	DELIVERY_START_DTTM,
	REF_FIELD_9,
	ORIGINAL_ORDER_NUMBER,
	IS_GIFT,
	FLOW_THROUGH_ALLOCATION_METHOD,
	REF_FIELD_1,
	REF_FIELD_2,
	REF_FIELD_3,
	DRIVER_NAME,
	WORK_ORD_NBR,
	REF_FIELD_4,
	PRO_NUMBER,
	REF_FIELD_5,
	REF_FIELD_6,
	REF_FIELD_7,
	REF_FIELD_8,
	TRAILER_CLOSED,
	RETURN_REFERENCE_NUMBER,
	LAST_UPDATED_SOURCE_TYPE,
	ACTUAL_ARRIVAL_DTTM,
	CONTACT_ZIP,
	CREATED_SOURCE,
	CUT_NBR,
	QUALITY_CHECK_HOLD_UPON_RCPT,
	LAST_UPDATED_DTTM,
	EQUIPMENT_CODE,
	QUALITY_AUDIT_PERCENT,
	MFG_PLNT,
	APPOINTMENT_DURATION,
	IS_ASSOCIATED_TO_OUTBOUND,
	DESTINATION_FACILITY_ID,
	ASN_SHPMT_TYPE,
	APPOINTMENT_ID,
	ACTUAL_DEPARTURE_DTTM,
	IS_WHSE_TRANSFER,
	TC_COMPANY_ID,
	TOTAL_RECEIVED_QTY,
	DELIVERY_STOP_SEQ,
	FIRST_RECEIPT_DTTM,
	RECEIPT_VARIANCE,
	REF_FIELD_10,
	EQUIPMENT_CODE_ID,
	IS_CLOSED,
	REGION_ID,
	SHIPMENT_ID,
	TOTAL_SHIPPED_QTY,
	OUTBOUND_REGION_ID,
	LAST_RECEIPT_DTTM,
	LAST_UPDATED_SOURCE,
	BILL_OF_LADING_NUMBER,
	MISC_INSTR_CODE_2,
	INBOUND_REGION_NAME,
	MISC_INSTR_CODE_1,
	TRACTOR_CARRIER_CODE_ID,
	IS_CANCELLED,
	VOLUME_UOM_ID_BASE,
	CONTACT_COUNTRY_CODE,
	REF_NUM1,
	REF_NUM3,
	PICKUP_END_DTTM,
	DELIVERY_END_DTTM,
	REF_NUM2,
	TC_ASN_ID,
	MODE_ID,
	REF_NUM5,
	REF_NUM4,
	RECEIPT_DTTM,
	IS_COGI_GENERATED,
	EQUIPMENT_TYPE,
	CONTRAC_LOCN,
	VARIANCE_TYPE,
	INVOICE_NUMBER,
	TRACTOR_CARRIER_CODE,
	INBOUND_REGION_ID,
	HAS_IMPORT_ERROR,
	TC_ASN_ID_U,
	TOTAL_WEIGHT,
	EXT_CREATED_DTTM,
	ARCHIVE_DTTM,
	CONTACT_STATE_PROV,
	HAS_PHOTOS,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED
    FROM XBPRDARCHSILVER.ARCH_SILVER_G_XBWM19ARCH.ASN
    WHERE ASN.ASN_ID  NOT IN (
    SELECT ASN_ID FROM XBPRDWMSILVER.PRD_SILVER_GB_XBDBTJ3WM.ASN WHERE ASN.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())
    )
    AND ASN.ASN_ID  NOT IN (SELECT ASN_ID FROM XBPRDWMSILVER.PRD_SILVER_J_XBDBTJ3WM.ASN)
    
;

-- RY
CREATE OR REPLACE TABLE ETL.RY_ARCH.ASN
AS
    SELECT 
    ASN_ID,
	SYSTEM_ALLOCATED,
	WEIGHT_UOM_ID_BASE,
	HAS_NOTES,
	ROUTE_ID,
	TC_SHIPMENT_ID,
	ASSIGNED_CARRIER_CODE_ID,
	INVOICE_DATE,
	ASN_PRIORITY,
	DESTINATION_TYPE,
	TRACTOR_NUMBER,
	RECEIPT_TYPE,
	HIBERNATE_VERSION,
	CONTACT_NUMBER,
	PRE_ALLOCATION_FIT_PERCENTAGE,
	REP_NAME,
	ASSIGNED_CARRIER_CODE,
	ALLOCATION_COMPLETED,
	LAST_TRANSMITTED_DTTM,
	MANIF_TYPE,
	APPOINTMENT_DTTM,
	ASN_LEVEL,
	CONTACT_COUNTY,
	MANIF_NBR,
	MHE_SENT,
	SHIPPED_LPN_COUNT,
	OUTBOUND_REGION_NAME,
	TRAILER_NUMBER,
	DC_ORD_NBR,
	TOTAL_VOLUME,
	HAS_ALERTS,
	CREATED_SOURCE_TYPE,
	FLOWTHROUGH_ALLOCATION_STATUS,
	ORIGINAL_ASN_ID,
	ASN_ORGN_TYPE,
	DOCK_DOOR_ID,
	CONTACT_CITY,
	ORIGIN_FACILITY_ALIAS_ID,
	FLOW_THRU_ALLOC_IN_PROG,
	LABEL_PRINT_REQD,
	VERIFIED_DTTM,
	SHIPPING_COST_CURRENCY_CODE,
	BUSINESS_PARTNER_ID,
	PALLET_FOOTPRINT,
	BUYER_CODE,
	CREATED_DTTM,
	SCHEDULE_APPT,
	SHIPPING_COST,
	RECEIVED_LPN_COUNT,
	ORIGIN_FACILITY_ID,
	CONTACT_ADDRESS_1,
	CONTACT_ADDRESS_2,
	DESTINATION_FACILITY_ALIAS_ID,
	CONTACT_ADDRESS_3,
	ASN_TYPE,
	INITIATE_FLAG,
	HAS_SOFT_CHECK_ERROR,
	QTY_UOM_ID_BASE,
	VERIFICATION_ATTEMPTED,
	ASN_STATUS,
	PRE_RECEIPT_STATUS,
	FIRM_APPT_IND,
	ACTUAL_SHIPPED_DTTM,
	DELIVERY_START_DTTM,
	REF_FIELD_9,
	ORIGINAL_ORDER_NUMBER,
	IS_GIFT,
	FLOW_THROUGH_ALLOCATION_METHOD,
	REF_FIELD_1,
	REF_FIELD_2,
	REF_FIELD_3,
	DRIVER_NAME,
	WORK_ORD_NBR,
	REF_FIELD_4,
	PRO_NUMBER,
	REF_FIELD_5,
	REF_FIELD_6,
	REF_FIELD_7,
	REF_FIELD_8,
	TRAILER_CLOSED,
	RETURN_REFERENCE_NUMBER,
	LAST_UPDATED_SOURCE_TYPE,
	ACTUAL_ARRIVAL_DTTM,
	CONTACT_ZIP,
	CREATED_SOURCE,
	CUT_NBR,
	QUALITY_CHECK_HOLD_UPON_RCPT,
	LAST_UPDATED_DTTM,
	EQUIPMENT_CODE,
	QUALITY_AUDIT_PERCENT,
	MFG_PLNT,
	APPOINTMENT_DURATION,
	IS_ASSOCIATED_TO_OUTBOUND,
	DESTINATION_FACILITY_ID,
	ASN_SHPMT_TYPE,
	APPOINTMENT_ID,
	ACTUAL_DEPARTURE_DTTM,
	IS_WHSE_TRANSFER,
	TC_COMPANY_ID,
	TOTAL_RECEIVED_QTY,
	DELIVERY_STOP_SEQ,
	FIRST_RECEIPT_DTTM,
	RECEIPT_VARIANCE,
	REF_FIELD_10,
	EQUIPMENT_CODE_ID,
	IS_CLOSED,
	REGION_ID,
	SHIPMENT_ID,
	TOTAL_SHIPPED_QTY,
	OUTBOUND_REGION_ID,
	LAST_RECEIPT_DTTM,
	LAST_UPDATED_SOURCE,
	BILL_OF_LADING_NUMBER,
	MISC_INSTR_CODE_2,
	INBOUND_REGION_NAME,
	MISC_INSTR_CODE_1,
	TRACTOR_CARRIER_CODE_ID,
	IS_CANCELLED,
	VOLUME_UOM_ID_BASE,
	CONTACT_COUNTRY_CODE,
	REF_NUM1,
	REF_NUM3,
	PICKUP_END_DTTM,
	DELIVERY_END_DTTM,
	REF_NUM2,
	TC_ASN_ID,
	MODE_ID,
	REF_NUM5,
	REF_NUM4,
	RECEIPT_DTTM,
	IS_COGI_GENERATED,
	EQUIPMENT_TYPE,
	CONTRAC_LOCN,
	VARIANCE_TYPE,
	INVOICE_NUMBER,
	TRACTOR_CARRIER_CODE,
	INBOUND_REGION_ID,
	HAS_IMPORT_ERROR,
	TC_ASN_ID_U,
	TOTAL_WEIGHT,
	EXT_CREATED_DTTM,
	current_timestamp() AS ARCHIVE_DTTM,
	CONTACT_STATE_PROV,
	HAS_PHOTOS,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED
    FROM XBPRDWMRY.PRD_RY_GB_XBORPRDWM.ASN
    WHERE ASN.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())

    UNION

    SELECT 
    ASN_ID,
	SYSTEM_ALLOCATED,
	WEIGHT_UOM_ID_BASE,
	HAS_NOTES,
	ROUTE_ID,
	TC_SHIPMENT_ID,
	ASSIGNED_CARRIER_CODE_ID,
	INVOICE_DATE,
	ASN_PRIORITY,
	DESTINATION_TYPE,
	TRACTOR_NUMBER,
	RECEIPT_TYPE,
	HIBERNATE_VERSION,
	CONTACT_NUMBER,
	PRE_ALLOCATION_FIT_PERCENTAGE,
	REP_NAME,
	ASSIGNED_CARRIER_CODE,
	ALLOCATION_COMPLETED,
	LAST_TRANSMITTED_DTTM,
	MANIF_TYPE,
	APPOINTMENT_DTTM,
	ASN_LEVEL,
	CONTACT_COUNTY,
	MANIF_NBR,
	MHE_SENT,
	SHIPPED_LPN_COUNT,
	OUTBOUND_REGION_NAME,
	TRAILER_NUMBER,
	DC_ORD_NBR,
	TOTAL_VOLUME,
	HAS_ALERTS,
	CREATED_SOURCE_TYPE,
	FLOWTHROUGH_ALLOCATION_STATUS,
	ORIGINAL_ASN_ID,
	ASN_ORGN_TYPE,
	DOCK_DOOR_ID,
	CONTACT_CITY,
	ORIGIN_FACILITY_ALIAS_ID,
	FLOW_THRU_ALLOC_IN_PROG,
	LABEL_PRINT_REQD,
	VERIFIED_DTTM,
	SHIPPING_COST_CURRENCY_CODE,
	BUSINESS_PARTNER_ID,
	PALLET_FOOTPRINT,
	BUYER_CODE,
	CREATED_DTTM,
	SCHEDULE_APPT,
	SHIPPING_COST,
	RECEIVED_LPN_COUNT,
	ORIGIN_FACILITY_ID,
	CONTACT_ADDRESS_1,
	CONTACT_ADDRESS_2,
	DESTINATION_FACILITY_ALIAS_ID,
	CONTACT_ADDRESS_3,
	ASN_TYPE,
	INITIATE_FLAG,
	HAS_SOFT_CHECK_ERROR,
	QTY_UOM_ID_BASE,
	VERIFICATION_ATTEMPTED,
	ASN_STATUS,
	PRE_RECEIPT_STATUS,
	FIRM_APPT_IND,
	ACTUAL_SHIPPED_DTTM,
	DELIVERY_START_DTTM,
	REF_FIELD_9,
	ORIGINAL_ORDER_NUMBER,
	IS_GIFT,
	FLOW_THROUGH_ALLOCATION_METHOD,
	REF_FIELD_1,
	REF_FIELD_2,
	REF_FIELD_3,
	DRIVER_NAME,
	WORK_ORD_NBR,
	REF_FIELD_4,
	PRO_NUMBER,
	REF_FIELD_5,
	REF_FIELD_6,
	REF_FIELD_7,
	REF_FIELD_8,
	TRAILER_CLOSED,
	RETURN_REFERENCE_NUMBER,
	LAST_UPDATED_SOURCE_TYPE,
	ACTUAL_ARRIVAL_DTTM,
	CONTACT_ZIP,
	CREATED_SOURCE,
	CUT_NBR,
	QUALITY_CHECK_HOLD_UPON_RCPT,
	LAST_UPDATED_DTTM,
	EQUIPMENT_CODE,
	QUALITY_AUDIT_PERCENT,
	MFG_PLNT,
	APPOINTMENT_DURATION,
	IS_ASSOCIATED_TO_OUTBOUND,
	DESTINATION_FACILITY_ID,
	ASN_SHPMT_TYPE,
	APPOINTMENT_ID,
	ACTUAL_DEPARTURE_DTTM,
	IS_WHSE_TRANSFER,
	TC_COMPANY_ID,
	TOTAL_RECEIVED_QTY,
	DELIVERY_STOP_SEQ,
	FIRST_RECEIPT_DTTM,
	RECEIPT_VARIANCE,
	REF_FIELD_10,
	EQUIPMENT_CODE_ID,
	IS_CLOSED,
	REGION_ID,
	SHIPMENT_ID,
	TOTAL_SHIPPED_QTY,
	OUTBOUND_REGION_ID,
	LAST_RECEIPT_DTTM,
	LAST_UPDATED_SOURCE,
	BILL_OF_LADING_NUMBER,
	MISC_INSTR_CODE_2,
	INBOUND_REGION_NAME,
	MISC_INSTR_CODE_1,
	TRACTOR_CARRIER_CODE_ID,
	IS_CANCELLED,
	VOLUME_UOM_ID_BASE,
	CONTACT_COUNTRY_CODE,
	REF_NUM1,
	REF_NUM3,
	PICKUP_END_DTTM,
	DELIVERY_END_DTTM,
	REF_NUM2,
	TC_ASN_ID,
	MODE_ID,
	REF_NUM5,
	REF_NUM4,
	RECEIPT_DTTM,
	IS_COGI_GENERATED,
	EQUIPMENT_TYPE,
	CONTRAC_LOCN,
	VARIANCE_TYPE,
	INVOICE_NUMBER,
	TRACTOR_CARRIER_CODE,
	INBOUND_REGION_ID,
	HAS_IMPORT_ERROR,
	TC_ASN_ID_U,
	TOTAL_WEIGHT,
	EXT_CREATED_DTTM,
	current_timestamp() AS ARCHIVE_DTTM,
	CONTACT_STATE_PROV,
	HAS_PHOTOS,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED
    FROM XBPRDWMRY.PRD_RY_J_XBORPRDWM.ASN
    WHERE ASN.ASN_ID  NOT IN (SELECT ASN_ID FROM XBPRDWMRY.PRD_RY_GB_XBORPRDWM.ASN WHERE CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE()))

    UNION

    SELECT 
    ASN_ID,
	SYSTEM_ALLOCATED,
	WEIGHT_UOM_ID_BASE,
	HAS_NOTES,
	ROUTE_ID,
	TC_SHIPMENT_ID,
	ASSIGNED_CARRIER_CODE_ID,
	INVOICE_DATE,
	ASN_PRIORITY,
	DESTINATION_TYPE,
	TRACTOR_NUMBER,
	RECEIPT_TYPE,
	HIBERNATE_VERSION,
	CONTACT_NUMBER,
	PRE_ALLOCATION_FIT_PERCENTAGE,
	REP_NAME,
	ASSIGNED_CARRIER_CODE,
	ALLOCATION_COMPLETED,
	LAST_TRANSMITTED_DTTM,
	MANIF_TYPE,
	APPOINTMENT_DTTM,
	ASN_LEVEL,
	CONTACT_COUNTY,
	MANIF_NBR,
	MHE_SENT,
	SHIPPED_LPN_COUNT,
	OUTBOUND_REGION_NAME,
	TRAILER_NUMBER,
	DC_ORD_NBR,
	TOTAL_VOLUME,
	HAS_ALERTS,
	CREATED_SOURCE_TYPE,
	FLOWTHROUGH_ALLOCATION_STATUS,
	ORIGINAL_ASN_ID,
	ASN_ORGN_TYPE,
	DOCK_DOOR_ID,
	CONTACT_CITY,
	ORIGIN_FACILITY_ALIAS_ID,
	FLOW_THRU_ALLOC_IN_PROG,
	LABEL_PRINT_REQD,
	VERIFIED_DTTM,
	SHIPPING_COST_CURRENCY_CODE,
	BUSINESS_PARTNER_ID,
	PALLET_FOOTPRINT,
	BUYER_CODE,
	CREATED_DTTM,
	SCHEDULE_APPT,
	SHIPPING_COST,
	RECEIVED_LPN_COUNT,
	ORIGIN_FACILITY_ID,
	CONTACT_ADDRESS_1,
	CONTACT_ADDRESS_2,
	DESTINATION_FACILITY_ALIAS_ID,
	CONTACT_ADDRESS_3,
	ASN_TYPE,
	INITIATE_FLAG,
	HAS_SOFT_CHECK_ERROR,
	QTY_UOM_ID_BASE,
	VERIFICATION_ATTEMPTED,
	ASN_STATUS,
	PRE_RECEIPT_STATUS,
	FIRM_APPT_IND,
	ACTUAL_SHIPPED_DTTM,
	DELIVERY_START_DTTM,
	REF_FIELD_9,
	ORIGINAL_ORDER_NUMBER,
	IS_GIFT,
	FLOW_THROUGH_ALLOCATION_METHOD,
	REF_FIELD_1,
	REF_FIELD_2,
	REF_FIELD_3,
	DRIVER_NAME,
	WORK_ORD_NBR,
	REF_FIELD_4,
	PRO_NUMBER,
	REF_FIELD_5,
	REF_FIELD_6,
	REF_FIELD_7,
	REF_FIELD_8,
	TRAILER_CLOSED,
	RETURN_REFERENCE_NUMBER,
	LAST_UPDATED_SOURCE_TYPE,
	ACTUAL_ARRIVAL_DTTM,
	CONTACT_ZIP,
	CREATED_SOURCE,
	CUT_NBR,
	QUALITY_CHECK_HOLD_UPON_RCPT,
	LAST_UPDATED_DTTM,
	EQUIPMENT_CODE,
	QUALITY_AUDIT_PERCENT,
	MFG_PLNT,
	APPOINTMENT_DURATION,
	IS_ASSOCIATED_TO_OUTBOUND,
	DESTINATION_FACILITY_ID,
	ASN_SHPMT_TYPE,
	APPOINTMENT_ID,
	ACTUAL_DEPARTURE_DTTM,
	IS_WHSE_TRANSFER,
	TC_COMPANY_ID,
	TOTAL_RECEIVED_QTY,
	DELIVERY_STOP_SEQ,
	FIRST_RECEIPT_DTTM,
	RECEIPT_VARIANCE,
	REF_FIELD_10,
	EQUIPMENT_CODE_ID,
	IS_CLOSED,
	REGION_ID,
	SHIPMENT_ID,
	TOTAL_SHIPPED_QTY,
	OUTBOUND_REGION_ID,
	LAST_RECEIPT_DTTM,
	LAST_UPDATED_SOURCE,
	BILL_OF_LADING_NUMBER,
	MISC_INSTR_CODE_2,
	INBOUND_REGION_NAME,
	MISC_INSTR_CODE_1,
	TRACTOR_CARRIER_CODE_ID,
	IS_CANCELLED,
	VOLUME_UOM_ID_BASE,
	CONTACT_COUNTRY_CODE,
	REF_NUM1,
	REF_NUM3,
	PICKUP_END_DTTM,
	DELIVERY_END_DTTM,
	REF_NUM2,
	TC_ASN_ID,
	MODE_ID,
	REF_NUM5,
	REF_NUM4,
	RECEIPT_DTTM,
	IS_COGI_GENERATED,
	EQUIPMENT_TYPE,
	CONTRAC_LOCN,
	VARIANCE_TYPE,
	INVOICE_NUMBER,
	TRACTOR_CARRIER_CODE,
	INBOUND_REGION_ID,
	HAS_IMPORT_ERROR,
	TC_ASN_ID_U,
	TOTAL_WEIGHT,
	EXT_CREATED_DTTM,
	ARCHIVE_DTTM,
	CONTACT_STATE_PROV,
	HAS_PHOTOS,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED
    FROM XBPRDARCHREYNOSA.ARCHIVE_REYNOSA_XBORPRDARCH.ASN
    WHERE ASN.ASN_ID  NOT IN (
    SELECT ASN_ID FROM XBPRDWMRY.PRD_RY_GB_XBORPRDWM.ASN WHERE ASN.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())
    )
    AND ASN.ASN_ID  NOT IN (SELECT ASN_ID FROM XBPRDWMRY.PRD_RY_J_XBORPRDWM.ASN)
    
;


--------------------------------------
---------------- SP_ASN GOLD
SELECT COUNT(*) FROM ETL.RY_ARCH.ASN WHERE ARCHIVE_DTTM IS NULL;

CALL ETL.GOLD_ARCH.SP_UPDATE_ETL_ASN_GOLD();

CREATE OR REPLACE PROCEDURE ETL.GOLD_ARCH.SP_UPDATE_ETL_ASN_GOLD()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER 
   AS
        BEGIN 
            MERGE INTO ETL.GOLD_ARCH.ASN AS TARGET
            USING
            (
                SELECT *, current_timestamp() AS ARCHIVE_DTTM
                FROM XBPRDWMGOLD.PRD_GOLD_GB_XBWM19WM.ASN
                WHERE ASN.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())
            ) AS SOURCE

            ON TARGET.ASN_ID = SOURCE.ASN_ID
                WHEN MATCHED AND TARGET.LAST_UPDATED_DTTM < SOURCE.LAST_UPDATED_DTTM 
                    THEN UPDATE SET
                        TARGET.ASN_ID = SOURCE.ASN_ID,
                        TARGET.SYSTEM_ALLOCATED = SOURCE.SYSTEM_ALLOCATED,
                        TARGET.WEIGHT_UOM_ID_BASE = SOURCE.WEIGHT_UOM_ID_BASE,
                        TARGET.HAS_NOTES = SOURCE.HAS_NOTES,
                        TARGET.ROUTE_ID = SOURCE.ROUTE_ID,
                        TARGET.TC_SHIPMENT_ID = SOURCE.TC_SHIPMENT_ID,
                        TARGET.ASSIGNED_CARRIER_CODE_ID = SOURCE.ASSIGNED_CARRIER_CODE_ID,
                        TARGET.INVOICE_DATE = SOURCE.INVOICE_DATE,
                        TARGET.ASN_PRIORITY = SOURCE.ASN_PRIORITY,
                        TARGET.DESTINATION_TYPE = SOURCE.DESTINATION_TYPE,
                        TARGET.TRACTOR_NUMBER = SOURCE.TRACTOR_NUMBER,
                        TARGET.RECEIPT_TYPE = SOURCE.RECEIPT_TYPE,
                        TARGET.HIBERNATE_VERSION = SOURCE.HIBERNATE_VERSION,
                        TARGET.CONTACT_NUMBER = SOURCE.CONTACT_NUMBER,
                        TARGET.PRE_ALLOCATION_FIT_PERCENTAGE = SOURCE.PRE_ALLOCATION_FIT_PERCENTAGE,
                        TARGET.REP_NAME = SOURCE.REP_NAME,
                        TARGET.ASSIGNED_CARRIER_CODE = SOURCE.ASSIGNED_CARRIER_CODE,
                        TARGET.ALLOCATION_COMPLETED = SOURCE.ALLOCATION_COMPLETED,
                        TARGET.LAST_TRANSMITTED_DTTM = SOURCE.LAST_TRANSMITTED_DTTM,
                        TARGET.MANIF_TYPE = SOURCE.MANIF_TYPE,
                        TARGET.APPOINTMENT_DTTM = SOURCE.APPOINTMENT_DTTM,
                        TARGET.ASN_LEVEL = SOURCE.ASN_LEVEL,
                        TARGET.CONTACT_COUNTY = SOURCE.CONTACT_COUNTY,
                        TARGET.MANIF_NBR = SOURCE.MANIF_NBR,
                        TARGET.MHE_SENT = SOURCE.MHE_SENT,
                        TARGET.SHIPPED_LPN_COUNT = SOURCE.SHIPPED_LPN_COUNT,
                        TARGET.OUTBOUND_REGION_NAME = SOURCE.OUTBOUND_REGION_NAME,
                        TARGET.TRAILER_NUMBER = SOURCE.TRAILER_NUMBER,
                        TARGET.DC_ORD_NBR = SOURCE.DC_ORD_NBR,
                        TARGET.TOTAL_VOLUME = SOURCE.TOTAL_VOLUME,
                        TARGET.HAS_ALERTS = SOURCE.HAS_ALERTS,
                        TARGET.CREATED_SOURCE_TYPE = SOURCE.CREATED_SOURCE_TYPE,
                        TARGET.FLOWTHROUGH_ALLOCATION_STATUS = SOURCE.FLOWTHROUGH_ALLOCATION_STATUS,
                        TARGET.ORIGINAL_ASN_ID = SOURCE.ORIGINAL_ASN_ID,
                        TARGET.ASN_ORGN_TYPE = SOURCE.ASN_ORGN_TYPE,
                        TARGET.DOCK_DOOR_ID = SOURCE.DOCK_DOOR_ID,
                        TARGET.CONTACT_CITY = SOURCE.CONTACT_CITY,
                        TARGET.ORIGIN_FACILITY_ALIAS_ID = SOURCE.ORIGIN_FACILITY_ALIAS_ID,
                        TARGET.FLOW_THRU_ALLOC_IN_PROG = SOURCE.FLOW_THRU_ALLOC_IN_PROG,
                        TARGET.LABEL_PRINT_REQD = SOURCE.LABEL_PRINT_REQD,
                        TARGET.VERIFIED_DTTM = SOURCE.VERIFIED_DTTM,
                        TARGET.SHIPPING_COST_CURRENCY_CODE = SOURCE.SHIPPING_COST_CURRENCY_CODE,
                        TARGET.BUSINESS_PARTNER_ID = SOURCE.BUSINESS_PARTNER_ID,
                        TARGET.PALLET_FOOTPRINT = SOURCE.PALLET_FOOTPRINT,
                        TARGET.BUYER_CODE = SOURCE.BUYER_CODE,
                        TARGET.CREATED_DTTM = SOURCE.CREATED_DTTM,
                        TARGET.SCHEDULE_APPT = SOURCE.SCHEDULE_APPT,
                        TARGET.SHIPPING_COST = SOURCE.SHIPPING_COST,
                        TARGET.RECEIVED_LPN_COUNT = SOURCE.RECEIVED_LPN_COUNT,
                        TARGET.ORIGIN_FACILITY_ID = SOURCE.ORIGIN_FACILITY_ID,
                        TARGET.CONTACT_ADDRESS_1 = SOURCE.CONTACT_ADDRESS_1,
                        TARGET.CONTACT_ADDRESS_2 = SOURCE.CONTACT_ADDRESS_2,
                        TARGET.DESTINATION_FACILITY_ALIAS_ID = SOURCE.DESTINATION_FACILITY_ALIAS_ID,
                        TARGET.CONTACT_ADDRESS_3 = SOURCE.CONTACT_ADDRESS_3,
                        TARGET.ASN_TYPE = SOURCE.ASN_TYPE,
                        TARGET.INITIATE_FLAG = SOURCE.INITIATE_FLAG,
                        TARGET.HAS_SOFT_CHECK_ERROR = SOURCE.HAS_SOFT_CHECK_ERROR,
                        TARGET.QTY_UOM_ID_BASE = SOURCE.QTY_UOM_ID_BASE,
                        TARGET.VERIFICATION_ATTEMPTED = SOURCE.VERIFICATION_ATTEMPTED,
                        TARGET.ASN_STATUS = SOURCE.ASN_STATUS,
                        TARGET.PRE_RECEIPT_STATUS = SOURCE.PRE_RECEIPT_STATUS,
                        TARGET.FIRM_APPT_IND = SOURCE.FIRM_APPT_IND,
                        TARGET.ACTUAL_SHIPPED_DTTM = SOURCE.ACTUAL_SHIPPED_DTTM,
                        TARGET.DELIVERY_START_DTTM = SOURCE.DELIVERY_START_DTTM,
                        TARGET.REF_FIELD_9 = SOURCE.REF_FIELD_9,
                        TARGET.ORIGINAL_ORDER_NUMBER = SOURCE.ORIGINAL_ORDER_NUMBER,
                        TARGET.IS_GIFT = SOURCE.IS_GIFT,
                        TARGET.FLOW_THROUGH_ALLOCATION_METHOD = SOURCE.FLOW_THROUGH_ALLOCATION_METHOD,
                        TARGET.REF_FIELD_1 = SOURCE.REF_FIELD_1,
                        TARGET.REF_FIELD_2 = SOURCE.REF_FIELD_2,
                        TARGET.REF_FIELD_3 = SOURCE.REF_FIELD_3,
                        TARGET.DRIVER_NAME = SOURCE.DRIVER_NAME,
                        TARGET.WORK_ORD_NBR = SOURCE.WORK_ORD_NBR,
                        TARGET.REF_FIELD_4 = SOURCE.REF_FIELD_4,
                        TARGET.PRO_NUMBER = SOURCE.PRO_NUMBER,
                        TARGET.REF_FIELD_5 = SOURCE.REF_FIELD_5,
                        TARGET.REF_FIELD_6 = SOURCE.REF_FIELD_6,
                        TARGET.REF_FIELD_7 = SOURCE.REF_FIELD_7,
                        TARGET.REF_FIELD_8 = SOURCE.REF_FIELD_8,
                        TARGET.TRAILER_CLOSED = SOURCE.TRAILER_CLOSED,
                        TARGET.RETURN_REFERENCE_NUMBER = SOURCE.RETURN_REFERENCE_NUMBER,
                        TARGET.LAST_UPDATED_SOURCE_TYPE = SOURCE.LAST_UPDATED_SOURCE_TYPE,
                        TARGET.ACTUAL_ARRIVAL_DTTM = SOURCE.ACTUAL_ARRIVAL_DTTM,
                        TARGET.CONTACT_ZIP = SOURCE.CONTACT_ZIP,
                        TARGET.CREATED_SOURCE = SOURCE.CREATED_SOURCE,
                        TARGET.CUT_NBR = SOURCE.CUT_NBR,
                        TARGET.QUALITY_CHECK_HOLD_UPON_RCPT = SOURCE.QUALITY_CHECK_HOLD_UPON_RCPT,
                        TARGET.LAST_UPDATED_DTTM = SOURCE.LAST_UPDATED_DTTM,
                        TARGET.EQUIPMENT_CODE = SOURCE.EQUIPMENT_CODE,
                        TARGET.QUALITY_AUDIT_PERCENT = SOURCE.QUALITY_AUDIT_PERCENT,
                        TARGET.MFG_PLNT = SOURCE.MFG_PLNT,
                        TARGET.APPOINTMENT_DURATION = SOURCE.APPOINTMENT_DURATION,
                        TARGET.IS_ASSOCIATED_TO_OUTBOUND = SOURCE.IS_ASSOCIATED_TO_OUTBOUND,
                        TARGET.DESTINATION_FACILITY_ID = SOURCE.DESTINATION_FACILITY_ID,
                        TARGET.ASN_SHPMT_TYPE = SOURCE.ASN_SHPMT_TYPE,
                        TARGET.APPOINTMENT_ID = SOURCE.APPOINTMENT_ID,
                        TARGET.ACTUAL_DEPARTURE_DTTM = SOURCE.ACTUAL_DEPARTURE_DTTM,
                        TARGET.IS_WHSE_TRANSFER = SOURCE.IS_WHSE_TRANSFER,
                        TARGET.TC_COMPANY_ID = SOURCE.TC_COMPANY_ID,
                        TARGET.TOTAL_RECEIVED_QTY = SOURCE.TOTAL_RECEIVED_QTY,
                        TARGET.DELIVERY_STOP_SEQ = SOURCE.DELIVERY_STOP_SEQ,
                        TARGET.FIRST_RECEIPT_DTTM = SOURCE.FIRST_RECEIPT_DTTM,
                        TARGET.RECEIPT_VARIANCE = SOURCE.RECEIPT_VARIANCE,
                        TARGET.REF_FIELD_10 = SOURCE.REF_FIELD_10,
                        TARGET.EQUIPMENT_CODE_ID = SOURCE.EQUIPMENT_CODE_ID,
                        TARGET.IS_CLOSED = SOURCE.IS_CLOSED,
                        TARGET.REGION_ID = SOURCE.REGION_ID,
                        TARGET.SHIPMENT_ID = SOURCE.SHIPMENT_ID,
                        TARGET.TOTAL_SHIPPED_QTY = SOURCE.TOTAL_SHIPPED_QTY,
                        TARGET.OUTBOUND_REGION_ID = SOURCE.OUTBOUND_REGION_ID,
                        TARGET.LAST_RECEIPT_DTTM = SOURCE.LAST_RECEIPT_DTTM,
                        TARGET.LAST_UPDATED_SOURCE = SOURCE.LAST_UPDATED_SOURCE,
                        TARGET.BILL_OF_LADING_NUMBER = SOURCE.BILL_OF_LADING_NUMBER,
                        TARGET.MISC_INSTR_CODE_2 = SOURCE.MISC_INSTR_CODE_2,
                        TARGET.INBOUND_REGION_NAME = SOURCE.INBOUND_REGION_NAME,
                        TARGET.MISC_INSTR_CODE_1 = SOURCE.MISC_INSTR_CODE_1,
                        TARGET.TRACTOR_CARRIER_CODE_ID = SOURCE.TRACTOR_CARRIER_CODE_ID,
                        TARGET.IS_CANCELLED = SOURCE.IS_CANCELLED,
                        TARGET.VOLUME_UOM_ID_BASE = SOURCE.VOLUME_UOM_ID_BASE,
                        TARGET.CONTACT_COUNTRY_CODE = SOURCE.CONTACT_COUNTRY_CODE,
                        TARGET.REF_NUM1 = SOURCE.REF_NUM1,
                        TARGET.REF_NUM3 = SOURCE.REF_NUM3,
                        TARGET.PICKUP_END_DTTM = SOURCE.PICKUP_END_DTTM,
                        TARGET.DELIVERY_END_DTTM = SOURCE.DELIVERY_END_DTTM,
                        TARGET.REF_NUM2 = SOURCE.REF_NUM2,
                        TARGET.TC_ASN_ID = SOURCE.TC_ASN_ID,
                        TARGET.MODE_ID = SOURCE.MODE_ID,
                        TARGET.REF_NUM5 = SOURCE.REF_NUM5,
                        TARGET.REF_NUM4 = SOURCE.REF_NUM4,
                        TARGET.RECEIPT_DTTM = SOURCE.RECEIPT_DTTM,
                        TARGET.IS_COGI_GENERATED = SOURCE.IS_COGI_GENERATED,
                        TARGET.EQUIPMENT_TYPE = SOURCE.EQUIPMENT_TYPE,
                        TARGET.CONTRAC_LOCN = SOURCE.CONTRAC_LOCN,
                        TARGET.VARIANCE_TYPE = SOURCE.VARIANCE_TYPE,
                        TARGET.INVOICE_NUMBER = SOURCE.INVOICE_NUMBER,
                        TARGET.TRACTOR_CARRIER_CODE = SOURCE.TRACTOR_CARRIER_CODE,
                        TARGET.INBOUND_REGION_ID = SOURCE.INBOUND_REGION_ID,
                        TARGET.HAS_IMPORT_ERROR = SOURCE.HAS_IMPORT_ERROR,
                        TARGET.TC_ASN_ID_U = SOURCE.TC_ASN_ID_U,
                        TARGET.TOTAL_WEIGHT = SOURCE.TOTAL_WEIGHT,
                        TARGET.EXT_CREATED_DTTM = SOURCE.EXT_CREATED_DTTM,
                        TARGET.ARCHIVE_DTTM = current_timestamp(),
                        TARGET.CONTACT_STATE_PROV = SOURCE.CONTACT_STATE_PROV,
                        TARGET.HAS_PHOTOS = SOURCE.HAS_PHOTOS,
                        TARGET._FIVETRAN_DELETED = SOURCE._FIVETRAN_DELETED,
                    	TARGET._FIVETRAN_SYNCED = SOURCE._FIVETRAN_SYNCED
                WHEN NOT MATCHED 
                    THEN
                        INSERT (
                        ASN_ID,
                    	SYSTEM_ALLOCATED,
                    	WEIGHT_UOM_ID_BASE,
                    	HAS_NOTES,
                    	ROUTE_ID,
                    	TC_SHIPMENT_ID,
                    	ASSIGNED_CARRIER_CODE_ID,
                    	INVOICE_DATE,
                    	ASN_PRIORITY,
                    	DESTINATION_TYPE,
                    	TRACTOR_NUMBER,
                    	RECEIPT_TYPE,
                    	HIBERNATE_VERSION,
                    	CONTACT_NUMBER,
                    	PRE_ALLOCATION_FIT_PERCENTAGE,
                    	REP_NAME,
                    	ASSIGNED_CARRIER_CODE,
                    	ALLOCATION_COMPLETED,
                    	LAST_TRANSMITTED_DTTM,
                    	MANIF_TYPE,
                    	APPOINTMENT_DTTM,
                    	ASN_LEVEL,
                    	CONTACT_COUNTY,
                    	MANIF_NBR,
                    	MHE_SENT,
                    	SHIPPED_LPN_COUNT,
                    	OUTBOUND_REGION_NAME,
                    	TRAILER_NUMBER,
                    	DC_ORD_NBR,
                    	TOTAL_VOLUME,
                    	HAS_ALERTS,
                    	CREATED_SOURCE_TYPE,
                    	FLOWTHROUGH_ALLOCATION_STATUS,
                    	ORIGINAL_ASN_ID,
                    	ASN_ORGN_TYPE,
                    	DOCK_DOOR_ID,
                    	CONTACT_CITY,
                    	ORIGIN_FACILITY_ALIAS_ID,
                    	FLOW_THRU_ALLOC_IN_PROG,
                    	LABEL_PRINT_REQD,
                    	VERIFIED_DTTM,
                    	SHIPPING_COST_CURRENCY_CODE,
                    	BUSINESS_PARTNER_ID,
                    	PALLET_FOOTPRINT,
                    	BUYER_CODE,
                    	CREATED_DTTM,
                    	SCHEDULE_APPT,
                    	SHIPPING_COST,
                    	RECEIVED_LPN_COUNT,
                    	ORIGIN_FACILITY_ID,
                    	CONTACT_ADDRESS_1,
                    	CONTACT_ADDRESS_2,
                    	DESTINATION_FACILITY_ALIAS_ID,
                    	CONTACT_ADDRESS_3,
                    	ASN_TYPE,
                    	INITIATE_FLAG,
                    	HAS_SOFT_CHECK_ERROR,
                    	QTY_UOM_ID_BASE,
                    	VERIFICATION_ATTEMPTED,
                    	ASN_STATUS,
                    	PRE_RECEIPT_STATUS,
                    	FIRM_APPT_IND,
                    	ACTUAL_SHIPPED_DTTM,
                    	DELIVERY_START_DTTM,
                    	REF_FIELD_9,
                    	ORIGINAL_ORDER_NUMBER,
                    	IS_GIFT,
                    	FLOW_THROUGH_ALLOCATION_METHOD,
                    	REF_FIELD_1,
                    	REF_FIELD_2,
                    	REF_FIELD_3,
                    	DRIVER_NAME,
                    	WORK_ORD_NBR,
                    	REF_FIELD_4,
                    	PRO_NUMBER,
                    	REF_FIELD_5,
                    	REF_FIELD_6,
                    	REF_FIELD_7,
                    	REF_FIELD_8,
                    	TRAILER_CLOSED,
                    	RETURN_REFERENCE_NUMBER,
                    	LAST_UPDATED_SOURCE_TYPE,
                    	ACTUAL_ARRIVAL_DTTM,
                    	CONTACT_ZIP,
                    	CREATED_SOURCE,
                    	CUT_NBR,
                    	QUALITY_CHECK_HOLD_UPON_RCPT,
                    	LAST_UPDATED_DTTM,
                    	EQUIPMENT_CODE,
                    	QUALITY_AUDIT_PERCENT,
                    	MFG_PLNT,
                    	APPOINTMENT_DURATION,
                    	IS_ASSOCIATED_TO_OUTBOUND,
                    	DESTINATION_FACILITY_ID,
                    	ASN_SHPMT_TYPE,
                    	APPOINTMENT_ID,
                    	ACTUAL_DEPARTURE_DTTM,
                    	IS_WHSE_TRANSFER,
                    	TC_COMPANY_ID,
                    	TOTAL_RECEIVED_QTY,
                    	DELIVERY_STOP_SEQ,
                    	FIRST_RECEIPT_DTTM,
                    	RECEIPT_VARIANCE,
                    	REF_FIELD_10,
                    	EQUIPMENT_CODE_ID,
                    	IS_CLOSED,
                    	REGION_ID,
                    	SHIPMENT_ID,
                    	TOTAL_SHIPPED_QTY,
                    	OUTBOUND_REGION_ID,
                    	LAST_RECEIPT_DTTM,
                    	LAST_UPDATED_SOURCE,
                    	BILL_OF_LADING_NUMBER,
                    	MISC_INSTR_CODE_2,
                    	INBOUND_REGION_NAME,
                    	MISC_INSTR_CODE_1,
                    	TRACTOR_CARRIER_CODE_ID,
                    	IS_CANCELLED,
                    	VOLUME_UOM_ID_BASE,
                    	CONTACT_COUNTRY_CODE,
                    	REF_NUM1,
                    	REF_NUM3,
                    	PICKUP_END_DTTM,
                    	DELIVERY_END_DTTM,
                    	REF_NUM2,
                    	TC_ASN_ID,
                    	MODE_ID,
                    	REF_NUM5,
                    	REF_NUM4,
                    	RECEIPT_DTTM,
                    	IS_COGI_GENERATED,
                    	EQUIPMENT_TYPE,
                    	CONTRAC_LOCN,
                    	VARIANCE_TYPE,
                    	INVOICE_NUMBER,
                    	TRACTOR_CARRIER_CODE,
                    	INBOUND_REGION_ID,
                    	HAS_IMPORT_ERROR,
                    	TC_ASN_ID_U,
                    	TOTAL_WEIGHT,
                    	EXT_CREATED_DTTM,
                    	ARCHIVE_DTTM,
                    	CONTACT_STATE_PROV,
                    	HAS_PHOTOS,
                    	_FIVETRAN_DELETED,
                    	_FIVETRAN_SYNCED
                        )
                        VALUES (
                        SOURCE.ASN_ID,
                        SOURCE.SYSTEM_ALLOCATED,
                        SOURCE.WEIGHT_UOM_ID_BASE,
                        SOURCE.HAS_NOTES,
                        SOURCE.ROUTE_ID,
                        SOURCE.TC_SHIPMENT_ID,
                        SOURCE.ASSIGNED_CARRIER_CODE_ID,
                        SOURCE.INVOICE_DATE,
                        SOURCE.ASN_PRIORITY,
                        SOURCE.DESTINATION_TYPE,
                        SOURCE.TRACTOR_NUMBER,
                        SOURCE.RECEIPT_TYPE,
                        SOURCE.HIBERNATE_VERSION,
                        SOURCE.CONTACT_NUMBER,
                        SOURCE.PRE_ALLOCATION_FIT_PERCENTAGE,
                        SOURCE.REP_NAME,
                        SOURCE.ASSIGNED_CARRIER_CODE,
                        SOURCE.ALLOCATION_COMPLETED,
                        SOURCE.LAST_TRANSMITTED_DTTM,
                        SOURCE.MANIF_TYPE,
                        SOURCE.APPOINTMENT_DTTM,
                        SOURCE.ASN_LEVEL,
                        SOURCE.CONTACT_COUNTY,
                        SOURCE.MANIF_NBR,
                        SOURCE.MHE_SENT,
                        SOURCE.SHIPPED_LPN_COUNT,
                        SOURCE.OUTBOUND_REGION_NAME,
                        SOURCE.TRAILER_NUMBER,
                        SOURCE.DC_ORD_NBR,
                        SOURCE.TOTAL_VOLUME,
                        SOURCE.HAS_ALERTS,
                        SOURCE.CREATED_SOURCE_TYPE,
                        SOURCE.FLOWTHROUGH_ALLOCATION_STATUS,
                        SOURCE.ORIGINAL_ASN_ID,
                        SOURCE.ASN_ORGN_TYPE,
                        SOURCE.DOCK_DOOR_ID,
                        SOURCE.CONTACT_CITY,
                        SOURCE.ORIGIN_FACILITY_ALIAS_ID,
                        SOURCE.FLOW_THRU_ALLOC_IN_PROG,
                        SOURCE.LABEL_PRINT_REQD,
                        SOURCE.VERIFIED_DTTM,
                        SOURCE.SHIPPING_COST_CURRENCY_CODE,
                        SOURCE.BUSINESS_PARTNER_ID,
                        SOURCE.PALLET_FOOTPRINT,
                        SOURCE.BUYER_CODE,
                        SOURCE.CREATED_DTTM,
                        SOURCE.SCHEDULE_APPT,
                        SOURCE.SHIPPING_COST,
                        SOURCE.RECEIVED_LPN_COUNT,
                        SOURCE.ORIGIN_FACILITY_ID,
                        SOURCE.CONTACT_ADDRESS_1,
                        SOURCE.CONTACT_ADDRESS_2,
                        SOURCE.DESTINATION_FACILITY_ALIAS_ID,
                        SOURCE.CONTACT_ADDRESS_3,
                        SOURCE.ASN_TYPE,
                        SOURCE.INITIATE_FLAG,
                        SOURCE.HAS_SOFT_CHECK_ERROR,
                        SOURCE.QTY_UOM_ID_BASE,
                        SOURCE.VERIFICATION_ATTEMPTED,
                        SOURCE.ASN_STATUS,
                        SOURCE.PRE_RECEIPT_STATUS,
                        SOURCE.FIRM_APPT_IND,
                        SOURCE.ACTUAL_SHIPPED_DTTM,
                        SOURCE.DELIVERY_START_DTTM,
                        SOURCE.REF_FIELD_9,
                        SOURCE.ORIGINAL_ORDER_NUMBER,
                        SOURCE.IS_GIFT,
                        SOURCE.FLOW_THROUGH_ALLOCATION_METHOD,
                        SOURCE.REF_FIELD_1,
                        SOURCE.REF_FIELD_2,
                        SOURCE.REF_FIELD_3,
                        SOURCE.DRIVER_NAME,
                        SOURCE.WORK_ORD_NBR,
                        SOURCE.REF_FIELD_4,
                        SOURCE.PRO_NUMBER,
                        SOURCE.REF_FIELD_5,
                        SOURCE.REF_FIELD_6,
                        SOURCE.REF_FIELD_7,
                        SOURCE.REF_FIELD_8,
                        SOURCE.TRAILER_CLOSED,
                        SOURCE.RETURN_REFERENCE_NUMBER,
                        SOURCE.LAST_UPDATED_SOURCE_TYPE,
                        SOURCE.ACTUAL_ARRIVAL_DTTM,
                        SOURCE.CONTACT_ZIP,
                        SOURCE.CREATED_SOURCE,
                        SOURCE.CUT_NBR,
                        SOURCE.QUALITY_CHECK_HOLD_UPON_RCPT,
                        SOURCE.LAST_UPDATED_DTTM,
                        SOURCE.EQUIPMENT_CODE,
                        SOURCE.QUALITY_AUDIT_PERCENT,
                        SOURCE.MFG_PLNT,
                        SOURCE.APPOINTMENT_DURATION,
                        SOURCE.IS_ASSOCIATED_TO_OUTBOUND,
                        SOURCE.DESTINATION_FACILITY_ID,
                        SOURCE.ASN_SHPMT_TYPE,
                        SOURCE.APPOINTMENT_ID,
                        SOURCE.ACTUAL_DEPARTURE_DTTM,
                        SOURCE.IS_WHSE_TRANSFER,
                        SOURCE.TC_COMPANY_ID,
                        SOURCE.TOTAL_RECEIVED_QTY,
                        SOURCE.DELIVERY_STOP_SEQ,
                        SOURCE.FIRST_RECEIPT_DTTM,
                        SOURCE.RECEIPT_VARIANCE,
                        SOURCE.REF_FIELD_10,
                        SOURCE.EQUIPMENT_CODE_ID,
                        SOURCE.IS_CLOSED,
                        SOURCE.REGION_ID,
                        SOURCE.SHIPMENT_ID,
                        SOURCE.TOTAL_SHIPPED_QTY,
                        SOURCE.OUTBOUND_REGION_ID,
                        SOURCE.LAST_RECEIPT_DTTM,
                        SOURCE.LAST_UPDATED_SOURCE,
                        SOURCE.BILL_OF_LADING_NUMBER,
                        SOURCE.MISC_INSTR_CODE_2,
                        SOURCE.INBOUND_REGION_NAME,
                        SOURCE.MISC_INSTR_CODE_1,
                        SOURCE.TRACTOR_CARRIER_CODE_ID,
                        SOURCE.IS_CANCELLED,
                        SOURCE.VOLUME_UOM_ID_BASE,
                        SOURCE.CONTACT_COUNTRY_CODE,
                        SOURCE.REF_NUM1,
                        SOURCE.REF_NUM3,
                        SOURCE.PICKUP_END_DTTM,
                        SOURCE.DELIVERY_END_DTTM,
                        SOURCE.REF_NUM2,
                        SOURCE.TC_ASN_ID,
                        SOURCE.MODE_ID,
                        SOURCE.REF_NUM5,
                        SOURCE.REF_NUM4,
                        SOURCE.RECEIPT_DTTM,
                        SOURCE.IS_COGI_GENERATED,
                        SOURCE.EQUIPMENT_TYPE,
                        SOURCE.CONTRAC_LOCN,
                        SOURCE.VARIANCE_TYPE,
                        SOURCE.INVOICE_NUMBER,
                        SOURCE.TRACTOR_CARRIER_CODE,
                        SOURCE.INBOUND_REGION_ID,
                        SOURCE.HAS_IMPORT_ERROR,
                        SOURCE.TC_ASN_ID_U,
                        SOURCE.TOTAL_WEIGHT,
                        SOURCE.EXT_CREATED_DTTM,
                        current_timestamp(),
                        SOURCE.CONTACT_STATE_PROV,
                        SOURCE.HAS_PHOTOS,
                        SOURCE._FIVETRAN_DELETED,
                        SOURCE._FIVETRAN_SYNCED
                        );
                RETURN ('SUCCESS');
        END;
    
---------------- SP_ASN SILVER

CALL ETL.SILVER_ARCH.SP_UPDATE_ETL_ASN_SILVER();

CREATE OR REPLACE PROCEDURE ETL.SILVER_ARCH.SP_UPDATE_ETL_ASN_SILVER()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER 
   AS
        BEGIN 
            MERGE INTO ETL.SILVER_ARCH.ASN AS TARGET
            USING
            (
                SELECT *, current_timestamp() AS ARCHIVE_DTTM
                FROM XBPRDWMSILVER.PRD_SILVER_GB_XBDBTJ3WM.ASN
                WHERE ASN.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())
            ) AS SOURCE

            ON TARGET.ASN_ID = SOURCE.ASN_ID
                WHEN MATCHED AND TARGET.LAST_UPDATED_DTTM < SOURCE.LAST_UPDATED_DTTM 
                    THEN UPDATE SET
                        TARGET.ASN_ID = SOURCE.ASN_ID,
                        TARGET.SYSTEM_ALLOCATED = SOURCE.SYSTEM_ALLOCATED,
                        TARGET.WEIGHT_UOM_ID_BASE = SOURCE.WEIGHT_UOM_ID_BASE,
                        TARGET.HAS_NOTES = SOURCE.HAS_NOTES,
                        TARGET.ROUTE_ID = SOURCE.ROUTE_ID,
                        TARGET.TC_SHIPMENT_ID = SOURCE.TC_SHIPMENT_ID,
                        TARGET.ASSIGNED_CARRIER_CODE_ID = SOURCE.ASSIGNED_CARRIER_CODE_ID,
                        TARGET.INVOICE_DATE = SOURCE.INVOICE_DATE,
                        TARGET.ASN_PRIORITY = SOURCE.ASN_PRIORITY,
                        TARGET.DESTINATION_TYPE = SOURCE.DESTINATION_TYPE,
                        TARGET.TRACTOR_NUMBER = SOURCE.TRACTOR_NUMBER,
                        TARGET.RECEIPT_TYPE = SOURCE.RECEIPT_TYPE,
                        TARGET.HIBERNATE_VERSION = SOURCE.HIBERNATE_VERSION,
                        TARGET.CONTACT_NUMBER = SOURCE.CONTACT_NUMBER,
                        TARGET.PRE_ALLOCATION_FIT_PERCENTAGE = SOURCE.PRE_ALLOCATION_FIT_PERCENTAGE,
                        TARGET.REP_NAME = SOURCE.REP_NAME,
                        TARGET.ASSIGNED_CARRIER_CODE = SOURCE.ASSIGNED_CARRIER_CODE,
                        TARGET.ALLOCATION_COMPLETED = SOURCE.ALLOCATION_COMPLETED,
                        TARGET.LAST_TRANSMITTED_DTTM = SOURCE.LAST_TRANSMITTED_DTTM,
                        TARGET.MANIF_TYPE = SOURCE.MANIF_TYPE,
                        TARGET.APPOINTMENT_DTTM = SOURCE.APPOINTMENT_DTTM,
                        TARGET.ASN_LEVEL = SOURCE.ASN_LEVEL,
                        TARGET.CONTACT_COUNTY = SOURCE.CONTACT_COUNTY,
                        TARGET.MANIF_NBR = SOURCE.MANIF_NBR,
                        TARGET.MHE_SENT = SOURCE.MHE_SENT,
                        TARGET.SHIPPED_LPN_COUNT = SOURCE.SHIPPED_LPN_COUNT,
                        TARGET.OUTBOUND_REGION_NAME = SOURCE.OUTBOUND_REGION_NAME,
                        TARGET.TRAILER_NUMBER = SOURCE.TRAILER_NUMBER,
                        TARGET.DC_ORD_NBR = SOURCE.DC_ORD_NBR,
                        TARGET.TOTAL_VOLUME = SOURCE.TOTAL_VOLUME,
                        TARGET.HAS_ALERTS = SOURCE.HAS_ALERTS,
                        TARGET.CREATED_SOURCE_TYPE = SOURCE.CREATED_SOURCE_TYPE,
                        TARGET.FLOWTHROUGH_ALLOCATION_STATUS = SOURCE.FLOWTHROUGH_ALLOCATION_STATUS,
                        TARGET.ORIGINAL_ASN_ID = SOURCE.ORIGINAL_ASN_ID,
                        TARGET.ASN_ORGN_TYPE = SOURCE.ASN_ORGN_TYPE,
                        TARGET.DOCK_DOOR_ID = SOURCE.DOCK_DOOR_ID,
                        TARGET.CONTACT_CITY = SOURCE.CONTACT_CITY,
                        TARGET.ORIGIN_FACILITY_ALIAS_ID = SOURCE.ORIGIN_FACILITY_ALIAS_ID,
                        TARGET.FLOW_THRU_ALLOC_IN_PROG = SOURCE.FLOW_THRU_ALLOC_IN_PROG,
                        TARGET.LABEL_PRINT_REQD = SOURCE.LABEL_PRINT_REQD,
                        TARGET.VERIFIED_DTTM = SOURCE.VERIFIED_DTTM,
                        TARGET.SHIPPING_COST_CURRENCY_CODE = SOURCE.SHIPPING_COST_CURRENCY_CODE,
                        TARGET.BUSINESS_PARTNER_ID = SOURCE.BUSINESS_PARTNER_ID,
                        TARGET.PALLET_FOOTPRINT = SOURCE.PALLET_FOOTPRINT,
                        TARGET.BUYER_CODE = SOURCE.BUYER_CODE,
                        TARGET.CREATED_DTTM = SOURCE.CREATED_DTTM,
                        TARGET.SCHEDULE_APPT = SOURCE.SCHEDULE_APPT,
                        TARGET.SHIPPING_COST = SOURCE.SHIPPING_COST,
                        TARGET.RECEIVED_LPN_COUNT = SOURCE.RECEIVED_LPN_COUNT,
                        TARGET.ORIGIN_FACILITY_ID = SOURCE.ORIGIN_FACILITY_ID,
                        TARGET.CONTACT_ADDRESS_1 = SOURCE.CONTACT_ADDRESS_1,
                        TARGET.CONTACT_ADDRESS_2 = SOURCE.CONTACT_ADDRESS_2,
                        TARGET.DESTINATION_FACILITY_ALIAS_ID = SOURCE.DESTINATION_FACILITY_ALIAS_ID,
                        TARGET.CONTACT_ADDRESS_3 = SOURCE.CONTACT_ADDRESS_3,
                        TARGET.ASN_TYPE = SOURCE.ASN_TYPE,
                        TARGET.INITIATE_FLAG = SOURCE.INITIATE_FLAG,
                        TARGET.HAS_SOFT_CHECK_ERROR = SOURCE.HAS_SOFT_CHECK_ERROR,
                        TARGET.QTY_UOM_ID_BASE = SOURCE.QTY_UOM_ID_BASE,
                        TARGET.VERIFICATION_ATTEMPTED = SOURCE.VERIFICATION_ATTEMPTED,
                        TARGET.ASN_STATUS = SOURCE.ASN_STATUS,
                        TARGET.PRE_RECEIPT_STATUS = SOURCE.PRE_RECEIPT_STATUS,
                        TARGET.FIRM_APPT_IND = SOURCE.FIRM_APPT_IND,
                        TARGET.ACTUAL_SHIPPED_DTTM = SOURCE.ACTUAL_SHIPPED_DTTM,
                        TARGET.DELIVERY_START_DTTM = SOURCE.DELIVERY_START_DTTM,
                        TARGET.REF_FIELD_9 = SOURCE.REF_FIELD_9,
                        TARGET.ORIGINAL_ORDER_NUMBER = SOURCE.ORIGINAL_ORDER_NUMBER,
                        TARGET.IS_GIFT = SOURCE.IS_GIFT,
                        TARGET.FLOW_THROUGH_ALLOCATION_METHOD = SOURCE.FLOW_THROUGH_ALLOCATION_METHOD,
                        TARGET.REF_FIELD_1 = SOURCE.REF_FIELD_1,
                        TARGET.REF_FIELD_2 = SOURCE.REF_FIELD_2,
                        TARGET.REF_FIELD_3 = SOURCE.REF_FIELD_3,
                        TARGET.DRIVER_NAME = SOURCE.DRIVER_NAME,
                        TARGET.WORK_ORD_NBR = SOURCE.WORK_ORD_NBR,
                        TARGET.REF_FIELD_4 = SOURCE.REF_FIELD_4,
                        TARGET.PRO_NUMBER = SOURCE.PRO_NUMBER,
                        TARGET.REF_FIELD_5 = SOURCE.REF_FIELD_5,
                        TARGET.REF_FIELD_6 = SOURCE.REF_FIELD_6,
                        TARGET.REF_FIELD_7 = SOURCE.REF_FIELD_7,
                        TARGET.REF_FIELD_8 = SOURCE.REF_FIELD_8,
                        TARGET.TRAILER_CLOSED = SOURCE.TRAILER_CLOSED,
                        TARGET.RETURN_REFERENCE_NUMBER = SOURCE.RETURN_REFERENCE_NUMBER,
                        TARGET.LAST_UPDATED_SOURCE_TYPE = SOURCE.LAST_UPDATED_SOURCE_TYPE,
                        TARGET.ACTUAL_ARRIVAL_DTTM = SOURCE.ACTUAL_ARRIVAL_DTTM,
                        TARGET.CONTACT_ZIP = SOURCE.CONTACT_ZIP,
                        TARGET.CREATED_SOURCE = SOURCE.CREATED_SOURCE,
                        TARGET.CUT_NBR = SOURCE.CUT_NBR,
                        TARGET.QUALITY_CHECK_HOLD_UPON_RCPT = SOURCE.QUALITY_CHECK_HOLD_UPON_RCPT,
                        TARGET.LAST_UPDATED_DTTM = SOURCE.LAST_UPDATED_DTTM,
                        TARGET.EQUIPMENT_CODE = SOURCE.EQUIPMENT_CODE,
                        TARGET.QUALITY_AUDIT_PERCENT = SOURCE.QUALITY_AUDIT_PERCENT,
                        TARGET.MFG_PLNT = SOURCE.MFG_PLNT,
                        TARGET.APPOINTMENT_DURATION = SOURCE.APPOINTMENT_DURATION,
                        TARGET.IS_ASSOCIATED_TO_OUTBOUND = SOURCE.IS_ASSOCIATED_TO_OUTBOUND,
                        TARGET.DESTINATION_FACILITY_ID = SOURCE.DESTINATION_FACILITY_ID,
                        TARGET.ASN_SHPMT_TYPE = SOURCE.ASN_SHPMT_TYPE,
                        TARGET.APPOINTMENT_ID = SOURCE.APPOINTMENT_ID,
                        TARGET.ACTUAL_DEPARTURE_DTTM = SOURCE.ACTUAL_DEPARTURE_DTTM,
                        TARGET.IS_WHSE_TRANSFER = SOURCE.IS_WHSE_TRANSFER,
                        TARGET.TC_COMPANY_ID = SOURCE.TC_COMPANY_ID,
                        TARGET.TOTAL_RECEIVED_QTY = SOURCE.TOTAL_RECEIVED_QTY,
                        TARGET.DELIVERY_STOP_SEQ = SOURCE.DELIVERY_STOP_SEQ,
                        TARGET.FIRST_RECEIPT_DTTM = SOURCE.FIRST_RECEIPT_DTTM,
                        TARGET.RECEIPT_VARIANCE = SOURCE.RECEIPT_VARIANCE,
                        TARGET.REF_FIELD_10 = SOURCE.REF_FIELD_10,
                        TARGET.EQUIPMENT_CODE_ID = SOURCE.EQUIPMENT_CODE_ID,
                        TARGET.IS_CLOSED = SOURCE.IS_CLOSED,
                        TARGET.REGION_ID = SOURCE.REGION_ID,
                        TARGET.SHIPMENT_ID = SOURCE.SHIPMENT_ID,
                        TARGET.TOTAL_SHIPPED_QTY = SOURCE.TOTAL_SHIPPED_QTY,
                        TARGET.OUTBOUND_REGION_ID = SOURCE.OUTBOUND_REGION_ID,
                        TARGET.LAST_RECEIPT_DTTM = SOURCE.LAST_RECEIPT_DTTM,
                        TARGET.LAST_UPDATED_SOURCE = SOURCE.LAST_UPDATED_SOURCE,
                        TARGET.BILL_OF_LADING_NUMBER = SOURCE.BILL_OF_LADING_NUMBER,
                        TARGET.MISC_INSTR_CODE_2 = SOURCE.MISC_INSTR_CODE_2,
                        TARGET.INBOUND_REGION_NAME = SOURCE.INBOUND_REGION_NAME,
                        TARGET.MISC_INSTR_CODE_1 = SOURCE.MISC_INSTR_CODE_1,
                        TARGET.TRACTOR_CARRIER_CODE_ID = SOURCE.TRACTOR_CARRIER_CODE_ID,
                        TARGET.IS_CANCELLED = SOURCE.IS_CANCELLED,
                        TARGET.VOLUME_UOM_ID_BASE = SOURCE.VOLUME_UOM_ID_BASE,
                        TARGET.CONTACT_COUNTRY_CODE = SOURCE.CONTACT_COUNTRY_CODE,
                        TARGET.REF_NUM1 = SOURCE.REF_NUM1,
                        TARGET.REF_NUM3 = SOURCE.REF_NUM3,
                        TARGET.PICKUP_END_DTTM = SOURCE.PICKUP_END_DTTM,
                        TARGET.DELIVERY_END_DTTM = SOURCE.DELIVERY_END_DTTM,
                        TARGET.REF_NUM2 = SOURCE.REF_NUM2,
                        TARGET.TC_ASN_ID = SOURCE.TC_ASN_ID,
                        TARGET.MODE_ID = SOURCE.MODE_ID,
                        TARGET.REF_NUM5 = SOURCE.REF_NUM5,
                        TARGET.REF_NUM4 = SOURCE.REF_NUM4,
                        TARGET.RECEIPT_DTTM = SOURCE.RECEIPT_DTTM,
                        TARGET.IS_COGI_GENERATED = SOURCE.IS_COGI_GENERATED,
                        TARGET.EQUIPMENT_TYPE = SOURCE.EQUIPMENT_TYPE,
                        TARGET.CONTRAC_LOCN = SOURCE.CONTRAC_LOCN,
                        TARGET.VARIANCE_TYPE = SOURCE.VARIANCE_TYPE,
                        TARGET.INVOICE_NUMBER = SOURCE.INVOICE_NUMBER,
                        TARGET.TRACTOR_CARRIER_CODE = SOURCE.TRACTOR_CARRIER_CODE,
                        TARGET.INBOUND_REGION_ID = SOURCE.INBOUND_REGION_ID,
                        TARGET.HAS_IMPORT_ERROR = SOURCE.HAS_IMPORT_ERROR,
                        TARGET.TC_ASN_ID_U = SOURCE.TC_ASN_ID_U,
                        TARGET.TOTAL_WEIGHT = SOURCE.TOTAL_WEIGHT,
                        TARGET.EXT_CREATED_DTTM = SOURCE.EXT_CREATED_DTTM,
                        TARGET.ARCHIVE_DTTM = current_timestamp(),
                        TARGET.CONTACT_STATE_PROV = SOURCE.CONTACT_STATE_PROV,
                        TARGET.HAS_PHOTOS = SOURCE.HAS_PHOTOS,
                        TARGET._FIVETRAN_DELETED = SOURCE._FIVETRAN_DELETED,
                    	TARGET._FIVETRAN_SYNCED = SOURCE._FIVETRAN_SYNCED
                WHEN NOT MATCHED 
                    THEN
                        INSERT (
                        ASN_ID,
                    	SYSTEM_ALLOCATED,
                    	WEIGHT_UOM_ID_BASE,
                    	HAS_NOTES,
                    	ROUTE_ID,
                    	TC_SHIPMENT_ID,
                    	ASSIGNED_CARRIER_CODE_ID,
                    	INVOICE_DATE,
                    	ASN_PRIORITY,
                    	DESTINATION_TYPE,
                    	TRACTOR_NUMBER,
                    	RECEIPT_TYPE,
                    	HIBERNATE_VERSION,
                    	CONTACT_NUMBER,
                    	PRE_ALLOCATION_FIT_PERCENTAGE,
                    	REP_NAME,
                    	ASSIGNED_CARRIER_CODE,
                    	ALLOCATION_COMPLETED,
                    	LAST_TRANSMITTED_DTTM,
                    	MANIF_TYPE,
                    	APPOINTMENT_DTTM,
                    	ASN_LEVEL,
                    	CONTACT_COUNTY,
                    	MANIF_NBR,
                    	MHE_SENT,
                    	SHIPPED_LPN_COUNT,
                    	OUTBOUND_REGION_NAME,
                    	TRAILER_NUMBER,
                    	DC_ORD_NBR,
                    	TOTAL_VOLUME,
                    	HAS_ALERTS,
                    	CREATED_SOURCE_TYPE,
                    	FLOWTHROUGH_ALLOCATION_STATUS,
                    	ORIGINAL_ASN_ID,
                    	ASN_ORGN_TYPE,
                    	DOCK_DOOR_ID,
                    	CONTACT_CITY,
                    	ORIGIN_FACILITY_ALIAS_ID,
                    	FLOW_THRU_ALLOC_IN_PROG,
                    	LABEL_PRINT_REQD,
                    	VERIFIED_DTTM,
                    	SHIPPING_COST_CURRENCY_CODE,
                    	BUSINESS_PARTNER_ID,
                    	PALLET_FOOTPRINT,
                    	BUYER_CODE,
                    	CREATED_DTTM,
                    	SCHEDULE_APPT,
                    	SHIPPING_COST,
                    	RECEIVED_LPN_COUNT,
                    	ORIGIN_FACILITY_ID,
                    	CONTACT_ADDRESS_1,
                    	CONTACT_ADDRESS_2,
                    	DESTINATION_FACILITY_ALIAS_ID,
                    	CONTACT_ADDRESS_3,
                    	ASN_TYPE,
                    	INITIATE_FLAG,
                    	HAS_SOFT_CHECK_ERROR,
                    	QTY_UOM_ID_BASE,
                    	VERIFICATION_ATTEMPTED,
                    	ASN_STATUS,
                    	PRE_RECEIPT_STATUS,
                    	FIRM_APPT_IND,
                    	ACTUAL_SHIPPED_DTTM,
                    	DELIVERY_START_DTTM,
                    	REF_FIELD_9,
                    	ORIGINAL_ORDER_NUMBER,
                    	IS_GIFT,
                    	FLOW_THROUGH_ALLOCATION_METHOD,
                    	REF_FIELD_1,
                    	REF_FIELD_2,
                    	REF_FIELD_3,
                    	DRIVER_NAME,
                    	WORK_ORD_NBR,
                    	REF_FIELD_4,
                    	PRO_NUMBER,
                    	REF_FIELD_5,
                    	REF_FIELD_6,
                    	REF_FIELD_7,
                    	REF_FIELD_8,
                    	TRAILER_CLOSED,
                    	RETURN_REFERENCE_NUMBER,
                    	LAST_UPDATED_SOURCE_TYPE,
                    	ACTUAL_ARRIVAL_DTTM,
                    	CONTACT_ZIP,
                    	CREATED_SOURCE,
                    	CUT_NBR,
                    	QUALITY_CHECK_HOLD_UPON_RCPT,
                    	LAST_UPDATED_DTTM,
                    	EQUIPMENT_CODE,
                    	QUALITY_AUDIT_PERCENT,
                    	MFG_PLNT,
                    	APPOINTMENT_DURATION,
                    	IS_ASSOCIATED_TO_OUTBOUND,
                    	DESTINATION_FACILITY_ID,
                    	ASN_SHPMT_TYPE,
                    	APPOINTMENT_ID,
                    	ACTUAL_DEPARTURE_DTTM,
                    	IS_WHSE_TRANSFER,
                    	TC_COMPANY_ID,
                    	TOTAL_RECEIVED_QTY,
                    	DELIVERY_STOP_SEQ,
                    	FIRST_RECEIPT_DTTM,
                    	RECEIPT_VARIANCE,
                    	REF_FIELD_10,
                    	EQUIPMENT_CODE_ID,
                    	IS_CLOSED,
                    	REGION_ID,
                    	SHIPMENT_ID,
                    	TOTAL_SHIPPED_QTY,
                    	OUTBOUND_REGION_ID,
                    	LAST_RECEIPT_DTTM,
                    	LAST_UPDATED_SOURCE,
                    	BILL_OF_LADING_NUMBER,
                    	MISC_INSTR_CODE_2,
                    	INBOUND_REGION_NAME,
                    	MISC_INSTR_CODE_1,
                    	TRACTOR_CARRIER_CODE_ID,
                    	IS_CANCELLED,
                    	VOLUME_UOM_ID_BASE,
                    	CONTACT_COUNTRY_CODE,
                    	REF_NUM1,
                    	REF_NUM3,
                    	PICKUP_END_DTTM,
                    	DELIVERY_END_DTTM,
                    	REF_NUM2,
                    	TC_ASN_ID,
                    	MODE_ID,
                    	REF_NUM5,
                    	REF_NUM4,
                    	RECEIPT_DTTM,
                    	IS_COGI_GENERATED,
                    	EQUIPMENT_TYPE,
                    	CONTRAC_LOCN,
                    	VARIANCE_TYPE,
                    	INVOICE_NUMBER,
                    	TRACTOR_CARRIER_CODE,
                    	INBOUND_REGION_ID,
                    	HAS_IMPORT_ERROR,
                    	TC_ASN_ID_U,
                    	TOTAL_WEIGHT,
                    	EXT_CREATED_DTTM,
                    	ARCHIVE_DTTM,
                    	CONTACT_STATE_PROV,
                    	HAS_PHOTOS,
                    	_FIVETRAN_DELETED,
                    	_FIVETRAN_SYNCED
                        )
                        VALUES (
                        SOURCE.ASN_ID,
                        SOURCE.SYSTEM_ALLOCATED,
                        SOURCE.WEIGHT_UOM_ID_BASE,
                        SOURCE.HAS_NOTES,
                        SOURCE.ROUTE_ID,
                        SOURCE.TC_SHIPMENT_ID,
                        SOURCE.ASSIGNED_CARRIER_CODE_ID,
                        SOURCE.INVOICE_DATE,
                        SOURCE.ASN_PRIORITY,
                        SOURCE.DESTINATION_TYPE,
                        SOURCE.TRACTOR_NUMBER,
                        SOURCE.RECEIPT_TYPE,
                        SOURCE.HIBERNATE_VERSION,
                        SOURCE.CONTACT_NUMBER,
                        SOURCE.PRE_ALLOCATION_FIT_PERCENTAGE,
                        SOURCE.REP_NAME,
                        SOURCE.ASSIGNED_CARRIER_CODE,
                        SOURCE.ALLOCATION_COMPLETED,
                        SOURCE.LAST_TRANSMITTED_DTTM,
                        SOURCE.MANIF_TYPE,
                        SOURCE.APPOINTMENT_DTTM,
                        SOURCE.ASN_LEVEL,
                        SOURCE.CONTACT_COUNTY,
                        SOURCE.MANIF_NBR,
                        SOURCE.MHE_SENT,
                        SOURCE.SHIPPED_LPN_COUNT,
                        SOURCE.OUTBOUND_REGION_NAME,
                        SOURCE.TRAILER_NUMBER,
                        SOURCE.DC_ORD_NBR,
                        SOURCE.TOTAL_VOLUME,
                        SOURCE.HAS_ALERTS,
                        SOURCE.CREATED_SOURCE_TYPE,
                        SOURCE.FLOWTHROUGH_ALLOCATION_STATUS,
                        SOURCE.ORIGINAL_ASN_ID,
                        SOURCE.ASN_ORGN_TYPE,
                        SOURCE.DOCK_DOOR_ID,
                        SOURCE.CONTACT_CITY,
                        SOURCE.ORIGIN_FACILITY_ALIAS_ID,
                        SOURCE.FLOW_THRU_ALLOC_IN_PROG,
                        SOURCE.LABEL_PRINT_REQD,
                        SOURCE.VERIFIED_DTTM,
                        SOURCE.SHIPPING_COST_CURRENCY_CODE,
                        SOURCE.BUSINESS_PARTNER_ID,
                        SOURCE.PALLET_FOOTPRINT,
                        SOURCE.BUYER_CODE,
                        SOURCE.CREATED_DTTM,
                        SOURCE.SCHEDULE_APPT,
                        SOURCE.SHIPPING_COST,
                        SOURCE.RECEIVED_LPN_COUNT,
                        SOURCE.ORIGIN_FACILITY_ID,
                        SOURCE.CONTACT_ADDRESS_1,
                        SOURCE.CONTACT_ADDRESS_2,
                        SOURCE.DESTINATION_FACILITY_ALIAS_ID,
                        SOURCE.CONTACT_ADDRESS_3,
                        SOURCE.ASN_TYPE,
                        SOURCE.INITIATE_FLAG,
                        SOURCE.HAS_SOFT_CHECK_ERROR,
                        SOURCE.QTY_UOM_ID_BASE,
                        SOURCE.VERIFICATION_ATTEMPTED,
                        SOURCE.ASN_STATUS,
                        SOURCE.PRE_RECEIPT_STATUS,
                        SOURCE.FIRM_APPT_IND,
                        SOURCE.ACTUAL_SHIPPED_DTTM,
                        SOURCE.DELIVERY_START_DTTM,
                        SOURCE.REF_FIELD_9,
                        SOURCE.ORIGINAL_ORDER_NUMBER,
                        SOURCE.IS_GIFT,
                        SOURCE.FLOW_THROUGH_ALLOCATION_METHOD,
                        SOURCE.REF_FIELD_1,
                        SOURCE.REF_FIELD_2,
                        SOURCE.REF_FIELD_3,
                        SOURCE.DRIVER_NAME,
                        SOURCE.WORK_ORD_NBR,
                        SOURCE.REF_FIELD_4,
                        SOURCE.PRO_NUMBER,
                        SOURCE.REF_FIELD_5,
                        SOURCE.REF_FIELD_6,
                        SOURCE.REF_FIELD_7,
                        SOURCE.REF_FIELD_8,
                        SOURCE.TRAILER_CLOSED,
                        SOURCE.RETURN_REFERENCE_NUMBER,
                        SOURCE.LAST_UPDATED_SOURCE_TYPE,
                        SOURCE.ACTUAL_ARRIVAL_DTTM,
                        SOURCE.CONTACT_ZIP,
                        SOURCE.CREATED_SOURCE,
                        SOURCE.CUT_NBR,
                        SOURCE.QUALITY_CHECK_HOLD_UPON_RCPT,
                        SOURCE.LAST_UPDATED_DTTM,
                        SOURCE.EQUIPMENT_CODE,
                        SOURCE.QUALITY_AUDIT_PERCENT,
                        SOURCE.MFG_PLNT,
                        SOURCE.APPOINTMENT_DURATION,
                        SOURCE.IS_ASSOCIATED_TO_OUTBOUND,
                        SOURCE.DESTINATION_FACILITY_ID,
                        SOURCE.ASN_SHPMT_TYPE,
                        SOURCE.APPOINTMENT_ID,
                        SOURCE.ACTUAL_DEPARTURE_DTTM,
                        SOURCE.IS_WHSE_TRANSFER,
                        SOURCE.TC_COMPANY_ID,
                        SOURCE.TOTAL_RECEIVED_QTY,
                        SOURCE.DELIVERY_STOP_SEQ,
                        SOURCE.FIRST_RECEIPT_DTTM,
                        SOURCE.RECEIPT_VARIANCE,
                        SOURCE.REF_FIELD_10,
                        SOURCE.EQUIPMENT_CODE_ID,
                        SOURCE.IS_CLOSED,
                        SOURCE.REGION_ID,
                        SOURCE.SHIPMENT_ID,
                        SOURCE.TOTAL_SHIPPED_QTY,
                        SOURCE.OUTBOUND_REGION_ID,
                        SOURCE.LAST_RECEIPT_DTTM,
                        SOURCE.LAST_UPDATED_SOURCE,
                        SOURCE.BILL_OF_LADING_NUMBER,
                        SOURCE.MISC_INSTR_CODE_2,
                        SOURCE.INBOUND_REGION_NAME,
                        SOURCE.MISC_INSTR_CODE_1,
                        SOURCE.TRACTOR_CARRIER_CODE_ID,
                        SOURCE.IS_CANCELLED,
                        SOURCE.VOLUME_UOM_ID_BASE,
                        SOURCE.CONTACT_COUNTRY_CODE,
                        SOURCE.REF_NUM1,
                        SOURCE.REF_NUM3,
                        SOURCE.PICKUP_END_DTTM,
                        SOURCE.DELIVERY_END_DTTM,
                        SOURCE.REF_NUM2,
                        SOURCE.TC_ASN_ID,
                        SOURCE.MODE_ID,
                        SOURCE.REF_NUM5,
                        SOURCE.REF_NUM4,
                        SOURCE.RECEIPT_DTTM,
                        SOURCE.IS_COGI_GENERATED,
                        SOURCE.EQUIPMENT_TYPE,
                        SOURCE.CONTRAC_LOCN,
                        SOURCE.VARIANCE_TYPE,
                        SOURCE.INVOICE_NUMBER,
                        SOURCE.TRACTOR_CARRIER_CODE,
                        SOURCE.INBOUND_REGION_ID,
                        SOURCE.HAS_IMPORT_ERROR,
                        SOURCE.TC_ASN_ID_U,
                        SOURCE.TOTAL_WEIGHT,
                        SOURCE.EXT_CREATED_DTTM,
                        current_timestamp(),
                        SOURCE.CONTACT_STATE_PROV,
                        SOURCE.HAS_PHOTOS,
                        SOURCE._FIVETRAN_DELETED,
                        SOURCE._FIVETRAN_SYNCED
                        );
                RETURN ('SUCCESS');
        END;
    
---------------- SP_ASN RY

CALL ETL.RY_ARCH.SP_UPDATE_ETL_ASN_RY();

CREATE OR REPLACE PROCEDURE ETL.RY_ARCH.SP_UPDATE_ETL_ASN_RY()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER 
   AS
        BEGIN 
            MERGE INTO ETL.RY_ARCH.ASN AS TARGET
            USING
            (
                SELECT *, current_timestamp() AS ARCHIVE_DTTM
                FROM XBPRDWMRY.PRD_RY_GB_XBORPRDWM.ASN
                WHERE ASN.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())
            ) AS SOURCE

            ON TARGET.ASN_ID = SOURCE.ASN_ID
                WHEN MATCHED AND TARGET.LAST_UPDATED_DTTM < SOURCE.LAST_UPDATED_DTTM 
                    THEN UPDATE SET
                        TARGET.ASN_ID = SOURCE.ASN_ID,
                        TARGET.SYSTEM_ALLOCATED = SOURCE.SYSTEM_ALLOCATED,
                        TARGET.WEIGHT_UOM_ID_BASE = SOURCE.WEIGHT_UOM_ID_BASE,
                        TARGET.HAS_NOTES = SOURCE.HAS_NOTES,
                        TARGET.ROUTE_ID = SOURCE.ROUTE_ID,
                        TARGET.TC_SHIPMENT_ID = SOURCE.TC_SHIPMENT_ID,
                        TARGET.ASSIGNED_CARRIER_CODE_ID = SOURCE.ASSIGNED_CARRIER_CODE_ID,
                        TARGET.INVOICE_DATE = SOURCE.INVOICE_DATE,
                        TARGET.ASN_PRIORITY = SOURCE.ASN_PRIORITY,
                        TARGET.DESTINATION_TYPE = SOURCE.DESTINATION_TYPE,
                        TARGET.TRACTOR_NUMBER = SOURCE.TRACTOR_NUMBER,
                        TARGET.RECEIPT_TYPE = SOURCE.RECEIPT_TYPE,
                        TARGET.HIBERNATE_VERSION = SOURCE.HIBERNATE_VERSION,
                        TARGET.CONTACT_NUMBER = SOURCE.CONTACT_NUMBER,
                        TARGET.PRE_ALLOCATION_FIT_PERCENTAGE = SOURCE.PRE_ALLOCATION_FIT_PERCENTAGE,
                        TARGET.REP_NAME = SOURCE.REP_NAME,
                        TARGET.ASSIGNED_CARRIER_CODE = SOURCE.ASSIGNED_CARRIER_CODE,
                        TARGET.ALLOCATION_COMPLETED = SOURCE.ALLOCATION_COMPLETED,
                        TARGET.LAST_TRANSMITTED_DTTM = SOURCE.LAST_TRANSMITTED_DTTM,
                        TARGET.MANIF_TYPE = SOURCE.MANIF_TYPE,
                        TARGET.APPOINTMENT_DTTM = SOURCE.APPOINTMENT_DTTM,
                        TARGET.ASN_LEVEL = SOURCE.ASN_LEVEL,
                        TARGET.CONTACT_COUNTY = SOURCE.CONTACT_COUNTY,
                        TARGET.MANIF_NBR = SOURCE.MANIF_NBR,
                        TARGET.MHE_SENT = SOURCE.MHE_SENT,
                        TARGET.SHIPPED_LPN_COUNT = SOURCE.SHIPPED_LPN_COUNT,
                        TARGET.OUTBOUND_REGION_NAME = SOURCE.OUTBOUND_REGION_NAME,
                        TARGET.TRAILER_NUMBER = SOURCE.TRAILER_NUMBER,
                        TARGET.DC_ORD_NBR = SOURCE.DC_ORD_NBR,
                        TARGET.TOTAL_VOLUME = SOURCE.TOTAL_VOLUME,
                        TARGET.HAS_ALERTS = SOURCE.HAS_ALERTS,
                        TARGET.CREATED_SOURCE_TYPE = SOURCE.CREATED_SOURCE_TYPE,
                        TARGET.FLOWTHROUGH_ALLOCATION_STATUS = SOURCE.FLOWTHROUGH_ALLOCATION_STATUS,
                        TARGET.ORIGINAL_ASN_ID = SOURCE.ORIGINAL_ASN_ID,
                        TARGET.ASN_ORGN_TYPE = SOURCE.ASN_ORGN_TYPE,
                        TARGET.DOCK_DOOR_ID = SOURCE.DOCK_DOOR_ID,
                        TARGET.CONTACT_CITY = SOURCE.CONTACT_CITY,
                        TARGET.ORIGIN_FACILITY_ALIAS_ID = SOURCE.ORIGIN_FACILITY_ALIAS_ID,
                        TARGET.FLOW_THRU_ALLOC_IN_PROG = SOURCE.FLOW_THRU_ALLOC_IN_PROG,
                        TARGET.LABEL_PRINT_REQD = SOURCE.LABEL_PRINT_REQD,
                        TARGET.VERIFIED_DTTM = SOURCE.VERIFIED_DTTM,
                        TARGET.SHIPPING_COST_CURRENCY_CODE = SOURCE.SHIPPING_COST_CURRENCY_CODE,
                        TARGET.BUSINESS_PARTNER_ID = SOURCE.BUSINESS_PARTNER_ID,
                        TARGET.PALLET_FOOTPRINT = SOURCE.PALLET_FOOTPRINT,
                        TARGET.BUYER_CODE = SOURCE.BUYER_CODE,
                        TARGET.CREATED_DTTM = SOURCE.CREATED_DTTM,
                        TARGET.SCHEDULE_APPT = SOURCE.SCHEDULE_APPT,
                        TARGET.SHIPPING_COST = SOURCE.SHIPPING_COST,
                        TARGET.RECEIVED_LPN_COUNT = SOURCE.RECEIVED_LPN_COUNT,
                        TARGET.ORIGIN_FACILITY_ID = SOURCE.ORIGIN_FACILITY_ID,
                        TARGET.CONTACT_ADDRESS_1 = SOURCE.CONTACT_ADDRESS_1,
                        TARGET.CONTACT_ADDRESS_2 = SOURCE.CONTACT_ADDRESS_2,
                        TARGET.DESTINATION_FACILITY_ALIAS_ID = SOURCE.DESTINATION_FACILITY_ALIAS_ID,
                        TARGET.CONTACT_ADDRESS_3 = SOURCE.CONTACT_ADDRESS_3,
                        TARGET.ASN_TYPE = SOURCE.ASN_TYPE,
                        TARGET.INITIATE_FLAG = SOURCE.INITIATE_FLAG,
                        TARGET.HAS_SOFT_CHECK_ERROR = SOURCE.HAS_SOFT_CHECK_ERROR,
                        TARGET.QTY_UOM_ID_BASE = SOURCE.QTY_UOM_ID_BASE,
                        TARGET.VERIFICATION_ATTEMPTED = SOURCE.VERIFICATION_ATTEMPTED,
                        TARGET.ASN_STATUS = SOURCE.ASN_STATUS,
                        TARGET.PRE_RECEIPT_STATUS = SOURCE.PRE_RECEIPT_STATUS,
                        TARGET.FIRM_APPT_IND = SOURCE.FIRM_APPT_IND,
                        TARGET.ACTUAL_SHIPPED_DTTM = SOURCE.ACTUAL_SHIPPED_DTTM,
                        TARGET.DELIVERY_START_DTTM = SOURCE.DELIVERY_START_DTTM,
                        TARGET.REF_FIELD_9 = SOURCE.REF_FIELD_9,
                        TARGET.ORIGINAL_ORDER_NUMBER = SOURCE.ORIGINAL_ORDER_NUMBER,
                        TARGET.IS_GIFT = SOURCE.IS_GIFT,
                        TARGET.FLOW_THROUGH_ALLOCATION_METHOD = SOURCE.FLOW_THROUGH_ALLOCATION_METHOD,
                        TARGET.REF_FIELD_1 = SOURCE.REF_FIELD_1,
                        TARGET.REF_FIELD_2 = SOURCE.REF_FIELD_2,
                        TARGET.REF_FIELD_3 = SOURCE.REF_FIELD_3,
                        TARGET.DRIVER_NAME = SOURCE.DRIVER_NAME,
                        TARGET.WORK_ORD_NBR = SOURCE.WORK_ORD_NBR,
                        TARGET.REF_FIELD_4 = SOURCE.REF_FIELD_4,
                        TARGET.PRO_NUMBER = SOURCE.PRO_NUMBER,
                        TARGET.REF_FIELD_5 = SOURCE.REF_FIELD_5,
                        TARGET.REF_FIELD_6 = SOURCE.REF_FIELD_6,
                        TARGET.REF_FIELD_7 = SOURCE.REF_FIELD_7,
                        TARGET.REF_FIELD_8 = SOURCE.REF_FIELD_8,
                        TARGET.TRAILER_CLOSED = SOURCE.TRAILER_CLOSED,
                        TARGET.RETURN_REFERENCE_NUMBER = SOURCE.RETURN_REFERENCE_NUMBER,
                        TARGET.LAST_UPDATED_SOURCE_TYPE = SOURCE.LAST_UPDATED_SOURCE_TYPE,
                        TARGET.ACTUAL_ARRIVAL_DTTM = SOURCE.ACTUAL_ARRIVAL_DTTM,
                        TARGET.CONTACT_ZIP = SOURCE.CONTACT_ZIP,
                        TARGET.CREATED_SOURCE = SOURCE.CREATED_SOURCE,
                        TARGET.CUT_NBR = SOURCE.CUT_NBR,
                        TARGET.QUALITY_CHECK_HOLD_UPON_RCPT = SOURCE.QUALITY_CHECK_HOLD_UPON_RCPT,
                        TARGET.LAST_UPDATED_DTTM = SOURCE.LAST_UPDATED_DTTM,
                        TARGET.EQUIPMENT_CODE = SOURCE.EQUIPMENT_CODE,
                        TARGET.QUALITY_AUDIT_PERCENT = SOURCE.QUALITY_AUDIT_PERCENT,
                        TARGET.MFG_PLNT = SOURCE.MFG_PLNT,
                        TARGET.APPOINTMENT_DURATION = SOURCE.APPOINTMENT_DURATION,
                        TARGET.IS_ASSOCIATED_TO_OUTBOUND = SOURCE.IS_ASSOCIATED_TO_OUTBOUND,
                        TARGET.DESTINATION_FACILITY_ID = SOURCE.DESTINATION_FACILITY_ID,
                        TARGET.ASN_SHPMT_TYPE = SOURCE.ASN_SHPMT_TYPE,
                        TARGET.APPOINTMENT_ID = SOURCE.APPOINTMENT_ID,
                        TARGET.ACTUAL_DEPARTURE_DTTM = SOURCE.ACTUAL_DEPARTURE_DTTM,
                        TARGET.IS_WHSE_TRANSFER = SOURCE.IS_WHSE_TRANSFER,
                        TARGET.TC_COMPANY_ID = SOURCE.TC_COMPANY_ID,
                        TARGET.TOTAL_RECEIVED_QTY = SOURCE.TOTAL_RECEIVED_QTY,
                        TARGET.DELIVERY_STOP_SEQ = SOURCE.DELIVERY_STOP_SEQ,
                        TARGET.FIRST_RECEIPT_DTTM = SOURCE.FIRST_RECEIPT_DTTM,
                        TARGET.RECEIPT_VARIANCE = SOURCE.RECEIPT_VARIANCE,
                        TARGET.REF_FIELD_10 = SOURCE.REF_FIELD_10,
                        TARGET.EQUIPMENT_CODE_ID = SOURCE.EQUIPMENT_CODE_ID,
                        TARGET.IS_CLOSED = SOURCE.IS_CLOSED,
                        TARGET.REGION_ID = SOURCE.REGION_ID,
                        TARGET.SHIPMENT_ID = SOURCE.SHIPMENT_ID,
                        TARGET.TOTAL_SHIPPED_QTY = SOURCE.TOTAL_SHIPPED_QTY,
                        TARGET.OUTBOUND_REGION_ID = SOURCE.OUTBOUND_REGION_ID,
                        TARGET.LAST_RECEIPT_DTTM = SOURCE.LAST_RECEIPT_DTTM,
                        TARGET.LAST_UPDATED_SOURCE = SOURCE.LAST_UPDATED_SOURCE,
                        TARGET.BILL_OF_LADING_NUMBER = SOURCE.BILL_OF_LADING_NUMBER,
                        TARGET.MISC_INSTR_CODE_2 = SOURCE.MISC_INSTR_CODE_2,
                        TARGET.INBOUND_REGION_NAME = SOURCE.INBOUND_REGION_NAME,
                        TARGET.MISC_INSTR_CODE_1 = SOURCE.MISC_INSTR_CODE_1,
                        TARGET.TRACTOR_CARRIER_CODE_ID = SOURCE.TRACTOR_CARRIER_CODE_ID,
                        TARGET.IS_CANCELLED = SOURCE.IS_CANCELLED,
                        TARGET.VOLUME_UOM_ID_BASE = SOURCE.VOLUME_UOM_ID_BASE,
                        TARGET.CONTACT_COUNTRY_CODE = SOURCE.CONTACT_COUNTRY_CODE,
                        TARGET.REF_NUM1 = SOURCE.REF_NUM1,
                        TARGET.REF_NUM3 = SOURCE.REF_NUM3,
                        TARGET.PICKUP_END_DTTM = SOURCE.PICKUP_END_DTTM,
                        TARGET.DELIVERY_END_DTTM = SOURCE.DELIVERY_END_DTTM,
                        TARGET.REF_NUM2 = SOURCE.REF_NUM2,
                        TARGET.TC_ASN_ID = SOURCE.TC_ASN_ID,
                        TARGET.MODE_ID = SOURCE.MODE_ID,
                        TARGET.REF_NUM5 = SOURCE.REF_NUM5,
                        TARGET.REF_NUM4 = SOURCE.REF_NUM4,
                        TARGET.RECEIPT_DTTM = SOURCE.RECEIPT_DTTM,
                        TARGET.IS_COGI_GENERATED = SOURCE.IS_COGI_GENERATED,
                        TARGET.EQUIPMENT_TYPE = SOURCE.EQUIPMENT_TYPE,
                        TARGET.CONTRAC_LOCN = SOURCE.CONTRAC_LOCN,
                        TARGET.VARIANCE_TYPE = SOURCE.VARIANCE_TYPE,
                        TARGET.INVOICE_NUMBER = SOURCE.INVOICE_NUMBER,
                        TARGET.TRACTOR_CARRIER_CODE = SOURCE.TRACTOR_CARRIER_CODE,
                        TARGET.INBOUND_REGION_ID = SOURCE.INBOUND_REGION_ID,
                        TARGET.HAS_IMPORT_ERROR = SOURCE.HAS_IMPORT_ERROR,
                        TARGET.TC_ASN_ID_U = SOURCE.TC_ASN_ID_U,
                        TARGET.TOTAL_WEIGHT = SOURCE.TOTAL_WEIGHT,
                        TARGET.EXT_CREATED_DTTM = SOURCE.EXT_CREATED_DTTM,
                        TARGET.ARCHIVE_DTTM = current_timestamp(),
                        TARGET.CONTACT_STATE_PROV = SOURCE.CONTACT_STATE_PROV,
                        TARGET.HAS_PHOTOS = SOURCE.HAS_PHOTOS,
                        TARGET._FIVETRAN_DELETED = SOURCE._FIVETRAN_DELETED,
                    	TARGET._FIVETRAN_SYNCED = SOURCE._FIVETRAN_SYNCED
                WHEN NOT MATCHED 
                    THEN
                        INSERT (
                        ASN_ID,
                    	SYSTEM_ALLOCATED,
                    	WEIGHT_UOM_ID_BASE,
                    	HAS_NOTES,
                    	ROUTE_ID,
                    	TC_SHIPMENT_ID,
                    	ASSIGNED_CARRIER_CODE_ID,
                    	INVOICE_DATE,
                    	ASN_PRIORITY,
                    	DESTINATION_TYPE,
                    	TRACTOR_NUMBER,
                    	RECEIPT_TYPE,
                    	HIBERNATE_VERSION,
                    	CONTACT_NUMBER,
                    	PRE_ALLOCATION_FIT_PERCENTAGE,
                    	REP_NAME,
                    	ASSIGNED_CARRIER_CODE,
                    	ALLOCATION_COMPLETED,
                    	LAST_TRANSMITTED_DTTM,
                    	MANIF_TYPE,
                    	APPOINTMENT_DTTM,
                    	ASN_LEVEL,
                    	CONTACT_COUNTY,
                    	MANIF_NBR,
                    	MHE_SENT,
                    	SHIPPED_LPN_COUNT,
                    	OUTBOUND_REGION_NAME,
                    	TRAILER_NUMBER,
                    	DC_ORD_NBR,
                    	TOTAL_VOLUME,
                    	HAS_ALERTS,
                    	CREATED_SOURCE_TYPE,
                    	FLOWTHROUGH_ALLOCATION_STATUS,
                    	ORIGINAL_ASN_ID,
                    	ASN_ORGN_TYPE,
                    	DOCK_DOOR_ID,
                    	CONTACT_CITY,
                    	ORIGIN_FACILITY_ALIAS_ID,
                    	FLOW_THRU_ALLOC_IN_PROG,
                    	LABEL_PRINT_REQD,
                    	VERIFIED_DTTM,
                    	SHIPPING_COST_CURRENCY_CODE,
                    	BUSINESS_PARTNER_ID,
                    	PALLET_FOOTPRINT,
                    	BUYER_CODE,
                    	CREATED_DTTM,
                    	SCHEDULE_APPT,
                    	SHIPPING_COST,
                    	RECEIVED_LPN_COUNT,
                    	ORIGIN_FACILITY_ID,
                    	CONTACT_ADDRESS_1,
                    	CONTACT_ADDRESS_2,
                    	DESTINATION_FACILITY_ALIAS_ID,
                    	CONTACT_ADDRESS_3,
                    	ASN_TYPE,
                    	INITIATE_FLAG,
                    	HAS_SOFT_CHECK_ERROR,
                    	QTY_UOM_ID_BASE,
                    	VERIFICATION_ATTEMPTED,
                    	ASN_STATUS,
                    	PRE_RECEIPT_STATUS,
                    	FIRM_APPT_IND,
                    	ACTUAL_SHIPPED_DTTM,
                    	DELIVERY_START_DTTM,
                    	REF_FIELD_9,
                    	ORIGINAL_ORDER_NUMBER,
                    	IS_GIFT,
                    	FLOW_THROUGH_ALLOCATION_METHOD,
                    	REF_FIELD_1,
                    	REF_FIELD_2,
                    	REF_FIELD_3,
                    	DRIVER_NAME,
                    	WORK_ORD_NBR,
                    	REF_FIELD_4,
                    	PRO_NUMBER,
                    	REF_FIELD_5,
                    	REF_FIELD_6,
                    	REF_FIELD_7,
                    	REF_FIELD_8,
                    	TRAILER_CLOSED,
                    	RETURN_REFERENCE_NUMBER,
                    	LAST_UPDATED_SOURCE_TYPE,
                    	ACTUAL_ARRIVAL_DTTM,
                    	CONTACT_ZIP,
                    	CREATED_SOURCE,
                    	CUT_NBR,
                    	QUALITY_CHECK_HOLD_UPON_RCPT,
                    	LAST_UPDATED_DTTM,
                    	EQUIPMENT_CODE,
                    	QUALITY_AUDIT_PERCENT,
                    	MFG_PLNT,
                    	APPOINTMENT_DURATION,
                    	IS_ASSOCIATED_TO_OUTBOUND,
                    	DESTINATION_FACILITY_ID,
                    	ASN_SHPMT_TYPE,
                    	APPOINTMENT_ID,
                    	ACTUAL_DEPARTURE_DTTM,
                    	IS_WHSE_TRANSFER,
                    	TC_COMPANY_ID,
                    	TOTAL_RECEIVED_QTY,
                    	DELIVERY_STOP_SEQ,
                    	FIRST_RECEIPT_DTTM,
                    	RECEIPT_VARIANCE,
                    	REF_FIELD_10,
                    	EQUIPMENT_CODE_ID,
                    	IS_CLOSED,
                    	REGION_ID,
                    	SHIPMENT_ID,
                    	TOTAL_SHIPPED_QTY,
                    	OUTBOUND_REGION_ID,
                    	LAST_RECEIPT_DTTM,
                    	LAST_UPDATED_SOURCE,
                    	BILL_OF_LADING_NUMBER,
                    	MISC_INSTR_CODE_2,
                    	INBOUND_REGION_NAME,
                    	MISC_INSTR_CODE_1,
                    	TRACTOR_CARRIER_CODE_ID,
                    	IS_CANCELLED,
                    	VOLUME_UOM_ID_BASE,
                    	CONTACT_COUNTRY_CODE,
                    	REF_NUM1,
                    	REF_NUM3,
                    	PICKUP_END_DTTM,
                    	DELIVERY_END_DTTM,
                    	REF_NUM2,
                    	TC_ASN_ID,
                    	MODE_ID,
                    	REF_NUM5,
                    	REF_NUM4,
                    	RECEIPT_DTTM,
                    	IS_COGI_GENERATED,
                    	EQUIPMENT_TYPE,
                    	CONTRAC_LOCN,
                    	VARIANCE_TYPE,
                    	INVOICE_NUMBER,
                    	TRACTOR_CARRIER_CODE,
                    	INBOUND_REGION_ID,
                    	HAS_IMPORT_ERROR,
                    	TC_ASN_ID_U,
                    	TOTAL_WEIGHT,
                    	EXT_CREATED_DTTM,
                    	ARCHIVE_DTTM,
                    	CONTACT_STATE_PROV,
                    	HAS_PHOTOS,
                    	_FIVETRAN_DELETED,
                    	_FIVETRAN_SYNCED
                        )
                        VALUES (
                        SOURCE.ASN_ID,
                        SOURCE.SYSTEM_ALLOCATED,
                        SOURCE.WEIGHT_UOM_ID_BASE,
                        SOURCE.HAS_NOTES,
                        SOURCE.ROUTE_ID,
                        SOURCE.TC_SHIPMENT_ID,
                        SOURCE.ASSIGNED_CARRIER_CODE_ID,
                        SOURCE.INVOICE_DATE,
                        SOURCE.ASN_PRIORITY,
                        SOURCE.DESTINATION_TYPE,
                        SOURCE.TRACTOR_NUMBER,
                        SOURCE.RECEIPT_TYPE,
                        SOURCE.HIBERNATE_VERSION,
                        SOURCE.CONTACT_NUMBER,
                        SOURCE.PRE_ALLOCATION_FIT_PERCENTAGE,
                        SOURCE.REP_NAME,
                        SOURCE.ASSIGNED_CARRIER_CODE,
                        SOURCE.ALLOCATION_COMPLETED,
                        SOURCE.LAST_TRANSMITTED_DTTM,
                        SOURCE.MANIF_TYPE,
                        SOURCE.APPOINTMENT_DTTM,
                        SOURCE.ASN_LEVEL,
                        SOURCE.CONTACT_COUNTY,
                        SOURCE.MANIF_NBR,
                        SOURCE.MHE_SENT,
                        SOURCE.SHIPPED_LPN_COUNT,
                        SOURCE.OUTBOUND_REGION_NAME,
                        SOURCE.TRAILER_NUMBER,
                        SOURCE.DC_ORD_NBR,
                        SOURCE.TOTAL_VOLUME,
                        SOURCE.HAS_ALERTS,
                        SOURCE.CREATED_SOURCE_TYPE,
                        SOURCE.FLOWTHROUGH_ALLOCATION_STATUS,
                        SOURCE.ORIGINAL_ASN_ID,
                        SOURCE.ASN_ORGN_TYPE,
                        SOURCE.DOCK_DOOR_ID,
                        SOURCE.CONTACT_CITY,
                        SOURCE.ORIGIN_FACILITY_ALIAS_ID,
                        SOURCE.FLOW_THRU_ALLOC_IN_PROG,
                        SOURCE.LABEL_PRINT_REQD,
                        SOURCE.VERIFIED_DTTM,
                        SOURCE.SHIPPING_COST_CURRENCY_CODE,
                        SOURCE.BUSINESS_PARTNER_ID,
                        SOURCE.PALLET_FOOTPRINT,
                        SOURCE.BUYER_CODE,
                        SOURCE.CREATED_DTTM,
                        SOURCE.SCHEDULE_APPT,
                        SOURCE.SHIPPING_COST,
                        SOURCE.RECEIVED_LPN_COUNT,
                        SOURCE.ORIGIN_FACILITY_ID,
                        SOURCE.CONTACT_ADDRESS_1,
                        SOURCE.CONTACT_ADDRESS_2,
                        SOURCE.DESTINATION_FACILITY_ALIAS_ID,
                        SOURCE.CONTACT_ADDRESS_3,
                        SOURCE.ASN_TYPE,
                        SOURCE.INITIATE_FLAG,
                        SOURCE.HAS_SOFT_CHECK_ERROR,
                        SOURCE.QTY_UOM_ID_BASE,
                        SOURCE.VERIFICATION_ATTEMPTED,
                        SOURCE.ASN_STATUS,
                        SOURCE.PRE_RECEIPT_STATUS,
                        SOURCE.FIRM_APPT_IND,
                        SOURCE.ACTUAL_SHIPPED_DTTM,
                        SOURCE.DELIVERY_START_DTTM,
                        SOURCE.REF_FIELD_9,
                        SOURCE.ORIGINAL_ORDER_NUMBER,
                        SOURCE.IS_GIFT,
                        SOURCE.FLOW_THROUGH_ALLOCATION_METHOD,
                        SOURCE.REF_FIELD_1,
                        SOURCE.REF_FIELD_2,
                        SOURCE.REF_FIELD_3,
                        SOURCE.DRIVER_NAME,
                        SOURCE.WORK_ORD_NBR,
                        SOURCE.REF_FIELD_4,
                        SOURCE.PRO_NUMBER,
                        SOURCE.REF_FIELD_5,
                        SOURCE.REF_FIELD_6,
                        SOURCE.REF_FIELD_7,
                        SOURCE.REF_FIELD_8,
                        SOURCE.TRAILER_CLOSED,
                        SOURCE.RETURN_REFERENCE_NUMBER,
                        SOURCE.LAST_UPDATED_SOURCE_TYPE,
                        SOURCE.ACTUAL_ARRIVAL_DTTM,
                        SOURCE.CONTACT_ZIP,
                        SOURCE.CREATED_SOURCE,
                        SOURCE.CUT_NBR,
                        SOURCE.QUALITY_CHECK_HOLD_UPON_RCPT,
                        SOURCE.LAST_UPDATED_DTTM,
                        SOURCE.EQUIPMENT_CODE,
                        SOURCE.QUALITY_AUDIT_PERCENT,
                        SOURCE.MFG_PLNT,
                        SOURCE.APPOINTMENT_DURATION,
                        SOURCE.IS_ASSOCIATED_TO_OUTBOUND,
                        SOURCE.DESTINATION_FACILITY_ID,
                        SOURCE.ASN_SHPMT_TYPE,
                        SOURCE.APPOINTMENT_ID,
                        SOURCE.ACTUAL_DEPARTURE_DTTM,
                        SOURCE.IS_WHSE_TRANSFER,
                        SOURCE.TC_COMPANY_ID,
                        SOURCE.TOTAL_RECEIVED_QTY,
                        SOURCE.DELIVERY_STOP_SEQ,
                        SOURCE.FIRST_RECEIPT_DTTM,
                        SOURCE.RECEIPT_VARIANCE,
                        SOURCE.REF_FIELD_10,
                        SOURCE.EQUIPMENT_CODE_ID,
                        SOURCE.IS_CLOSED,
                        SOURCE.REGION_ID,
                        SOURCE.SHIPMENT_ID,
                        SOURCE.TOTAL_SHIPPED_QTY,
                        SOURCE.OUTBOUND_REGION_ID,
                        SOURCE.LAST_RECEIPT_DTTM,
                        SOURCE.LAST_UPDATED_SOURCE,
                        SOURCE.BILL_OF_LADING_NUMBER,
                        SOURCE.MISC_INSTR_CODE_2,
                        SOURCE.INBOUND_REGION_NAME,
                        SOURCE.MISC_INSTR_CODE_1,
                        SOURCE.TRACTOR_CARRIER_CODE_ID,
                        SOURCE.IS_CANCELLED,
                        SOURCE.VOLUME_UOM_ID_BASE,
                        SOURCE.CONTACT_COUNTRY_CODE,
                        SOURCE.REF_NUM1,
                        SOURCE.REF_NUM3,
                        SOURCE.PICKUP_END_DTTM,
                        SOURCE.DELIVERY_END_DTTM,
                        SOURCE.REF_NUM2,
                        SOURCE.TC_ASN_ID,
                        SOURCE.MODE_ID,
                        SOURCE.REF_NUM5,
                        SOURCE.REF_NUM4,
                        SOURCE.RECEIPT_DTTM,
                        SOURCE.IS_COGI_GENERATED,
                        SOURCE.EQUIPMENT_TYPE,
                        SOURCE.CONTRAC_LOCN,
                        SOURCE.VARIANCE_TYPE,
                        SOURCE.INVOICE_NUMBER,
                        SOURCE.TRACTOR_CARRIER_CODE,
                        SOURCE.INBOUND_REGION_ID,
                        SOURCE.HAS_IMPORT_ERROR,
                        SOURCE.TC_ASN_ID_U,
                        SOURCE.TOTAL_WEIGHT,
                        SOURCE.EXT_CREATED_DTTM,
                        current_timestamp(),
                        SOURCE.CONTACT_STATE_PROV,
                        SOURCE.HAS_PHOTOS,
                        SOURCE._FIVETRAN_DELETED,
                        SOURCE._FIVETRAN_SYNCED
                        );
                RETURN ('SUCCESS');
        END;
    