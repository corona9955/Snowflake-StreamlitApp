CREATE OR REPLACE TABLE ETL.GOLD_ARCH.ORDER_LINE_ITEM 
AS
   SELECT
        LINE_ITEM_ID,
    	ORDER_ID,
    	WEIGHT_UOM_ID_BASE,
    	UNIT_COST,
    	PPACK_GRP_CODE,
    	ITEM_NAME,
    	DO_DTL_STATUS,
    	INTERNAL_ORDER_SEQ_NBR,
    	BACK_ORD_REASON,
    	STD_BUNDLE_QTY,
    	COMMODITY_CODE_ID,
    	PICK_LOCN_ID,
    	REFERENCE_ORDER_ID,
    	EXT_PURCHASE_ORDER,
    	REF_SYSCODE1,
    	REF_SYSCODE2,
    	STACK_LENGTH_STANDARD_UOM,
    	REF_SYSCODE3,
    	TC_ORDER_LINE_ID,
    	MINOR_ORDER_NBR,
    	INTERNAL_ORDER_ID,
    	RECEIVED_VOLUME,
    	MV_SIZE_UOM_ID,
    	EXT_SYS_LINE_ITEM_ID,
    	GIFT_CARD_VALUE,
    	MV_CURRENCY_CODE,
    	UNIT_VOL,
    	STACK_LENGTH_VALUE,
    	PARTL_FILL,
    	QTY_UOM_ID,
    	IS_HAZMAT,
    	STACK_DIAMETER_STANDARD_UOM,
    	LPN_TYPE,
    	CREATED_SOURCE_TYPE,
    	PICKUP_START_DTTM,
    	STACK_WIDTH_VALUE,
    	STD_LPN_VOL,
    	ALLOW_REVIVAL_RECEIPT_ALLOC,
    	DESCRIPTION,
    	MERCH_GRP,
    	MANUFACTURING_DTTM,
    	LINE_TYPE,
    	PACK_RATE,
    	WAVE_NBR,
    	STD_LPN_WT,
    	INVN_TYPE,
    	PLANNED_SHIP_DATE,
    	SUBSTITUTED_PARENT_LINE_ID,
    	PROTECTION_LEVEL_ID,
    	QTY_UOM_ID_BASE,
    	PARENT_LINE_ITEM_ID,
    	PALLET_TYPE,
    	ALLOC_LINE_ID,
    	SUBSTITUTION_TYPE,
    	ACTUAL_SHIPPED_DTTM,
    	DELIVERY_START_DTTM,
    	PICK_LOCN_ASSIGN_TYPE,
    	FREIGHT_REVENUE_CURRENCY_CODE,
    	BUDG_COST_CURRENCY_CODE,
    	ORDER_LINE_ID,
    	ACTUAL_COST_CURRENCY_CODE,
    	PRIORITY,
    	SHELF_DAYS,
    	COMMODITY_CLASS,
    	LPN_SIZE,
    	SIZE2_UOM_ID,
    	CREATED_SOURCE,
    	WEIGHT_UOM_ID,
    	PURCHASE_ORDER_LINE_NUMBER,
    	STORE_DEPT,
    	LAST_UPDATED_DTTM,
    	RECEIVED_WEIGHT,
    	IS_EMERGENCY,
    	SKU_SUB_CODE_VALUE,
    	MO_LINE_ITEM_ID,
    	UNIT_TAX_AMOUNT,
    	CNTRY_OF_ORGN,
    	ALLOC_TYPE,
    	PICKUP_REFERENCE_NUMBER,
    	WM_RECEIPT_ALLOCATED,
    	ADJUSTED_ORDER_QTY,
    	WAVE_PROC_TYPE,
    	IS_STACKABLE,
    	LAST_UPDATED_SOURCE,
    	CRITCL_DIM_3,
    	REPL_WAVE_RUN,
    	UNIT_WT,
    	RETAIL_PRICE,
    	ORDER_QTY,
    	MASTER_ORDER_ID,
    	UNIT_PRICE_AMOUNT,
    	REF_NUM1,
    	REF_NUM3,
    	DELIVERY_END_DTTM,
    	REF_NUM2,
    	REF_NUM5,
    	REF_NUM4,
    	ACTUAL_COST,
    	PURCHASE_ORDER_NUMBER,
    	REASON_CODE,
    	ALLOCATION_SOURCE,
    	DELIVERY_REFERENCE_NUMBER,
    	SHIPPED_WEIGHT,
    	UN_NUMBER_ID,
    	VAS_PROCESS_TYPE,
    	FULFILLMENT_TYPE,
    	MERCH_TYPE,
    	CRITCL_DIM_1,
    	CRITCL_DIM_2,
    	REPL_PROC_TYPE,
    	CUBE_MULTIPLE_QTY,
    	UNITS_PAKD,
    	SINGLE_UNIT_FLAG,
    	PLANNED_WEIGHT,
    	SKU_GTIN,
    	ORIG_BUDG_COST,
    	STACK_DIAMETER_VALUE,
    	IS_CHASE_CREATED_LINE,
    	ORIG_ORDER_QTY,
    	HIBERNATE_VERSION,
    	PPACK_QTY,
    	CUSTOM_TAG,
    	LPN_BRK_ATTRIB,
    	PACK_ZONE,
    	BATCH_REQUIREMENT_TYPE,
    	LOCKED,
    	ALLOCATED_QTY,
    	SIZE2_VALUE,
    	ITEM_ID,
    	ALLOCATION_SOURCE_ID,
    	STACK_HEIGHT_STANDARD_UOM,
    	RTS_LINE_ITEM_ID,
    	HAS_ERRORS,
    	TOTAL_MONETARY_VALUE,
    	STD_PALLET_QTY,
    	UNIT_MONETARY_VALUE,
    	BUDG_COST,
    	REF_BOOLEAN1,
    	EXP_INFO_CODE,
    	REF_BOOLEAN2,
    	STD_SUB_PACK_QTY,
    	HARD_ALLOC_REASON_CODE,
    	RECEIVED_QTY,
    	REFERENCE_LINE_ITEM_ID,
    	PLANNED_VOLUME,
    	CREATED_DTTM,
    	CUSTOMER_ITEM,
    	SHIPPED_VOLUME,
    	REF_FIELD10,
    	RECEIVED_SIZE2,
    	RECEIVED_SIZE1,
    	REF_FIELD1,
    	REF_FIELD4,
    	REF_FIELD5,
    	REF_FIELD2,
    	REF_FIELD3,
    	PRE_RECEIPT_STATUS,
    	REF_FIELD8,
    	REF_FIELD9,
    	REF_FIELD6,
    	SKU_SUB_CODE_ID,
    	REF_FIELD7,
    	RTS_ID,
    	SIZE1_VALUE,
    	IS_GIFT,
    	SEGMENT_NAME,
    	ITEM_ATTR_4,
    	ITEM_ATTR_5,
    	ITEM_ATTR_2,
    	PRODUCT_CLASS_ID,
    	ITEM_ATTR_3,
    	SIZE1_UOM_ID,
    	ITEM_ATTR_1,
    	REPL_WAVE_NBR,
    	LAST_UPDATED_SOURCE_TYPE,
    	FREIGHT_REVENUE,
    	PRICE,
    	SKU_BREAK_ATTR,
    	ALLOCATION_SOURCE_LINE_ID,
    	STACK_RANK,
    	BATCH_NBR,
    	ASSORT_NBR,
    	TC_COMPANY_ID,
    	STD_LPN_QTY,
    	CHUTE_ASSIGN_TYPE,
    	PACKAGE_TYPE_ID,
    	ORDER_CONSOL_ATTR,
    	SHIPPED_QTY,
    	EVENT_CODE,
    	PROD_STAT,
    	STACK_HEIGHT_VALUE,
    	EFFECTIVE_RANK,
    	STACK_WIDTH_STANDARD_UOM,
    	SHIP_WAVE_NBR,
    	STD_PACK_QTY,
    	IS_CANCELLED,
    	VOLUME_UOM_ID_BASE,
    	RTL_TO_BE_DISTROED_QTY,
    	QTY_CONV_FACTOR,
    	PRICE_TKT_TYPE,
    	PICKUP_END_DTTM,
    	ORIGINAL_ORDERED_ITEM_ID,
    	USER_CANCELED_QTY,
    	MERCHANDIZING_DEPARTMENT_ID,
    	SHIPPED_SIZE1,
    	SHIPPED_SIZE2,
    	VOLUME_UOM_ID,
    	SERIAL_NUMBER_REQUIRED_FLAG,
        current_timestamp() as ARCHIVE_DTTM,
    	_FIVETRAN_DELETED,
    	_FIVETRAN_SYNCED
        FROM XBPRDWMGOLD.PRD_GOLD_GA_XBWM19WM.ORDER_LINE_ITEM
        WHERE ORDER_LINE_ITEM.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())
    UNION
SELECT
    LINE_ITEM_ID,
	ORDER_ID,
	WEIGHT_UOM_ID_BASE,
	UNIT_COST,
	PPACK_GRP_CODE,
	ITEM_NAME,
	DO_DTL_STATUS,
	INTERNAL_ORDER_SEQ_NBR,
	BACK_ORD_REASON,
	STD_BUNDLE_QTY,
	COMMODITY_CODE_ID,
	PICK_LOCN_ID,
	REFERENCE_ORDER_ID,
	EXT_PURCHASE_ORDER,
	REF_SYSCODE1,
	REF_SYSCODE2,
	STACK_LENGTH_STANDARD_UOM,
	REF_SYSCODE3,
	TC_ORDER_LINE_ID,
	MINOR_ORDER_NBR,
	INTERNAL_ORDER_ID,
	RECEIVED_VOLUME,
	MV_SIZE_UOM_ID,
	EXT_SYS_LINE_ITEM_ID,
	GIFT_CARD_VALUE,
	MV_CURRENCY_CODE,
	UNIT_VOL,
	STACK_LENGTH_VALUE,
	PARTL_FILL,
	QTY_UOM_ID,
	IS_HAZMAT,
	STACK_DIAMETER_STANDARD_UOM,
	LPN_TYPE,
	CREATED_SOURCE_TYPE,
	PICKUP_START_DTTM,
	STACK_WIDTH_VALUE,
	STD_LPN_VOL,
	ALLOW_REVIVAL_RECEIPT_ALLOC,
	DESCRIPTION,
	MERCH_GRP,
	MANUFACTURING_DTTM,
	LINE_TYPE,
	PACK_RATE,
	WAVE_NBR,
	STD_LPN_WT,
	INVN_TYPE,
	PLANNED_SHIP_DATE,
	SUBSTITUTED_PARENT_LINE_ID,
	PROTECTION_LEVEL_ID,
	QTY_UOM_ID_BASE,
	PARENT_LINE_ITEM_ID,
	PALLET_TYPE,
	ALLOC_LINE_ID,
	SUBSTITUTION_TYPE,
	ACTUAL_SHIPPED_DTTM,
	DELIVERY_START_DTTM,
	PICK_LOCN_ASSIGN_TYPE,
	FREIGHT_REVENUE_CURRENCY_CODE,
	BUDG_COST_CURRENCY_CODE,
	ORDER_LINE_ID,
	ACTUAL_COST_CURRENCY_CODE,
	PRIORITY,
	SHELF_DAYS,
	COMMODITY_CLASS,
	LPN_SIZE,
	SIZE2_UOM_ID,
	CREATED_SOURCE,
	WEIGHT_UOM_ID,
	PURCHASE_ORDER_LINE_NUMBER,
	STORE_DEPT,
	LAST_UPDATED_DTTM,
	RECEIVED_WEIGHT,
	IS_EMERGENCY,
	SKU_SUB_CODE_VALUE,
	MO_LINE_ITEM_ID,
	UNIT_TAX_AMOUNT,
	CNTRY_OF_ORGN,
	ALLOC_TYPE,
	PICKUP_REFERENCE_NUMBER,
	WM_RECEIPT_ALLOCATED,
	ADJUSTED_ORDER_QTY,
	WAVE_PROC_TYPE,
	IS_STACKABLE,
	LAST_UPDATED_SOURCE,
	CRITCL_DIM_3,
	REPL_WAVE_RUN,
	UNIT_WT,
	RETAIL_PRICE,
	ORDER_QTY,
	MASTER_ORDER_ID,
	UNIT_PRICE_AMOUNT,
	REF_NUM1,
	REF_NUM3,
	DELIVERY_END_DTTM,
	REF_NUM2,
	REF_NUM5,
	REF_NUM4,
	ACTUAL_COST,
	PURCHASE_ORDER_NUMBER,
	REASON_CODE,
	ALLOCATION_SOURCE,
	DELIVERY_REFERENCE_NUMBER,
	SHIPPED_WEIGHT,
	UN_NUMBER_ID,
	VAS_PROCESS_TYPE,
	FULFILLMENT_TYPE,
	MERCH_TYPE,
	CRITCL_DIM_1,
	CRITCL_DIM_2,
	REPL_PROC_TYPE,
	CUBE_MULTIPLE_QTY,
	UNITS_PAKD,
	SINGLE_UNIT_FLAG,
	PLANNED_WEIGHT,
	SKU_GTIN,
	ORIG_BUDG_COST,
	STACK_DIAMETER_VALUE,
	IS_CHASE_CREATED_LINE,
	ORIG_ORDER_QTY,
	HIBERNATE_VERSION,
	PPACK_QTY,
	CUSTOM_TAG,
	LPN_BRK_ATTRIB,
	PACK_ZONE,
	BATCH_REQUIREMENT_TYPE,
	LOCKED,
	ALLOCATED_QTY,
	SIZE2_VALUE,
	ITEM_ID,
	ALLOCATION_SOURCE_ID,
	STACK_HEIGHT_STANDARD_UOM,
	RTS_LINE_ITEM_ID,
	HAS_ERRORS,
	TOTAL_MONETARY_VALUE,
	STD_PALLET_QTY,
	UNIT_MONETARY_VALUE,
	BUDG_COST,
	REF_BOOLEAN1,
	EXP_INFO_CODE,
	REF_BOOLEAN2,
	STD_SUB_PACK_QTY,
	HARD_ALLOC_REASON_CODE,
	RECEIVED_QTY,
	REFERENCE_LINE_ITEM_ID,
	PLANNED_VOLUME,
	CREATED_DTTM,
	CUSTOMER_ITEM,
	SHIPPED_VOLUME,
	REF_FIELD10,
	RECEIVED_SIZE2,
	RECEIVED_SIZE1,
	REF_FIELD1,
	REF_FIELD4,
	REF_FIELD5,
	REF_FIELD2,
	REF_FIELD3,
	PRE_RECEIPT_STATUS,
	REF_FIELD8,
	REF_FIELD9,
	REF_FIELD6,
	SKU_SUB_CODE_ID,
	REF_FIELD7,
	RTS_ID,
	SIZE1_VALUE,
	IS_GIFT,
	SEGMENT_NAME,
	ITEM_ATTR_4,
	ITEM_ATTR_5,
	ITEM_ATTR_2,
	PRODUCT_CLASS_ID,
	ITEM_ATTR_3,
	SIZE1_UOM_ID,
	ITEM_ATTR_1,
	REPL_WAVE_NBR,
	LAST_UPDATED_SOURCE_TYPE,
	FREIGHT_REVENUE,
	PRICE,
	SKU_BREAK_ATTR,
	ALLOCATION_SOURCE_LINE_ID,
	STACK_RANK,
	BATCH_NBR,
	ASSORT_NBR,
	TC_COMPANY_ID,
	STD_LPN_QTY,
	CHUTE_ASSIGN_TYPE,
	PACKAGE_TYPE_ID,
	ORDER_CONSOL_ATTR,
	SHIPPED_QTY,
	EVENT_CODE,
	PROD_STAT,
	STACK_HEIGHT_VALUE,
	EFFECTIVE_RANK,
	STACK_WIDTH_STANDARD_UOM,
	SHIP_WAVE_NBR,
	STD_PACK_QTY,
	IS_CANCELLED,
	VOLUME_UOM_ID_BASE,
	RTL_TO_BE_DISTROED_QTY,
	QTY_CONV_FACTOR,
	PRICE_TKT_TYPE,
	PICKUP_END_DTTM,
	ORIGINAL_ORDERED_ITEM_ID,
	USER_CANCELED_QTY,
	MERCHANDIZING_DEPARTMENT_ID,
	SHIPPED_SIZE1,
	SHIPPED_SIZE2,
	VOLUME_UOM_ID,
	SERIAL_NUMBER_REQUIRED_FLAG,
    current_timestamp() as ARCHIVE_DTTM,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED
    FROM XBPRDWMGOLD.PRD_GOLD_D_XBWM19WM.ORDER_LINE_ITEM
    WHERE ORDER_LINE_ITEM.LINE_ITEM_ID  NOT IN (SELECT LINE_ITEM_ID FROM XBPRDWMGOLD.PRD_GOLD_GA_XBWM19WM.ORDER_LINE_ITEM WHERE CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE()))
    
UNION

SELECT
    LINE_ITEM_ID,
	ORDER_ID,
	WEIGHT_UOM_ID_BASE,
	UNIT_COST,
	PPACK_GRP_CODE,
	ITEM_NAME,
	DO_DTL_STATUS,
	INTERNAL_ORDER_SEQ_NBR,
	BACK_ORD_REASON,
	STD_BUNDLE_QTY,
	COMMODITY_CODE_ID,
	PICK_LOCN_ID,
	REFERENCE_ORDER_ID,
	EXT_PURCHASE_ORDER,
	REF_SYSCODE1,
	REF_SYSCODE2,
	STACK_LENGTH_STANDARD_UOM,
	REF_SYSCODE3,
	TC_ORDER_LINE_ID,
	MINOR_ORDER_NBR,
	INTERNAL_ORDER_ID,
	RECEIVED_VOLUME,
	MV_SIZE_UOM_ID,
	EXT_SYS_LINE_ITEM_ID,
	GIFT_CARD_VALUE,
	MV_CURRENCY_CODE,
	UNIT_VOL,
	STACK_LENGTH_VALUE,
	PARTL_FILL,
	QTY_UOM_ID,
	IS_HAZMAT,
	STACK_DIAMETER_STANDARD_UOM,
	LPN_TYPE,
	CREATED_SOURCE_TYPE,
	PICKUP_START_DTTM,
	STACK_WIDTH_VALUE,
	STD_LPN_VOL,
	ALLOW_REVIVAL_RECEIPT_ALLOC,
	DESCRIPTION,
	MERCH_GRP,
	MANUFACTURING_DTTM,
	LINE_TYPE,
	PACK_RATE,
	WAVE_NBR,
	STD_LPN_WT,
	INVN_TYPE,
	PLANNED_SHIP_DATE,
	SUBSTITUTED_PARENT_LINE_ID,
	PROTECTION_LEVEL_ID,
	QTY_UOM_ID_BASE,
	PARENT_LINE_ITEM_ID,
	PALLET_TYPE,
	ALLOC_LINE_ID,
	SUBSTITUTION_TYPE,
	ACTUAL_SHIPPED_DTTM,
	DELIVERY_START_DTTM,
	PICK_LOCN_ASSIGN_TYPE,
	FREIGHT_REVENUE_CURRENCY_CODE,
	BUDG_COST_CURRENCY_CODE,
	ORDER_LINE_ID,
	ACTUAL_COST_CURRENCY_CODE,
	PRIORITY,
	SHELF_DAYS,
	COMMODITY_CLASS,
	LPN_SIZE,
	SIZE2_UOM_ID,
	CREATED_SOURCE,
	WEIGHT_UOM_ID,
	PURCHASE_ORDER_LINE_NUMBER,
	STORE_DEPT,
	LAST_UPDATED_DTTM,
	RECEIVED_WEIGHT,
	IS_EMERGENCY,
	SKU_SUB_CODE_VALUE,
	MO_LINE_ITEM_ID,
	UNIT_TAX_AMOUNT,
	CNTRY_OF_ORGN,
	ALLOC_TYPE,
	PICKUP_REFERENCE_NUMBER,
	WM_RECEIPT_ALLOCATED,
	ADJUSTED_ORDER_QTY,
	WAVE_PROC_TYPE,
	IS_STACKABLE,
	LAST_UPDATED_SOURCE,
	CRITCL_DIM_3,
	REPL_WAVE_RUN,
	UNIT_WT,
	RETAIL_PRICE,
	ORDER_QTY,
	MASTER_ORDER_ID,
	UNIT_PRICE_AMOUNT,
	REF_NUM1,
	REF_NUM3,
	DELIVERY_END_DTTM,
	REF_NUM2,
	REF_NUM5,
	REF_NUM4,
	ACTUAL_COST,
	PURCHASE_ORDER_NUMBER,
	REASON_CODE,
	ALLOCATION_SOURCE,
	DELIVERY_REFERENCE_NUMBER,
	SHIPPED_WEIGHT,
	UN_NUMBER_ID,
	VAS_PROCESS_TYPE,
	FULFILLMENT_TYPE,
	MERCH_TYPE,
	CRITCL_DIM_1,
	CRITCL_DIM_2,
	REPL_PROC_TYPE,
	CUBE_MULTIPLE_QTY,
	UNITS_PAKD,
	SINGLE_UNIT_FLAG,
	PLANNED_WEIGHT,
	SKU_GTIN,
	ORIG_BUDG_COST,
	STACK_DIAMETER_VALUE,
	IS_CHASE_CREATED_LINE,
	ORIG_ORDER_QTY,
	HIBERNATE_VERSION,
	PPACK_QTY,
	CUSTOM_TAG,
	LPN_BRK_ATTRIB,
	PACK_ZONE,
	BATCH_REQUIREMENT_TYPE,
	LOCKED,
	ALLOCATED_QTY,
	SIZE2_VALUE,
	ITEM_ID,
	ALLOCATION_SOURCE_ID,
	STACK_HEIGHT_STANDARD_UOM,
	RTS_LINE_ITEM_ID,
	HAS_ERRORS,
	TOTAL_MONETARY_VALUE,
	STD_PALLET_QTY,
	UNIT_MONETARY_VALUE,
	BUDG_COST,
	REF_BOOLEAN1,
	EXP_INFO_CODE,
	REF_BOOLEAN2,
	STD_SUB_PACK_QTY,
	HARD_ALLOC_REASON_CODE,
	RECEIVED_QTY,
	REFERENCE_LINE_ITEM_ID,
	PLANNED_VOLUME,
	CREATED_DTTM,
	CUSTOMER_ITEM,
	SHIPPED_VOLUME,
	REF_FIELD10,
	RECEIVED_SIZE2,
	RECEIVED_SIZE1,
	REF_FIELD1,
	REF_FIELD4,
	REF_FIELD5,
	REF_FIELD2,
	REF_FIELD3,
	PRE_RECEIPT_STATUS,
	REF_FIELD8,
	REF_FIELD9,
	REF_FIELD6,
	SKU_SUB_CODE_ID,
	REF_FIELD7,
	RTS_ID,
	SIZE1_VALUE,
	IS_GIFT,
	SEGMENT_NAME,
	ITEM_ATTR_4,
	ITEM_ATTR_5,
	ITEM_ATTR_2,
	PRODUCT_CLASS_ID,
	ITEM_ATTR_3,
	SIZE1_UOM_ID,
	ITEM_ATTR_1,
	REPL_WAVE_NBR,
	LAST_UPDATED_SOURCE_TYPE,
	FREIGHT_REVENUE,
	PRICE,
	SKU_BREAK_ATTR,
	ALLOCATION_SOURCE_LINE_ID,
	STACK_RANK,
	BATCH_NBR,
	ASSORT_NBR,
	TC_COMPANY_ID,
	STD_LPN_QTY,
	CHUTE_ASSIGN_TYPE,
	PACKAGE_TYPE_ID,
	ORDER_CONSOL_ATTR,
	SHIPPED_QTY,
	EVENT_CODE,
	PROD_STAT,
	STACK_HEIGHT_VALUE,
	EFFECTIVE_RANK,
	STACK_WIDTH_STANDARD_UOM,
	SHIP_WAVE_NBR,
	STD_PACK_QTY,
	IS_CANCELLED,
	VOLUME_UOM_ID_BASE,
	RTL_TO_BE_DISTROED_QTY,
	QTY_CONV_FACTOR,
	PRICE_TKT_TYPE,
	PICKUP_END_DTTM,
	ORIGINAL_ORDERED_ITEM_ID,
	USER_CANCELED_QTY,
	MERCHANDIZING_DEPARTMENT_ID,
	SHIPPED_SIZE1,
	SHIPPED_SIZE2,
	VOLUME_UOM_ID,
	SERIAL_NUMBER_REQUIRED_FLAG,
    ARCHIVE_DTTM,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED
   FROM XBPRDARCHGOLD.ARCH_GOLD_C_XBWM19ARCH.ORDER_LINE_ITEM
   WHERE ORDER_LINE_ITEM.LINE_ITEM_ID  NOT IN (SELECT LINE_ITEM_ID FROM XBPRDWMGOLD.PRD_GOLD_GA_XBWM19WM.ORDER_LINE_ITEM WHERE ORDER_LINE_ITEM.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE()))
    AND ORDER_LINE_ITEM.LINE_ITEM_ID  NOT IN (SELECT LINE_ITEM_ID FROM XBPRDWMGOLD.PRD_GOLD_D_XBWM19WM.ORDER_LINE_ITEM)
;


CREATE OR REPLACE TABLE ETL.SILVER_ARCH.ORDER_LINE_ITEM 
AS
SELECT 
    LINE_ITEM_ID,
	ORDER_ID,
	WEIGHT_UOM_ID_BASE,
	UNIT_COST,
	PPACK_GRP_CODE,
	ITEM_NAME,
	DO_DTL_STATUS,
	INTERNAL_ORDER_SEQ_NBR,
	BACK_ORD_REASON,
	STD_BUNDLE_QTY,
	COMMODITY_CODE_ID,
	PICK_LOCN_ID,
	REFERENCE_ORDER_ID,
	EXT_PURCHASE_ORDER,
	REF_SYSCODE1,
	REF_SYSCODE2,
	STACK_LENGTH_STANDARD_UOM,
	REF_SYSCODE3,
	TC_ORDER_LINE_ID,
	MINOR_ORDER_NBR,
	INTERNAL_ORDER_ID,
	RECEIVED_VOLUME,
	MV_SIZE_UOM_ID,
	EXT_SYS_LINE_ITEM_ID,
	GIFT_CARD_VALUE,
	MV_CURRENCY_CODE,
	UNIT_VOL,
	STACK_LENGTH_VALUE,
	PARTL_FILL,
	QTY_UOM_ID,
	IS_HAZMAT,
	STACK_DIAMETER_STANDARD_UOM,
	LPN_TYPE,
	CREATED_SOURCE_TYPE,
	PICKUP_START_DTTM,
	STACK_WIDTH_VALUE,
	STD_LPN_VOL,
	ALLOW_REVIVAL_RECEIPT_ALLOC,
	DESCRIPTION,
	MERCH_GRP,
	MANUFACTURING_DTTM,
	LINE_TYPE,
	PACK_RATE,
	WAVE_NBR,
	STD_LPN_WT,
	INVN_TYPE,
	PLANNED_SHIP_DATE,
	SUBSTITUTED_PARENT_LINE_ID,
	PROTECTION_LEVEL_ID,
	QTY_UOM_ID_BASE,
	PARENT_LINE_ITEM_ID,
	PALLET_TYPE,
	ALLOC_LINE_ID,
	SUBSTITUTION_TYPE,
	ACTUAL_SHIPPED_DTTM,
	DELIVERY_START_DTTM,
	PICK_LOCN_ASSIGN_TYPE,
	FREIGHT_REVENUE_CURRENCY_CODE,
	BUDG_COST_CURRENCY_CODE,
	ORDER_LINE_ID,
	ACTUAL_COST_CURRENCY_CODE,
	PRIORITY,
	SHELF_DAYS,
	COMMODITY_CLASS,
	LPN_SIZE,
	SIZE2_UOM_ID,
	CREATED_SOURCE,
	WEIGHT_UOM_ID,
	PURCHASE_ORDER_LINE_NUMBER,
	STORE_DEPT,
	LAST_UPDATED_DTTM,
	RECEIVED_WEIGHT,
	IS_EMERGENCY,
	SKU_SUB_CODE_VALUE,
	MO_LINE_ITEM_ID,
	UNIT_TAX_AMOUNT,
	CNTRY_OF_ORGN,
	ALLOC_TYPE,
	PICKUP_REFERENCE_NUMBER,
	WM_RECEIPT_ALLOCATED,
	ADJUSTED_ORDER_QTY,
	WAVE_PROC_TYPE,
	IS_STACKABLE,
	LAST_UPDATED_SOURCE,
	CRITCL_DIM_3,
	REPL_WAVE_RUN,
	UNIT_WT,
	RETAIL_PRICE,
	ORDER_QTY,
	MASTER_ORDER_ID,
	UNIT_PRICE_AMOUNT,
	REF_NUM1,
	REF_NUM3,
	DELIVERY_END_DTTM,
	REF_NUM2,
	REF_NUM5,
	REF_NUM4,
	ACTUAL_COST,
	PURCHASE_ORDER_NUMBER,
	REASON_CODE,
	ALLOCATION_SOURCE,
	DELIVERY_REFERENCE_NUMBER,
	SHIPPED_WEIGHT,
	UN_NUMBER_ID,
	VAS_PROCESS_TYPE,
	FULFILLMENT_TYPE,
	MERCH_TYPE,
	CRITCL_DIM_1,
	CRITCL_DIM_2,
	REPL_PROC_TYPE,
	CUBE_MULTIPLE_QTY,
	UNITS_PAKD,
	SINGLE_UNIT_FLAG,
	PLANNED_WEIGHT,
	SKU_GTIN,
	ORIG_BUDG_COST,
	STACK_DIAMETER_VALUE,
	IS_CHASE_CREATED_LINE,
	ORIG_ORDER_QTY,
	HIBERNATE_VERSION,
	PPACK_QTY,
	CUSTOM_TAG,
	LPN_BRK_ATTRIB,
	PACK_ZONE,
	BATCH_REQUIREMENT_TYPE,
	LOCKED,
	ALLOCATED_QTY,
	SIZE2_VALUE,
	ITEM_ID,
	ALLOCATION_SOURCE_ID,
	STACK_HEIGHT_STANDARD_UOM,
	RTS_LINE_ITEM_ID,
	HAS_ERRORS,
	TOTAL_MONETARY_VALUE,
	STD_PALLET_QTY,
	UNIT_MONETARY_VALUE,
	BUDG_COST,
	REF_BOOLEAN1,
	EXP_INFO_CODE,
	REF_BOOLEAN2,
	STD_SUB_PACK_QTY,
	HARD_ALLOC_REASON_CODE,
	RECEIVED_QTY,
	REFERENCE_LINE_ITEM_ID,
	PLANNED_VOLUME,
	CREATED_DTTM,
	CUSTOMER_ITEM,
	SHIPPED_VOLUME,
	REF_FIELD10,
	RECEIVED_SIZE2,
	RECEIVED_SIZE1,
	REF_FIELD1,
	REF_FIELD4,
	REF_FIELD5,
	REF_FIELD2,
	REF_FIELD3,
	PRE_RECEIPT_STATUS,
	REF_FIELD8,
	REF_FIELD9,
	REF_FIELD6,
	SKU_SUB_CODE_ID,
	TO_VARCHAR(REF_FIELD7) REF_FIELD7,
	RTS_ID,
	SIZE1_VALUE,
	IS_GIFT,
	SEGMENT_NAME,
	ITEM_ATTR_4,
	ITEM_ATTR_5,
	ITEM_ATTR_2,
	PRODUCT_CLASS_ID,
	ITEM_ATTR_3,
	SIZE1_UOM_ID,
	ITEM_ATTR_1,
	REPL_WAVE_NBR,
	LAST_UPDATED_SOURCE_TYPE,
	FREIGHT_REVENUE,
	PRICE,
	SKU_BREAK_ATTR,
	ALLOCATION_SOURCE_LINE_ID,
	STACK_RANK,
	BATCH_NBR,
	ASSORT_NBR,
	TC_COMPANY_ID,
	STD_LPN_QTY,
	CHUTE_ASSIGN_TYPE,
	PACKAGE_TYPE_ID,
	ORDER_CONSOL_ATTR,
	SHIPPED_QTY,
	EVENT_CODE,
	PROD_STAT,
	STACK_HEIGHT_VALUE,
	EFFECTIVE_RANK,
	STACK_WIDTH_STANDARD_UOM,
	SHIP_WAVE_NBR,
	STD_PACK_QTY,
	IS_CANCELLED,
	VOLUME_UOM_ID_BASE,
	RTL_TO_BE_DISTROED_QTY,
	QTY_CONV_FACTOR,
	PRICE_TKT_TYPE,
	PICKUP_END_DTTM,
	ORIGINAL_ORDERED_ITEM_ID,
	USER_CANCELED_QTY,
	MERCHANDIZING_DEPARTMENT_ID,
	SHIPPED_SIZE1,
	SHIPPED_SIZE2,
	VOLUME_UOM_ID,
	SERIAL_NUMBER_REQUIRED_FLAG,
    current_timestamp() as ARCHIVE_DTTM,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED
    FROM XBPRDWMSILVER.PRD_SILVER_GA_XBDBTJ3WM.ORDER_LINE_ITEM
    WHERE ORDER_LINE_ITEM.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())
    
    UNION
    
SELECT 
    LINE_ITEM_ID,
	ORDER_ID,
	WEIGHT_UOM_ID_BASE,
	UNIT_COST,
	PPACK_GRP_CODE,
	ITEM_NAME,
	DO_DTL_STATUS,
	INTERNAL_ORDER_SEQ_NBR,
	BACK_ORD_REASON,
	STD_BUNDLE_QTY,
	COMMODITY_CODE_ID,
	PICK_LOCN_ID,
	REFERENCE_ORDER_ID,
	EXT_PURCHASE_ORDER,
	REF_SYSCODE1,
	REF_SYSCODE2,
	STACK_LENGTH_STANDARD_UOM,
	REF_SYSCODE3,
	TC_ORDER_LINE_ID,
	MINOR_ORDER_NBR,
	INTERNAL_ORDER_ID,
	RECEIVED_VOLUME,
	MV_SIZE_UOM_ID,
	EXT_SYS_LINE_ITEM_ID,
	GIFT_CARD_VALUE,
	MV_CURRENCY_CODE,
	UNIT_VOL,
	STACK_LENGTH_VALUE,
	PARTL_FILL,
	QTY_UOM_ID,
	IS_HAZMAT,
	STACK_DIAMETER_STANDARD_UOM,
	LPN_TYPE,
	CREATED_SOURCE_TYPE,
	PICKUP_START_DTTM,
	STACK_WIDTH_VALUE,
	STD_LPN_VOL,
	ALLOW_REVIVAL_RECEIPT_ALLOC,
	DESCRIPTION,
	MERCH_GRP,
	MANUFACTURING_DTTM,
	LINE_TYPE,
	PACK_RATE,
	WAVE_NBR,
	STD_LPN_WT,
	INVN_TYPE,
	PLANNED_SHIP_DATE,
	SUBSTITUTED_PARENT_LINE_ID,
	PROTECTION_LEVEL_ID,
	QTY_UOM_ID_BASE,
	PARENT_LINE_ITEM_ID,
	PALLET_TYPE,
	ALLOC_LINE_ID,
	SUBSTITUTION_TYPE,
	ACTUAL_SHIPPED_DTTM,
	DELIVERY_START_DTTM,
	PICK_LOCN_ASSIGN_TYPE,
	FREIGHT_REVENUE_CURRENCY_CODE,
	BUDG_COST_CURRENCY_CODE,
	ORDER_LINE_ID,
	ACTUAL_COST_CURRENCY_CODE,
	PRIORITY,
	SHELF_DAYS,
	COMMODITY_CLASS,
	LPN_SIZE,
	SIZE2_UOM_ID,
	CREATED_SOURCE,
	WEIGHT_UOM_ID,
	PURCHASE_ORDER_LINE_NUMBER,
	STORE_DEPT,
	LAST_UPDATED_DTTM,
	RECEIVED_WEIGHT,
	IS_EMERGENCY,
	SKU_SUB_CODE_VALUE,
	MO_LINE_ITEM_ID,
	UNIT_TAX_AMOUNT,
	CNTRY_OF_ORGN,
	ALLOC_TYPE,
	PICKUP_REFERENCE_NUMBER,
	WM_RECEIPT_ALLOCATED,
	ADJUSTED_ORDER_QTY,
	WAVE_PROC_TYPE,
	IS_STACKABLE,
	LAST_UPDATED_SOURCE,
	CRITCL_DIM_3,
	REPL_WAVE_RUN,
	UNIT_WT,
	RETAIL_PRICE,
	ORDER_QTY,
	MASTER_ORDER_ID,
	UNIT_PRICE_AMOUNT,
	REF_NUM1,
	REF_NUM3,
	DELIVERY_END_DTTM,
	REF_NUM2,
	REF_NUM5,
	REF_NUM4,
	ACTUAL_COST,
	PURCHASE_ORDER_NUMBER,
	REASON_CODE,
	ALLOCATION_SOURCE,
	DELIVERY_REFERENCE_NUMBER,
	SHIPPED_WEIGHT,
	UN_NUMBER_ID,
	VAS_PROCESS_TYPE,
	FULFILLMENT_TYPE,
	MERCH_TYPE,
	CRITCL_DIM_1,
	CRITCL_DIM_2,
	REPL_PROC_TYPE,
	CUBE_MULTIPLE_QTY,
	UNITS_PAKD,
	SINGLE_UNIT_FLAG,
	PLANNED_WEIGHT,
	SKU_GTIN,
	ORIG_BUDG_COST,
	STACK_DIAMETER_VALUE,
	IS_CHASE_CREATED_LINE,
	ORIG_ORDER_QTY,
	HIBERNATE_VERSION,
	PPACK_QTY,
	CUSTOM_TAG,
	LPN_BRK_ATTRIB,
	PACK_ZONE,
	BATCH_REQUIREMENT_TYPE,
	LOCKED,
	ALLOCATED_QTY,
	SIZE2_VALUE,
	ITEM_ID,
	ALLOCATION_SOURCE_ID,
	STACK_HEIGHT_STANDARD_UOM,
	RTS_LINE_ITEM_ID,
	HAS_ERRORS,
	TOTAL_MONETARY_VALUE,
	STD_PALLET_QTY,
	UNIT_MONETARY_VALUE,
	BUDG_COST,
	REF_BOOLEAN1,
	EXP_INFO_CODE,
	REF_BOOLEAN2,
	STD_SUB_PACK_QTY,
	HARD_ALLOC_REASON_CODE,
	RECEIVED_QTY,
	REFERENCE_LINE_ITEM_ID,
	PLANNED_VOLUME,
	CREATED_DTTM,
	CUSTOMER_ITEM,
	SHIPPED_VOLUME,
	REF_FIELD10,
	RECEIVED_SIZE2,
	RECEIVED_SIZE1,
	REF_FIELD1,
	REF_FIELD4,
	REF_FIELD5,
	REF_FIELD2,
	REF_FIELD3,
	PRE_RECEIPT_STATUS,
	REF_FIELD8,
	REF_FIELD9,
	REF_FIELD6,
	SKU_SUB_CODE_ID,
	TO_VARCHAR(REF_FIELD7) REF_FIELD7,
	RTS_ID,
	SIZE1_VALUE,
	IS_GIFT,
	SEGMENT_NAME,
	ITEM_ATTR_4,
	ITEM_ATTR_5,
	ITEM_ATTR_2,
	PRODUCT_CLASS_ID,
	ITEM_ATTR_3,
	SIZE1_UOM_ID,
	ITEM_ATTR_1,
	REPL_WAVE_NBR,
	LAST_UPDATED_SOURCE_TYPE,
	FREIGHT_REVENUE,
	PRICE,
	SKU_BREAK_ATTR,
	ALLOCATION_SOURCE_LINE_ID,
	STACK_RANK,
	BATCH_NBR,
	ASSORT_NBR,
	TC_COMPANY_ID,
	STD_LPN_QTY,
	CHUTE_ASSIGN_TYPE,
	PACKAGE_TYPE_ID,
	ORDER_CONSOL_ATTR,
	SHIPPED_QTY,
	EVENT_CODE,
	PROD_STAT,
	STACK_HEIGHT_VALUE,
	EFFECTIVE_RANK,
	STACK_WIDTH_STANDARD_UOM,
	SHIP_WAVE_NBR,
	STD_PACK_QTY,
	IS_CANCELLED,
	VOLUME_UOM_ID_BASE,
	RTL_TO_BE_DISTROED_QTY,
	QTY_CONV_FACTOR,
	PRICE_TKT_TYPE,
	PICKUP_END_DTTM,
	ORIGINAL_ORDERED_ITEM_ID,
	USER_CANCELED_QTY,
	MERCHANDIZING_DEPARTMENT_ID,
	SHIPPED_SIZE1,
	SHIPPED_SIZE2,
	VOLUME_UOM_ID,
	SERIAL_NUMBER_REQUIRED_FLAG,
    current_timestamp() as ARCHIVE_DTTM,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED
    
    FROM XBPRDWMSILVER.PRD_SILVER_D_XBDBTJ3WM.ORDER_LINE_ITEM
    WHERE ORDER_LINE_ITEM.LINE_ITEM_ID  NOT 
    IN (SELECT LINE_ITEM_ID FROM XBPRDWMSILVER.PRD_SILVER_GA_XBDBTJ3WM.ORDER_LINE_ITEM WHERE ORDER_LINE_ITEM.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE()))

UNION

SELECT 
    LINE_ITEM_ID,
	ORDER_ID,
	WEIGHT_UOM_ID_BASE,
	UNIT_COST,
	PPACK_GRP_CODE,
	ITEM_NAME,
	DO_DTL_STATUS,
	INTERNAL_ORDER_SEQ_NBR,
	BACK_ORD_REASON,
	STD_BUNDLE_QTY,
	COMMODITY_CODE_ID,
	PICK_LOCN_ID,
	REFERENCE_ORDER_ID,
	EXT_PURCHASE_ORDER,
	REF_SYSCODE1,
	REF_SYSCODE2,
	STACK_LENGTH_STANDARD_UOM,
	REF_SYSCODE3,
	TC_ORDER_LINE_ID,
	MINOR_ORDER_NBR,
	INTERNAL_ORDER_ID,
	RECEIVED_VOLUME,
	MV_SIZE_UOM_ID,
	EXT_SYS_LINE_ITEM_ID,
	GIFT_CARD_VALUE,
	MV_CURRENCY_CODE,
	UNIT_VOL,
	STACK_LENGTH_VALUE,
	PARTL_FILL,
	QTY_UOM_ID,
	IS_HAZMAT,
	STACK_DIAMETER_STANDARD_UOM,
	LPN_TYPE,
	CREATED_SOURCE_TYPE,
	PICKUP_START_DTTM,
	STACK_WIDTH_VALUE,
	STD_LPN_VOL,
	ALLOW_REVIVAL_RECEIPT_ALLOC,
	DESCRIPTION,
	MERCH_GRP,
	MANUFACTURING_DTTM,
	LINE_TYPE,
	PACK_RATE,
	WAVE_NBR,
	STD_LPN_WT,
	INVN_TYPE,
	PLANNED_SHIP_DATE,
	SUBSTITUTED_PARENT_LINE_ID,
	PROTECTION_LEVEL_ID,
	QTY_UOM_ID_BASE,
	PARENT_LINE_ITEM_ID,
	PALLET_TYPE,
	ALLOC_LINE_ID,
	SUBSTITUTION_TYPE,
	ACTUAL_SHIPPED_DTTM,
	DELIVERY_START_DTTM,
	PICK_LOCN_ASSIGN_TYPE,
	FREIGHT_REVENUE_CURRENCY_CODE,
	BUDG_COST_CURRENCY_CODE,
	ORDER_LINE_ID,
	ACTUAL_COST_CURRENCY_CODE,
	PRIORITY,
	SHELF_DAYS,
	COMMODITY_CLASS,
	LPN_SIZE,
	SIZE2_UOM_ID,
	CREATED_SOURCE,
	WEIGHT_UOM_ID,
	PURCHASE_ORDER_LINE_NUMBER,
	STORE_DEPT,
	LAST_UPDATED_DTTM,
	RECEIVED_WEIGHT,
	IS_EMERGENCY,
	SKU_SUB_CODE_VALUE,
	MO_LINE_ITEM_ID,
	UNIT_TAX_AMOUNT,
	CNTRY_OF_ORGN,
	ALLOC_TYPE,
	PICKUP_REFERENCE_NUMBER,
	WM_RECEIPT_ALLOCATED,
	ADJUSTED_ORDER_QTY,
	WAVE_PROC_TYPE,
	IS_STACKABLE,
	LAST_UPDATED_SOURCE,
	CRITCL_DIM_3,
	REPL_WAVE_RUN,
	UNIT_WT,
	RETAIL_PRICE,
	ORDER_QTY,
	MASTER_ORDER_ID,
	UNIT_PRICE_AMOUNT,
	REF_NUM1,
	REF_NUM3,
	DELIVERY_END_DTTM,
	REF_NUM2,
	REF_NUM5,
	REF_NUM4,
	ACTUAL_COST,
	PURCHASE_ORDER_NUMBER,
	REASON_CODE,
	ALLOCATION_SOURCE,
	DELIVERY_REFERENCE_NUMBER,
	SHIPPED_WEIGHT,
	UN_NUMBER_ID,
	VAS_PROCESS_TYPE,
	FULFILLMENT_TYPE,
	MERCH_TYPE,
	CRITCL_DIM_1,
	CRITCL_DIM_2,
	REPL_PROC_TYPE,
	CUBE_MULTIPLE_QTY,
	UNITS_PAKD,
	SINGLE_UNIT_FLAG,
	PLANNED_WEIGHT,
	SKU_GTIN,
	ORIG_BUDG_COST,
	STACK_DIAMETER_VALUE,
	IS_CHASE_CREATED_LINE,
	ORIG_ORDER_QTY,
	HIBERNATE_VERSION,
	PPACK_QTY,
	CUSTOM_TAG,
	LPN_BRK_ATTRIB,
	PACK_ZONE,
	BATCH_REQUIREMENT_TYPE,
	LOCKED,
	ALLOCATED_QTY,
	SIZE2_VALUE,
	ITEM_ID,
	ALLOCATION_SOURCE_ID,
	STACK_HEIGHT_STANDARD_UOM,
	RTS_LINE_ITEM_ID,
	HAS_ERRORS,
	TOTAL_MONETARY_VALUE,
	STD_PALLET_QTY,
	UNIT_MONETARY_VALUE,
	BUDG_COST,
	REF_BOOLEAN1,
	EXP_INFO_CODE,
	REF_BOOLEAN2,
	STD_SUB_PACK_QTY,
	HARD_ALLOC_REASON_CODE,
	RECEIVED_QTY,
	REFERENCE_LINE_ITEM_ID,
	PLANNED_VOLUME,
	CREATED_DTTM,
	CUSTOMER_ITEM,
	SHIPPED_VOLUME,
	REF_FIELD10,
	RECEIVED_SIZE2,
	RECEIVED_SIZE1,
	REF_FIELD1,
	REF_FIELD4,
	REF_FIELD5,
	REF_FIELD2,
	REF_FIELD3,
	PRE_RECEIPT_STATUS,
	REF_FIELD8,
	REF_FIELD9,
	REF_FIELD6,
	SKU_SUB_CODE_ID,
	TO_VARCHAR(REF_FIELD7) REF_FIELD7,
	RTS_ID,
	SIZE1_VALUE,
	IS_GIFT,
	SEGMENT_NAME,
	ITEM_ATTR_4,
	ITEM_ATTR_5,
	ITEM_ATTR_2,
	PRODUCT_CLASS_ID,
	ITEM_ATTR_3,
	SIZE1_UOM_ID,
	ITEM_ATTR_1,
	REPL_WAVE_NBR,
	LAST_UPDATED_SOURCE_TYPE,
	FREIGHT_REVENUE,
	PRICE,
	SKU_BREAK_ATTR,
	ALLOCATION_SOURCE_LINE_ID,
	STACK_RANK,
	BATCH_NBR,
	ASSORT_NBR,
	TC_COMPANY_ID,
	STD_LPN_QTY,
	CHUTE_ASSIGN_TYPE,
	PACKAGE_TYPE_ID,
	ORDER_CONSOL_ATTR,
	SHIPPED_QTY,
	EVENT_CODE,
	PROD_STAT,
	STACK_HEIGHT_VALUE,
	EFFECTIVE_RANK,
	STACK_WIDTH_STANDARD_UOM,
	SHIP_WAVE_NBR,
	STD_PACK_QTY,
	IS_CANCELLED,
	VOLUME_UOM_ID_BASE,
	RTL_TO_BE_DISTROED_QTY,
	QTY_CONV_FACTOR,
	PRICE_TKT_TYPE,
	PICKUP_END_DTTM,
	ORIGINAL_ORDERED_ITEM_ID,
	USER_CANCELED_QTY,
	MERCHANDIZING_DEPARTMENT_ID,
	SHIPPED_SIZE1,
	SHIPPED_SIZE2,
	VOLUME_UOM_ID,
	SERIAL_NUMBER_REQUIRED_FLAG,
    ARCHIVE_DTTM,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED
    FROM XBPRDARCHSILVER.ARCH_SILVER_C_XBWM19ARCH.ORDER_LINE_ITEM
    WHERE ORDER_LINE_ITEM.LINE_ITEM_ID  NOT 
    IN (SELECT LINE_ITEM_ID FROM XBPRDWMSILVER.PRD_SILVER_GA_XBDBTJ3WM.ORDER_LINE_ITEM WHERE ORDER_LINE_ITEM.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE()))
    AND ORDER_LINE_ITEM.LINE_ITEM_ID  NOT IN (SELECT LINE_ITEM_ID FROM XBPRDWMSILVER.PRD_SILVER_D_XBDBTJ3WM.ORDER_LINE_ITEM)
;

CREATE OR REPLACE TABLE ETL.RY_ARCH.ORDER_LINE_ITEM 
AS
    SELECT
	LINE_ITEM_ID,
	ORDER_ID,
	WEIGHT_UOM_ID_BASE,
	UNIT_COST,
	PPACK_GRP_CODE,
	ITEM_NAME,
	DO_DTL_STATUS,
	INTERNAL_ORDER_SEQ_NBR,
	BACK_ORD_REASON,
	STD_BUNDLE_QTY,
	COMMODITY_CODE_ID,
	PICK_LOCN_ID,
	REFERENCE_ORDER_ID,
	EXT_PURCHASE_ORDER,
	REF_SYSCODE1,
	REF_SYSCODE2,
	REF_SYSCODE3,
	STACK_LENGTH_STANDARD_UOM,
	TC_ORDER_LINE_ID,
	MINOR_ORDER_NBR,
	INTERNAL_ORDER_ID,
	RECEIVED_VOLUME,
	MV_SIZE_UOM_ID,
	EXT_SYS_LINE_ITEM_ID,
	GIFT_CARD_VALUE,
	UNIT_VOL,
	MV_CURRENCY_CODE,
	STACK_LENGTH_VALUE,
	PARTL_FILL,
	QTY_UOM_ID,
	IS_HAZMAT,
	STACK_DIAMETER_STANDARD_UOM,
	LPN_TYPE,
	CREATED_SOURCE_TYPE,
	PICKUP_START_DTTM,
	STACK_WIDTH_VALUE,
	ALLOW_REVIVAL_RECEIPT_ALLOC,
	STD_LPN_VOL,
	DESCRIPTION,
	MERCH_GRP,
	MANUFACTURING_DTTM,
	LINE_TYPE,
	PACK_RATE,
	WAVE_NBR,
	STD_LPN_WT,
	INVN_TYPE,
	SUBSTITUTED_PARENT_LINE_ID,
	PLANNED_SHIP_DATE,
	PROTECTION_LEVEL_ID,
	QTY_UOM_ID_BASE,
	PARENT_LINE_ITEM_ID,
	PALLET_TYPE,
	ALLOC_LINE_ID,
	SUBSTITUTION_TYPE,
	ACTUAL_SHIPPED_DTTM,
	DELIVERY_START_DTTM,
	PICK_LOCN_ASSIGN_TYPE,
	FREIGHT_REVENUE_CURRENCY_CODE,
	BUDG_COST_CURRENCY_CODE,
	ORDER_LINE_ID,
	ACTUAL_COST_CURRENCY_CODE,
	PRIORITY,
	SHELF_DAYS,
	COMMODITY_CLASS,
	LPN_SIZE,
	SIZE2_UOM_ID,
	CREATED_SOURCE,
	WEIGHT_UOM_ID,
	PURCHASE_ORDER_LINE_NUMBER,
	STORE_DEPT,
	LAST_UPDATED_DTTM,
	RECEIVED_WEIGHT,
	IS_EMERGENCY,
	SKU_SUB_CODE_VALUE,
	MO_LINE_ITEM_ID,
	CNTRY_OF_ORGN,
	UNIT_TAX_AMOUNT,
	ALLOC_TYPE,
	PICKUP_REFERENCE_NUMBER,
	WM_RECEIPT_ALLOCATED,
	ADJUSTED_ORDER_QTY,
	WAVE_PROC_TYPE,
	IS_STACKABLE,
	LAST_UPDATED_SOURCE,
	CRITCL_DIM_3,
	REPL_WAVE_RUN,
	UNIT_WT,
	RETAIL_PRICE,
	ORDER_QTY,
	MASTER_ORDER_ID,
	UNIT_PRICE_AMOUNT,
	REF_NUM1,
	REF_NUM3,
	DELIVERY_END_DTTM,
	REF_NUM2,
	REF_NUM5,
	REF_NUM4,
	ACTUAL_COST,
	PURCHASE_ORDER_NUMBER,
	REASON_CODE,
	ALLOCATION_SOURCE,
	DELIVERY_REFERENCE_NUMBER,
	SHIPPED_WEIGHT,
	UN_NUMBER_ID,
	VAS_PROCESS_TYPE,
	FULFILLMENT_TYPE,
	MERCH_TYPE,
	CRITCL_DIM_1,
	CRITCL_DIM_2,
	REPL_PROC_TYPE,
	CUBE_MULTIPLE_QTY,
	UNITS_PAKD,
	SINGLE_UNIT_FLAG,
	PLANNED_WEIGHT,
	SKU_GTIN,
	ORIG_BUDG_COST,
	STACK_DIAMETER_VALUE,
	IS_CHASE_CREATED_LINE,
	ORIG_ORDER_QTY,
	HIBERNATE_VERSION,
	PPACK_QTY,
	CUSTOM_TAG,
	LPN_BRK_ATTRIB,
	PACK_ZONE,
	LOCKED,
	BATCH_REQUIREMENT_TYPE,
	ALLOCATED_QTY,
	SIZE2_VALUE,
	ITEM_ID,
	ALLOCATION_SOURCE_ID,
	STACK_HEIGHT_STANDARD_UOM,
	RTS_LINE_ITEM_ID,
	HAS_ERRORS,
	STD_PALLET_QTY,
	TOTAL_MONETARY_VALUE,
	UNIT_MONETARY_VALUE,
	BUDG_COST,
	REF_BOOLEAN1,
	EXP_INFO_CODE,
	REF_BOOLEAN2,
	STD_SUB_PACK_QTY,
	HARD_ALLOC_REASON_CODE,
	RECEIVED_QTY,
	REFERENCE_LINE_ITEM_ID,
	PLANNED_VOLUME,
	CREATED_DTTM,
	CUSTOMER_ITEM,
	SHIPPED_VOLUME,
	REF_FIELD10,
	RECEIVED_SIZE2,
	RECEIVED_SIZE1,
	REF_FIELD1,
	REF_FIELD4,
	REF_FIELD5,
	REF_FIELD2,
	REF_FIELD3,
	PRE_RECEIPT_STATUS,
	REF_FIELD8,
	REF_FIELD9,
	REF_FIELD6,
	SKU_SUB_CODE_ID,
	REF_FIELD7,
	SIZE1_VALUE,
	RTS_ID,
	IS_GIFT,
	SEGMENT_NAME,
	ITEM_ATTR_4,
	ITEM_ATTR_5,
	ITEM_ATTR_2,
	PRODUCT_CLASS_ID,
	ITEM_ATTR_3,
	SIZE1_UOM_ID,
	REPL_WAVE_NBR,
	ITEM_ATTR_1,
	LAST_UPDATED_SOURCE_TYPE,
	FREIGHT_REVENUE,
	PRICE,
	SKU_BREAK_ATTR,
	ALLOCATION_SOURCE_LINE_ID,
	BATCH_NBR,
	STACK_RANK,
	ASSORT_NBR,
	TC_COMPANY_ID,
	STD_LPN_QTY,
	CHUTE_ASSIGN_TYPE,
	PACKAGE_TYPE_ID,
	ORDER_CONSOL_ATTR,
	SHIPPED_QTY,
	EVENT_CODE,
	PROD_STAT,
	STACK_HEIGHT_VALUE,
	EFFECTIVE_RANK,
	STACK_WIDTH_STANDARD_UOM,
	SHIP_WAVE_NBR,
	STD_PACK_QTY,
	IS_CANCELLED,
	VOLUME_UOM_ID_BASE,
	RTL_TO_BE_DISTROED_QTY,
	QTY_CONV_FACTOR,
	PRICE_TKT_TYPE,
	ORIGINAL_ORDERED_ITEM_ID,
	PICKUP_END_DTTM,
	USER_CANCELED_QTY,
	MERCHANDIZING_DEPARTMENT_ID,
	SHIPPED_SIZE1,
	SHIPPED_SIZE2,
	VOLUME_UOM_ID,
	SERIAL_NUMBER_REQUIRED_FLAG,
    current_timestamp() as ARCHIVE_DTTM,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED
    FROM XBPRDWMRY.PRD_RY_GA_XBORPRDWM.ORDER_LINE_ITEM
    WHERE ORDER_LINE_ITEM.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())

    UNION
    
    SELECT
	LINE_ITEM_ID,
	ORDER_ID,
	WEIGHT_UOM_ID_BASE,
	UNIT_COST,
	PPACK_GRP_CODE,
	ITEM_NAME,
	DO_DTL_STATUS,
	INTERNAL_ORDER_SEQ_NBR,
	BACK_ORD_REASON,
	STD_BUNDLE_QTY,
	COMMODITY_CODE_ID,
	PICK_LOCN_ID,
	REFERENCE_ORDER_ID,
	EXT_PURCHASE_ORDER,
	REF_SYSCODE1,
	REF_SYSCODE2,
	REF_SYSCODE3,
	STACK_LENGTH_STANDARD_UOM,
	TC_ORDER_LINE_ID,
	MINOR_ORDER_NBR,
	INTERNAL_ORDER_ID,
	RECEIVED_VOLUME,
	MV_SIZE_UOM_ID,
	EXT_SYS_LINE_ITEM_ID,
	GIFT_CARD_VALUE,
	UNIT_VOL,
	MV_CURRENCY_CODE,
	STACK_LENGTH_VALUE,
	PARTL_FILL,
	QTY_UOM_ID,
	IS_HAZMAT,
	STACK_DIAMETER_STANDARD_UOM,
	LPN_TYPE,
	CREATED_SOURCE_TYPE,
	PICKUP_START_DTTM,
	STACK_WIDTH_VALUE,
	ALLOW_REVIVAL_RECEIPT_ALLOC,
	STD_LPN_VOL,
	DESCRIPTION,
	MERCH_GRP,
	MANUFACTURING_DTTM,
	LINE_TYPE,
	PACK_RATE,
	WAVE_NBR,
	STD_LPN_WT,
	INVN_TYPE,
	SUBSTITUTED_PARENT_LINE_ID,
	PLANNED_SHIP_DATE,
	PROTECTION_LEVEL_ID,
	QTY_UOM_ID_BASE,
	PARENT_LINE_ITEM_ID,
	PALLET_TYPE,
	ALLOC_LINE_ID,
	SUBSTITUTION_TYPE,
	ACTUAL_SHIPPED_DTTM,
	DELIVERY_START_DTTM,
	PICK_LOCN_ASSIGN_TYPE,
	FREIGHT_REVENUE_CURRENCY_CODE,
	BUDG_COST_CURRENCY_CODE,
	ORDER_LINE_ID,
	ACTUAL_COST_CURRENCY_CODE,
	PRIORITY,
	SHELF_DAYS,
	COMMODITY_CLASS,
	LPN_SIZE,
	SIZE2_UOM_ID,
	CREATED_SOURCE,
	WEIGHT_UOM_ID,
	PURCHASE_ORDER_LINE_NUMBER,
	STORE_DEPT,
	LAST_UPDATED_DTTM,
	RECEIVED_WEIGHT,
	IS_EMERGENCY,
	SKU_SUB_CODE_VALUE,
	MO_LINE_ITEM_ID,
	CNTRY_OF_ORGN,
	UNIT_TAX_AMOUNT,
	ALLOC_TYPE,
	PICKUP_REFERENCE_NUMBER,
	WM_RECEIPT_ALLOCATED,
	ADJUSTED_ORDER_QTY,
	WAVE_PROC_TYPE,
	IS_STACKABLE,
	LAST_UPDATED_SOURCE,
	CRITCL_DIM_3,
	REPL_WAVE_RUN,
	UNIT_WT,
	RETAIL_PRICE,
	ORDER_QTY,
	MASTER_ORDER_ID,
	UNIT_PRICE_AMOUNT,
	REF_NUM1,
	REF_NUM3,
	DELIVERY_END_DTTM,
	REF_NUM2,
	REF_NUM5,
	REF_NUM4,
	ACTUAL_COST,
	PURCHASE_ORDER_NUMBER,
	REASON_CODE,
	ALLOCATION_SOURCE,
	DELIVERY_REFERENCE_NUMBER,
	SHIPPED_WEIGHT,
	UN_NUMBER_ID,
	VAS_PROCESS_TYPE,
	FULFILLMENT_TYPE,
	MERCH_TYPE,
	CRITCL_DIM_1,
	CRITCL_DIM_2,
	REPL_PROC_TYPE,
	CUBE_MULTIPLE_QTY,
	UNITS_PAKD,
	SINGLE_UNIT_FLAG,
	PLANNED_WEIGHT,
	SKU_GTIN,
	ORIG_BUDG_COST,
	STACK_DIAMETER_VALUE,
	IS_CHASE_CREATED_LINE,
	ORIG_ORDER_QTY,
	HIBERNATE_VERSION,
	PPACK_QTY,
	CUSTOM_TAG,
	LPN_BRK_ATTRIB,
	PACK_ZONE,
	LOCKED,
	BATCH_REQUIREMENT_TYPE,
	ALLOCATED_QTY,
	SIZE2_VALUE,
	ITEM_ID,
	ALLOCATION_SOURCE_ID,
	STACK_HEIGHT_STANDARD_UOM,
	RTS_LINE_ITEM_ID,
	HAS_ERRORS,
	STD_PALLET_QTY,
	TOTAL_MONETARY_VALUE,
	UNIT_MONETARY_VALUE,
	BUDG_COST,
	REF_BOOLEAN1,
	EXP_INFO_CODE,
	REF_BOOLEAN2,
	STD_SUB_PACK_QTY,
	HARD_ALLOC_REASON_CODE,
	RECEIVED_QTY,
	REFERENCE_LINE_ITEM_ID,
	PLANNED_VOLUME,
	CREATED_DTTM,
	CUSTOMER_ITEM,
	SHIPPED_VOLUME,
	REF_FIELD10,
	RECEIVED_SIZE2,
	RECEIVED_SIZE1,
	REF_FIELD1,
	REF_FIELD4,
	REF_FIELD5,
	REF_FIELD2,
	REF_FIELD3,
	PRE_RECEIPT_STATUS,
	REF_FIELD8,
	REF_FIELD9,
	REF_FIELD6,
	SKU_SUB_CODE_ID,
	REF_FIELD7,
	SIZE1_VALUE,
	RTS_ID,
	IS_GIFT,
	SEGMENT_NAME,
	ITEM_ATTR_4,
	ITEM_ATTR_5,
	ITEM_ATTR_2,
	PRODUCT_CLASS_ID,
	ITEM_ATTR_3,
	SIZE1_UOM_ID,
	REPL_WAVE_NBR,
	ITEM_ATTR_1,
	LAST_UPDATED_SOURCE_TYPE,
	FREIGHT_REVENUE,
	PRICE,
	SKU_BREAK_ATTR,
	ALLOCATION_SOURCE_LINE_ID,
	BATCH_NBR,
	STACK_RANK,
	ASSORT_NBR,
	TC_COMPANY_ID,
	STD_LPN_QTY,
	CHUTE_ASSIGN_TYPE,
	PACKAGE_TYPE_ID,
	ORDER_CONSOL_ATTR,
	SHIPPED_QTY,
	EVENT_CODE,
	PROD_STAT,
	STACK_HEIGHT_VALUE,
	EFFECTIVE_RANK,
	STACK_WIDTH_STANDARD_UOM,
	SHIP_WAVE_NBR,
	STD_PACK_QTY,
	IS_CANCELLED,
	VOLUME_UOM_ID_BASE,
	RTL_TO_BE_DISTROED_QTY,
	QTY_CONV_FACTOR,
	PRICE_TKT_TYPE,
	ORIGINAL_ORDERED_ITEM_ID,
	PICKUP_END_DTTM,
	USER_CANCELED_QTY,
	MERCHANDIZING_DEPARTMENT_ID,
	SHIPPED_SIZE1,
	SHIPPED_SIZE2,
	VOLUME_UOM_ID,
	SERIAL_NUMBER_REQUIRED_FLAG,
    current_timestamp() as ARCHIVE_DTTM,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED
    FROM XBPRDWMRY.PRD_RY_D_XBORPRDWM.ORDER_LINE_ITEM
    WHERE ORDER_LINE_ITEM.LINE_ITEM_ID  NOT 
    IN (SELECT LINE_ITEM_ID FROM XBPRDWMRY.PRD_RY_GA_XBORPRDWM.ORDER_LINE_ITEM WHERE ORDER_LINE_ITEM.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE()))
   
    UNION

    SELECT
	LINE_ITEM_ID,
	ORDER_ID,
	WEIGHT_UOM_ID_BASE,
	UNIT_COST,
	PPACK_GRP_CODE,
	ITEM_NAME,
	DO_DTL_STATUS,
	INTERNAL_ORDER_SEQ_NBR,
	BACK_ORD_REASON,
	STD_BUNDLE_QTY,
	COMMODITY_CODE_ID,
	PICK_LOCN_ID,
	REFERENCE_ORDER_ID,
	EXT_PURCHASE_ORDER,
	REF_SYSCODE1,
	REF_SYSCODE2,
	REF_SYSCODE3,
	STACK_LENGTH_STANDARD_UOM,
	TC_ORDER_LINE_ID,
	MINOR_ORDER_NBR,
	INTERNAL_ORDER_ID,
	RECEIVED_VOLUME,
	MV_SIZE_UOM_ID,
	EXT_SYS_LINE_ITEM_ID,
	GIFT_CARD_VALUE,
	UNIT_VOL,
	MV_CURRENCY_CODE,
	STACK_LENGTH_VALUE,
	PARTL_FILL,
	QTY_UOM_ID,
	IS_HAZMAT,
	STACK_DIAMETER_STANDARD_UOM,
	LPN_TYPE,
	CREATED_SOURCE_TYPE,
	PICKUP_START_DTTM,
	STACK_WIDTH_VALUE,
	ALLOW_REVIVAL_RECEIPT_ALLOC,
	STD_LPN_VOL,
	DESCRIPTION,
	MERCH_GRP,
	MANUFACTURING_DTTM,
	LINE_TYPE,
	PACK_RATE,
	WAVE_NBR,
	STD_LPN_WT,
	INVN_TYPE,
	SUBSTITUTED_PARENT_LINE_ID,
	PLANNED_SHIP_DATE,
	PROTECTION_LEVEL_ID,
	QTY_UOM_ID_BASE,
	PARENT_LINE_ITEM_ID,
	PALLET_TYPE,
	ALLOC_LINE_ID,
	SUBSTITUTION_TYPE,
	ACTUAL_SHIPPED_DTTM,
	DELIVERY_START_DTTM,
	PICK_LOCN_ASSIGN_TYPE,
	FREIGHT_REVENUE_CURRENCY_CODE,
	BUDG_COST_CURRENCY_CODE,
	ORDER_LINE_ID,
	ACTUAL_COST_CURRENCY_CODE,
	PRIORITY,
	SHELF_DAYS,
	COMMODITY_CLASS,
	LPN_SIZE,
	SIZE2_UOM_ID,
	CREATED_SOURCE,
	WEIGHT_UOM_ID,
	PURCHASE_ORDER_LINE_NUMBER,
	STORE_DEPT,
	LAST_UPDATED_DTTM,
	RECEIVED_WEIGHT,
	IS_EMERGENCY,
	SKU_SUB_CODE_VALUE,
	MO_LINE_ITEM_ID,
	CNTRY_OF_ORGN,
	UNIT_TAX_AMOUNT,
	ALLOC_TYPE,
	PICKUP_REFERENCE_NUMBER,
	WM_RECEIPT_ALLOCATED,
	ADJUSTED_ORDER_QTY,
	WAVE_PROC_TYPE,
	IS_STACKABLE,
	LAST_UPDATED_SOURCE,
	CRITCL_DIM_3,
	REPL_WAVE_RUN,
	UNIT_WT,
	RETAIL_PRICE,
	ORDER_QTY,
	MASTER_ORDER_ID,
	UNIT_PRICE_AMOUNT,
	REF_NUM1,
	REF_NUM3,
	DELIVERY_END_DTTM,
	REF_NUM2,
	REF_NUM5,
	REF_NUM4,
	ACTUAL_COST,
	PURCHASE_ORDER_NUMBER,
	REASON_CODE,
	ALLOCATION_SOURCE,
	DELIVERY_REFERENCE_NUMBER,
	SHIPPED_WEIGHT,
	UN_NUMBER_ID,
	VAS_PROCESS_TYPE,
	FULFILLMENT_TYPE,
	MERCH_TYPE,
	CRITCL_DIM_1,
	CRITCL_DIM_2,
	REPL_PROC_TYPE,
	CUBE_MULTIPLE_QTY,
	UNITS_PAKD,
	SINGLE_UNIT_FLAG,
	PLANNED_WEIGHT,
	SKU_GTIN,
	ORIG_BUDG_COST,
	STACK_DIAMETER_VALUE,
	IS_CHASE_CREATED_LINE,
	ORIG_ORDER_QTY,
	HIBERNATE_VERSION,
	PPACK_QTY,
	CUSTOM_TAG,
	LPN_BRK_ATTRIB,
	PACK_ZONE,
	LOCKED,
	BATCH_REQUIREMENT_TYPE,
	ALLOCATED_QTY,
	SIZE2_VALUE,
	ITEM_ID,
	ALLOCATION_SOURCE_ID,
	STACK_HEIGHT_STANDARD_UOM,
	RTS_LINE_ITEM_ID,
	HAS_ERRORS,
	STD_PALLET_QTY,
	TOTAL_MONETARY_VALUE,
	UNIT_MONETARY_VALUE,
	BUDG_COST,
	REF_BOOLEAN1,
	EXP_INFO_CODE,
	REF_BOOLEAN2,
	STD_SUB_PACK_QTY,
	HARD_ALLOC_REASON_CODE,
	RECEIVED_QTY,
	REFERENCE_LINE_ITEM_ID,
	PLANNED_VOLUME,
	CREATED_DTTM,
	CUSTOMER_ITEM,
	SHIPPED_VOLUME,
	REF_FIELD10,
	RECEIVED_SIZE2,
	RECEIVED_SIZE1,
	REF_FIELD1,
	REF_FIELD4,
	REF_FIELD5,
	REF_FIELD2,
	REF_FIELD3,
	PRE_RECEIPT_STATUS,
	REF_FIELD8,
	REF_FIELD9,
	REF_FIELD6,
	SKU_SUB_CODE_ID,
	REF_FIELD7,
	SIZE1_VALUE,
	RTS_ID,
	IS_GIFT,
	SEGMENT_NAME,
	ITEM_ATTR_4,
	ITEM_ATTR_5,
	ITEM_ATTR_2,
	PRODUCT_CLASS_ID,
	ITEM_ATTR_3,
	SIZE1_UOM_ID,
	REPL_WAVE_NBR,
	ITEM_ATTR_1,
	LAST_UPDATED_SOURCE_TYPE,
	FREIGHT_REVENUE,
	PRICE,
	SKU_BREAK_ATTR,
	ALLOCATION_SOURCE_LINE_ID,
	BATCH_NBR,
	STACK_RANK,
	ASSORT_NBR,
	TC_COMPANY_ID,
	STD_LPN_QTY,
	CHUTE_ASSIGN_TYPE,
	PACKAGE_TYPE_ID,
	ORDER_CONSOL_ATTR,
	SHIPPED_QTY,
	EVENT_CODE,
	PROD_STAT,
	STACK_HEIGHT_VALUE,
	EFFECTIVE_RANK,
	STACK_WIDTH_STANDARD_UOM,
	SHIP_WAVE_NBR,
	STD_PACK_QTY,
	IS_CANCELLED,
	VOLUME_UOM_ID_BASE,
	RTL_TO_BE_DISTROED_QTY,
	QTY_CONV_FACTOR,
	PRICE_TKT_TYPE,
	ORIGINAL_ORDERED_ITEM_ID,
	PICKUP_END_DTTM,
	USER_CANCELED_QTY,
	MERCHANDIZING_DEPARTMENT_ID,
	SHIPPED_SIZE1,
	SHIPPED_SIZE2,
	VOLUME_UOM_ID,
	SERIAL_NUMBER_REQUIRED_FLAG,
    ARCHIVE_DTTM,
	_FIVETRAN_DELETED,
	_FIVETRAN_SYNCED
    FROM XBPRDARCHREYNOSA.ARCHIVE_REYNOSA_XBORPRDARCH.ORDER_LINE_ITEM
    WHERE ORDER_LINE_ITEM.LINE_ITEM_ID  NOT 
    IN (SELECT LINE_ITEM_ID FROM XBPRDWMRY.PRD_RY_GA_XBORPRDWM.ORDER_LINE_ITEM WHERE ORDER_LINE_ITEM.CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE()))
    AND ORDER_LINE_ITEM.LINE_ITEM_ID  NOT IN (SELECT LINE_ITEM_ID FROM XBPRDWMRY.PRD_RY_D_XBORPRDWM.ORDER_LINE_ITEM)
    
    ;

-------------------------------------------------------------------------------------| SP_GOLD
SELECT * FROM ETL.silver_ARCH.ORDER_LINE_ITEM WHERE ARCHIVE_DTTM IS NULL;
CALL ETL.GOLD_ARCH.SP_UPDATE_ETL_ORDER_LINE_ITEM_GOLD();

CREATE OR REPLACE PROCEDURE ETL.GOLD_ARCH.SP_UPDATE_ETL_ORDER_LINE_ITEM_GOLD()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS 
    BEGIN
        MERGE INTO ETL.GOLD_ARCH.ORDER_LINE_ITEM AS target
            USING (
                SELECT *, current_timestamp() as ARCHIVE_DTTM
                FROM XBPRDWMGOLD.PRD_GOLD_GA_XBWM19WM.ORDER_LINE_ITEM
                WHERE CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())
            ) AS source
            ON target.LINE_ITEM_ID = source.LINE_ITEM_ID
            WHEN MATCHED AND target.LAST_UPDATED_DTTM < source.LAST_UPDATED_DTTM THEN
                UPDATE SET 
                    target.ORDER_ID = source.ORDER_ID,
                    target.WEIGHT_UOM_ID_BASE = source.WEIGHT_UOM_ID_BASE,
                    target.UNIT_COST = source.UNIT_COST,
                    target.PPACK_GRP_CODE = source.PPACK_GRP_CODE,
                    target.ITEM_NAME = source.ITEM_NAME,
                    target.DO_DTL_STATUS = source.DO_DTL_STATUS,
                    target.INTERNAL_ORDER_SEQ_NBR = source.INTERNAL_ORDER_SEQ_NBR,
                    target.BACK_ORD_REASON = source.BACK_ORD_REASON,
                    target.STD_BUNDLE_QTY = source.STD_BUNDLE_QTY,
                    target.COMMODITY_CODE_ID = source.COMMODITY_CODE_ID,
                    target.PICK_LOCN_ID = source.PICK_LOCN_ID,
                    target.REFERENCE_ORDER_ID = source.REFERENCE_ORDER_ID,
                    target.EXT_PURCHASE_ORDER = source.EXT_PURCHASE_ORDER,
                    target.REF_SYSCODE1 = source.REF_SYSCODE1,
                    target.REF_SYSCODE2 = source.REF_SYSCODE2,
                    target.REF_SYSCODE3 = source.REF_SYSCODE3,
                    target.STACK_LENGTH_STANDARD_UOM = source.STACK_LENGTH_STANDARD_UOM,
                    target.TC_ORDER_LINE_ID = source.TC_ORDER_LINE_ID,
                    target.MINOR_ORDER_NBR = source.MINOR_ORDER_NBR,
                    target.INTERNAL_ORDER_ID = source.INTERNAL_ORDER_ID,
                    target.RECEIVED_VOLUME = source.RECEIVED_VOLUME,
                    target.MV_SIZE_UOM_ID = source.MV_SIZE_UOM_ID,
                    target.EXT_SYS_LINE_ITEM_ID = source.EXT_SYS_LINE_ITEM_ID,
                    target.GIFT_CARD_VALUE = source.GIFT_CARD_VALUE,
                    target.UNIT_VOL = source.UNIT_VOL,
                    target.MV_CURRENCY_CODE = source.MV_CURRENCY_CODE,
                    target.STACK_LENGTH_VALUE = source.STACK_LENGTH_VALUE,
                    target.PARTL_FILL = source.PARTL_FILL,
                    target.QTY_UOM_ID = source.QTY_UOM_ID,
                    target.IS_HAZMAT = source.IS_HAZMAT,
                    target.STACK_DIAMETER_STANDARD_UOM = source.STACK_DIAMETER_STANDARD_UOM,
                    target.LPN_TYPE = source.LPN_TYPE,
                    target.CREATED_SOURCE_TYPE = source.CREATED_SOURCE_TYPE,
                    target.PICKUP_START_DTTM = source.PICKUP_START_DTTM,
                    target.STACK_WIDTH_VALUE = source.STACK_WIDTH_VALUE,
                    target.ALLOW_REVIVAL_RECEIPT_ALLOC = source.ALLOW_REVIVAL_RECEIPT_ALLOC,
                    target.STD_LPN_VOL = source.STD_LPN_VOL,
                    target.DESCRIPTION = source.DESCRIPTION,
                    target.MERCH_GRP = source.MERCH_GRP,
                    target.MANUFACTURING_DTTM = source.MANUFACTURING_DTTM,
                    target.LINE_TYPE = source.LINE_TYPE,
                    target.PACK_RATE = source.PACK_RATE,
                    target.WAVE_NBR = source.WAVE_NBR,
                    target.STD_LPN_WT = source.STD_LPN_WT,
                    target.INVN_TYPE = source.INVN_TYPE,
                    target.SUBSTITUTED_PARENT_LINE_ID = source.SUBSTITUTED_PARENT_LINE_ID,
                    target.PLANNED_SHIP_DATE = source.PLANNED_SHIP_DATE,
                    target.PROTECTION_LEVEL_ID = source.PROTECTION_LEVEL_ID,
                    target.QTY_UOM_ID_BASE = source.QTY_UOM_ID_BASE,
                    target.PARENT_LINE_ITEM_ID = source.PARENT_LINE_ITEM_ID,
                    target.PALLET_TYPE = source.PALLET_TYPE,
                    target.ALLOC_LINE_ID = source.ALLOC_LINE_ID,
                    target.SUBSTITUTION_TYPE = source.SUBSTITUTION_TYPE,
                    target.ACTUAL_SHIPPED_DTTM = source.ACTUAL_SHIPPED_DTTM,
                    target.DELIVERY_START_DTTM = source.DELIVERY_START_DTTM,
                    target.PICK_LOCN_ASSIGN_TYPE = source.PICK_LOCN_ASSIGN_TYPE,
                    target.FREIGHT_REVENUE_CURRENCY_CODE = source.FREIGHT_REVENUE_CURRENCY_CODE,
                    target.BUDG_COST_CURRENCY_CODE = source.BUDG_COST_CURRENCY_CODE,
                    target.ORDER_LINE_ID = source.ORDER_LINE_ID,
                    target.ACTUAL_COST_CURRENCY_CODE = source.ACTUAL_COST_CURRENCY_CODE,
                    target.PRIORITY = source.PRIORITY,
                    target.SHELF_DAYS = source.SHELF_DAYS,
                    target.COMMODITY_CLASS = source.COMMODITY_CLASS,
                    target.LPN_SIZE = source.LPN_SIZE,
                    target.SIZE2_UOM_ID = source.SIZE2_UOM_ID,
                    target.CREATED_SOURCE = source.CREATED_SOURCE,
                    target.WEIGHT_UOM_ID = source.WEIGHT_UOM_ID,
                    target.PURCHASE_ORDER_LINE_NUMBER = source.PURCHASE_ORDER_LINE_NUMBER,
                    target.STORE_DEPT = source.STORE_DEPT,
                    target.LAST_UPDATED_DTTM = source.LAST_UPDATED_DTTM,
                    target.RECEIVED_WEIGHT = source.RECEIVED_WEIGHT,
                    target.IS_EMERGENCY = source.IS_EMERGENCY,
                    target.SKU_SUB_CODE_VALUE = source.SKU_SUB_CODE_VALUE,
                    target.MO_LINE_ITEM_ID = source.MO_LINE_ITEM_ID,
                    target.CNTRY_OF_ORGN = source.CNTRY_OF_ORGN,
                    target.UNIT_TAX_AMOUNT = source.UNIT_TAX_AMOUNT,
                    target.ALLOC_TYPE = source.ALLOC_TYPE,
                    target.PICKUP_REFERENCE_NUMBER = source.PICKUP_REFERENCE_NUMBER,
                    target.WM_RECEIPT_ALLOCATED = source.WM_RECEIPT_ALLOCATED,
                    target.ADJUSTED_ORDER_QTY = source.ADJUSTED_ORDER_QTY,
                    target.WAVE_PROC_TYPE = source.WAVE_PROC_TYPE,
                    target.IS_STACKABLE = source.IS_STACKABLE,
                    target.LAST_UPDATED_SOURCE = source.LAST_UPDATED_SOURCE,
                    target.CRITCL_DIM_3 = source.CRITCL_DIM_3,
                    target.REPL_WAVE_RUN = source.REPL_WAVE_RUN,
                    target.UNIT_WT = source.UNIT_WT,
                    target.RETAIL_PRICE = source.RETAIL_PRICE,
                    target.ORDER_QTY = source.ORDER_QTY,
                    target.MASTER_ORDER_ID = source.MASTER_ORDER_ID,
                    target.UNIT_PRICE_AMOUNT = source.UNIT_PRICE_AMOUNT,
                    target.REF_NUM1 = source.REF_NUM1,
                    target.REF_NUM3 = source.REF_NUM3,
                    target.DELIVERY_END_DTTM = source.DELIVERY_END_DTTM,
                    target.REF_NUM2 = source.REF_NUM2,
                    target.REF_NUM5 = source.REF_NUM5,
                    target.REF_NUM4 = source.REF_NUM4,
                    target.ACTUAL_COST = source.ACTUAL_COST,
                    target.PURCHASE_ORDER_NUMBER = source.PURCHASE_ORDER_NUMBER,
                    target.REASON_CODE = source.REASON_CODE,
                    target.ALLOCATION_SOURCE = source.ALLOCATION_SOURCE,
                    target.DELIVERY_REFERENCE_NUMBER = source.DELIVERY_REFERENCE_NUMBER,
                    target.SHIPPED_WEIGHT = source.SHIPPED_WEIGHT,
                    target.UN_NUMBER_ID = source.UN_NUMBER_ID,
                    target.VAS_PROCESS_TYPE = source.VAS_PROCESS_TYPE,
                    target.FULFILLMENT_TYPE = source.FULFILLMENT_TYPE,
                    target.MERCH_TYPE = source.MERCH_TYPE,
                    target.CRITCL_DIM_1 = source.CRITCL_DIM_1,
                    target.CRITCL_DIM_2 = source.CRITCL_DIM_2,
                    target.REPL_PROC_TYPE = source.REPL_PROC_TYPE,
                    target.CUBE_MULTIPLE_QTY = source.CUBE_MULTIPLE_QTY,
                    target.UNITS_PAKD = source.UNITS_PAKD,
                    target.SINGLE_UNIT_FLAG = source.SINGLE_UNIT_FLAG,
                    target.PLANNED_WEIGHT = source.PLANNED_WEIGHT,
                    target.SKU_GTIN = source.SKU_GTIN,
                    target.ORIG_BUDG_COST = source.ORIG_BUDG_COST,
                    target.STACK_DIAMETER_VALUE = source.STACK_DIAMETER_VALUE,
                    target.IS_CHASE_CREATED_LINE = source.IS_CHASE_CREATED_LINE,
                    target.ORIG_ORDER_QTY = source.ORIG_ORDER_QTY,
                    target.HIBERNATE_VERSION = source.HIBERNATE_VERSION,
                    target.PPACK_QTY = source.PPACK_QTY,
                    target.CUSTOM_TAG = source.CUSTOM_TAG,
                    target.LPN_BRK_ATTRIB = source.LPN_BRK_ATTRIB,
                    target.PACK_ZONE = source.PACK_ZONE,
                    target.LOCKED = source.LOCKED,
                    target.BATCH_REQUIREMENT_TYPE = source.BATCH_REQUIREMENT_TYPE,
                    target.ALLOCATED_QTY = source.ALLOCATED_QTY,
                    target.SIZE2_VALUE = source.SIZE2_VALUE,
                    target.ITEM_ID = source.ITEM_ID,
                    target.ALLOCATION_SOURCE_ID = source.ALLOCATION_SOURCE_ID,
                    target.STACK_HEIGHT_STANDARD_UOM = source.STACK_HEIGHT_STANDARD_UOM,
                    target.RTS_LINE_ITEM_ID = source.RTS_LINE_ITEM_ID,
                    target.HAS_ERRORS = source.HAS_ERRORS,
                    target.STD_PALLET_QTY = source.STD_PALLET_QTY,
                    target.TOTAL_MONETARY_VALUE = source.TOTAL_MONETARY_VALUE,
                    target.UNIT_MONETARY_VALUE = source.UNIT_MONETARY_VALUE,
                    target.BUDG_COST = source.BUDG_COST,
                    target.REF_BOOLEAN1 = source.REF_BOOLEAN1,
                    target.EXP_INFO_CODE = source.EXP_INFO_CODE,
                    target.REF_BOOLEAN2 = source.REF_BOOLEAN2,
                    target.STD_SUB_PACK_QTY = source.STD_SUB_PACK_QTY,
                    target.HARD_ALLOC_REASON_CODE = source.HARD_ALLOC_REASON_CODE,
                    target.RECEIVED_QTY = source.RECEIVED_QTY,
                    target.REFERENCE_LINE_ITEM_ID = source.REFERENCE_LINE_ITEM_ID,
                    target.PLANNED_VOLUME = source.PLANNED_VOLUME,
                    target.CUSTOMER_ITEM = source.CUSTOMER_ITEM,
                    target.SHIPPED_VOLUME = source.SHIPPED_VOLUME,
                    target.REF_FIELD10 = source.REF_FIELD10,
                    target.RECEIVED_SIZE2 = source.RECEIVED_SIZE2,
                    target.RECEIVED_SIZE1 = source.RECEIVED_SIZE1,
                    target.REF_FIELD1 = source.REF_FIELD1,
                    target.REF_FIELD4 = source.REF_FIELD4,
                    target.REF_FIELD5 = source.REF_FIELD5,
                    target.REF_FIELD2 = source.REF_FIELD2,
                    target.REF_FIELD3 = source.REF_FIELD3,
                    target.PRE_RECEIPT_STATUS = source.PRE_RECEIPT_STATUS,
                    target.REF_FIELD8 = source.REF_FIELD8,
                    target.REF_FIELD9 = source.REF_FIELD9,
                    target.REF_FIELD6 = source.REF_FIELD6,
                    target.SKU_SUB_CODE_ID = source.SKU_SUB_CODE_ID,
                    target.REF_FIELD7 = source.REF_FIELD7,
                    target.SIZE1_VALUE = source.SIZE1_VALUE,
                    target.RTS_ID = source.RTS_ID,
                    target.IS_GIFT = source.IS_GIFT,
                    target.SEGMENT_NAME = source.SEGMENT_NAME,
                    target.ITEM_ATTR_4 = source.ITEM_ATTR_4,
                    target.ITEM_ATTR_5 = source.ITEM_ATTR_5,
                    target.ITEM_ATTR_2 = source.ITEM_ATTR_2,
                    target.PRODUCT_CLASS_ID = source.PRODUCT_CLASS_ID,
                    target.ITEM_ATTR_3 = source.ITEM_ATTR_3,
                    target.SIZE1_UOM_ID = source.SIZE1_UOM_ID,
                    target.REPL_WAVE_NBR = source.REPL_WAVE_NBR,
                    target.ITEM_ATTR_1 = source.ITEM_ATTR_1,
                    target.LAST_UPDATED_SOURCE_TYPE = source.LAST_UPDATED_SOURCE_TYPE,
                    target.FREIGHT_REVENUE = source.FREIGHT_REVENUE,
                    target.PRICE = source.PRICE,
                    target.SKU_BREAK_ATTR = source.SKU_BREAK_ATTR,
                    target.ALLOCATION_SOURCE_LINE_ID = source.ALLOCATION_SOURCE_LINE_ID,
                    target.BATCH_NBR = source.BATCH_NBR,
                    target.STACK_RANK = source.STACK_RANK,
                    target.ASSORT_NBR = source.ASSORT_NBR,
                    target.TC_COMPANY_ID = source.TC_COMPANY_ID,
                    target.STD_LPN_QTY = source.STD_LPN_QTY,
                    target.CHUTE_ASSIGN_TYPE = source.CHUTE_ASSIGN_TYPE,
                    target.PACKAGE_TYPE_ID = source.PACKAGE_TYPE_ID,
                    target.ORDER_CONSOL_ATTR = source.ORDER_CONSOL_ATTR,
                    target.SHIPPED_QTY = source.SHIPPED_QTY,
                    target.EVENT_CODE = source.EVENT_CODE,
                    target.PROD_STAT = source.PROD_STAT,
                    target.STACK_HEIGHT_VALUE = source.STACK_HEIGHT_VALUE,
                    target.EFFECTIVE_RANK = source.EFFECTIVE_RANK,
                    target.STACK_WIDTH_STANDARD_UOM = source.STACK_WIDTH_STANDARD_UOM,
                    target.SHIP_WAVE_NBR = source.SHIP_WAVE_NBR,
                    target.STD_PACK_QTY = source.STD_PACK_QTY,
                    target.IS_CANCELLED = source.IS_CANCELLED,
                    target.VOLUME_UOM_ID_BASE = source.VOLUME_UOM_ID_BASE,
                    target.RTL_TO_BE_DISTROED_QTY = source.RTL_TO_BE_DISTROED_QTY,
                    target.QTY_CONV_FACTOR = source.QTY_CONV_FACTOR,
                    target.PRICE_TKT_TYPE = source.PRICE_TKT_TYPE,
                    target.ORIGINAL_ORDERED_ITEM_ID = source.ORIGINAL_ORDERED_ITEM_ID,
                    target.PICKUP_END_DTTM = source.PICKUP_END_DTTM,
                    target.USER_CANCELED_QTY = source.USER_CANCELED_QTY,
                    target.MERCHANDIZING_DEPARTMENT_ID = source.MERCHANDIZING_DEPARTMENT_ID,
                    target.SHIPPED_SIZE1 = source.SHIPPED_SIZE1,
                    target.SHIPPED_SIZE2 = source.SHIPPED_SIZE2,
                    target.VOLUME_UOM_ID = source.VOLUME_UOM_ID,
                    target.SERIAL_NUMBER_REQUIRED_FLAG = source.SERIAL_NUMBER_REQUIRED_FLAG,
                    target.ARCHIVE_DTTM = source.ARCHIVE_DTTM,
                    target._FIVETRAN_DELETED = source._FIVETRAN_DELETED,
                    target._FIVETRAN_SYNCED = source._FIVETRAN_SYNCED
            WHEN NOT MATCHED THEN
                    INSERT (LINE_ITEM_ID, ORDER_ID, WEIGHT_UOM_ID_BASE, UNIT_COST, PPACK_GRP_CODE, ITEM_NAME, DO_DTL_STATUS, INTERNAL_ORDER_SEQ_NBR, BACK_ORD_REASON, STD_BUNDLE_QTY, COMMODITY_CODE_ID, PICK_LOCN_ID, REFERENCE_ORDER_ID, EXT_PURCHASE_ORDER, REF_SYSCODE1, REF_SYSCODE2, REF_SYSCODE3, STACK_LENGTH_STANDARD_UOM, TC_ORDER_LINE_ID, MINOR_ORDER_NBR, INTERNAL_ORDER_ID, RECEIVED_VOLUME, MV_SIZE_UOM_ID, EXT_SYS_LINE_ITEM_ID, GIFT_CARD_VALUE, UNIT_VOL, MV_CURRENCY_CODE, STACK_LENGTH_VALUE, PARTL_FILL, QTY_UOM_ID, IS_HAZMAT, STACK_DIAMETER_STANDARD_UOM, LPN_TYPE, CREATED_SOURCE_TYPE, PICKUP_START_DTTM, STACK_WIDTH_VALUE, ALLOW_REVIVAL_RECEIPT_ALLOC, STD_LPN_VOL, DESCRIPTION, MERCH_GRP, MANUFACTURING_DTTM, LINE_TYPE, PACK_RATE, WAVE_NBR, STD_LPN_WT, INVN_TYPE, SUBSTITUTED_PARENT_LINE_ID, PLANNED_SHIP_DATE, PROTECTION_LEVEL_ID, QTY_UOM_ID_BASE, PARENT_LINE_ITEM_ID, PALLET_TYPE, ALLOC_LINE_ID, SUBSTITUTION_TYPE, ACTUAL_SHIPPED_DTTM, DELIVERY_START_DTTM, PICK_LOCN_ASSIGN_TYPE, FREIGHT_REVENUE_CURRENCY_CODE, BUDG_COST_CURRENCY_CODE, ORDER_LINE_ID, ACTUAL_COST_CURRENCY_CODE, PRIORITY, SHELF_DAYS, COMMODITY_CLASS, LPN_SIZE, SIZE2_UOM_ID, CREATED_SOURCE, WEIGHT_UOM_ID, PURCHASE_ORDER_LINE_NUMBER, STORE_DEPT, LAST_UPDATED_DTTM, RECEIVED_WEIGHT, IS_EMERGENCY, SKU_SUB_CODE_VALUE, MO_LINE_ITEM_ID, CNTRY_OF_ORGN, UNIT_TAX_AMOUNT, ALLOC_TYPE, PICKUP_REFERENCE_NUMBER, WM_RECEIPT_ALLOCATED, ADJUSTED_ORDER_QTY, WAVE_PROC_TYPE, IS_STACKABLE, LAST_UPDATED_SOURCE, CRITCL_DIM_3, REPL_WAVE_RUN, UNIT_WT, RETAIL_PRICE, ORDER_QTY, MASTER_ORDER_ID, UNIT_PRICE_AMOUNT, REF_NUM1, REF_NUM3, DELIVERY_END_DTTM, REF_NUM2, REF_NUM5, REF_NUM4, ACTUAL_COST, PURCHASE_ORDER_NUMBER, REASON_CODE, ALLOCATION_SOURCE, DELIVERY_REFERENCE_NUMBER, SHIPPED_WEIGHT, UN_NUMBER_ID, VAS_PROCESS_TYPE, FULFILLMENT_TYPE, MERCH_TYPE, CRITCL_DIM_1, CRITCL_DIM_2, REPL_PROC_TYPE, CUBE_MULTIPLE_QTY, UNITS_PAKD, SINGLE_UNIT_FLAG, PLANNED_WEIGHT, SKU_GTIN, ORIG_BUDG_COST, STACK_DIAMETER_VALUE, IS_CHASE_CREATED_LINE, ORIG_ORDER_QTY, HIBERNATE_VERSION, PPACK_QTY, CUSTOM_TAG, LPN_BRK_ATTRIB, PACK_ZONE, LOCKED, BATCH_REQUIREMENT_TYPE, ALLOCATED_QTY, SIZE2_VALUE, ITEM_ID, ALLOCATION_SOURCE_ID, STACK_HEIGHT_STANDARD_UOM, RTS_LINE_ITEM_ID, HAS_ERRORS, STD_PALLET_QTY, TOTAL_MONETARY_VALUE, UNIT_MONETARY_VALUE, BUDG_COST, REF_BOOLEAN1, EXP_INFO_CODE, REF_BOOLEAN2, STD_SUB_PACK_QTY, HARD_ALLOC_REASON_CODE, RECEIVED_QTY, REFERENCE_LINE_ITEM_ID, PLANNED_VOLUME, CREATED_DTTM, CUSTOMER_ITEM, SHIPPED_VOLUME, REF_FIELD10, RECEIVED_SIZE2, RECEIVED_SIZE1, REF_FIELD1, REF_FIELD4, REF_FIELD5, REF_FIELD2, REF_FIELD3, PRE_RECEIPT_STATUS, REF_FIELD8, REF_FIELD9, REF_FIELD6, SKU_SUB_CODE_ID, REF_FIELD7, SIZE1_VALUE, RTS_ID, IS_GIFT, SEGMENT_NAME, ITEM_ATTR_4, ITEM_ATTR_5, ITEM_ATTR_2, PRODUCT_CLASS_ID, ITEM_ATTR_3, SIZE1_UOM_ID, REPL_WAVE_NBR, ITEM_ATTR_1, LAST_UPDATED_SOURCE_TYPE, FREIGHT_REVENUE, PRICE, SKU_BREAK_ATTR, ALLOCATION_SOURCE_LINE_ID, BATCH_NBR, STACK_RANK, ASSORT_NBR, TC_COMPANY_ID, STD_LPN_QTY, CHUTE_ASSIGN_TYPE, PACKAGE_TYPE_ID, ORDER_CONSOL_ATTR, SHIPPED_QTY, EVENT_CODE, PROD_STAT, STACK_HEIGHT_VALUE, EFFECTIVE_RANK, STACK_WIDTH_STANDARD_UOM, SHIP_WAVE_NBR, STD_PACK_QTY, IS_CANCELLED, VOLUME_UOM_ID_BASE, RTL_TO_BE_DISTROED_QTY, QTY_CONV_FACTOR, PRICE_TKT_TYPE, ORIGINAL_ORDERED_ITEM_ID, PICKUP_END_DTTM, USER_CANCELED_QTY, MERCHANDIZING_DEPARTMENT_ID, SHIPPED_SIZE1, SHIPPED_SIZE2, VOLUME_UOM_ID, SERIAL_NUMBER_REQUIRED_FLAG, ARCHIVE_DTTM, _FIVETRAN_DELETED, _FIVETRAN_SYNCED)
                    VALUES (source.LINE_ITEM_ID, source.ORDER_ID, source.WEIGHT_UOM_ID_BASE, source.UNIT_COST, source.PPACK_GRP_CODE, source.ITEM_NAME, source.DO_DTL_STATUS, source.INTERNAL_ORDER_SEQ_NBR, source.BACK_ORD_REASON, source.STD_BUNDLE_QTY, source.COMMODITY_CODE_ID, source.PICK_LOCN_ID, source.REFERENCE_ORDER_ID, source.EXT_PURCHASE_ORDER, source.REF_SYSCODE1, source.REF_SYSCODE2, source.REF_SYSCODE3, source.STACK_LENGTH_STANDARD_UOM, source.TC_ORDER_LINE_ID, source.MINOR_ORDER_NBR, source.INTERNAL_ORDER_ID, source.RECEIVED_VOLUME, source.MV_SIZE_UOM_ID, source.EXT_SYS_LINE_ITEM_ID, source.GIFT_CARD_VALUE, source.UNIT_VOL, source.MV_CURRENCY_CODE, source.STACK_LENGTH_VALUE, source.PARTL_FILL, source.QTY_UOM_ID, source.IS_HAZMAT, source.STACK_DIAMETER_STANDARD_UOM, source.LPN_TYPE, source.CREATED_SOURCE_TYPE, source.PICKUP_START_DTTM, source.STACK_WIDTH_VALUE, source.ALLOW_REVIVAL_RECEIPT_ALLOC, source.STD_LPN_VOL, source.DESCRIPTION, source.MERCH_GRP, source.MANUFACTURING_DTTM, source.LINE_TYPE, source.PACK_RATE, source.WAVE_NBR, source.STD_LPN_WT, source.INVN_TYPE, source.SUBSTITUTED_PARENT_LINE_ID, source.PLANNED_SHIP_DATE, source.PROTECTION_LEVEL_ID, source.QTY_UOM_ID_BASE, source.PARENT_LINE_ITEM_ID, source.PALLET_TYPE, source.ALLOC_LINE_ID, source.SUBSTITUTION_TYPE, source.ACTUAL_SHIPPED_DTTM, source.DELIVERY_START_DTTM, source.PICK_LOCN_ASSIGN_TYPE, source.FREIGHT_REVENUE_CURRENCY_CODE, source.BUDG_COST_CURRENCY_CODE, source.ORDER_LINE_ID, source.ACTUAL_COST_CURRENCY_CODE, source.PRIORITY, source.SHELF_DAYS, source.COMMODITY_CLASS, source.LPN_SIZE, source.SIZE2_UOM_ID, source.CREATED_SOURCE, source.WEIGHT_UOM_ID, source.PURCHASE_ORDER_LINE_NUMBER, source.STORE_DEPT, source.LAST_UPDATED_DTTM, source.RECEIVED_WEIGHT, source.IS_EMERGENCY, source.SKU_SUB_CODE_VALUE, source.MO_LINE_ITEM_ID, source.CNTRY_OF_ORGN, source.UNIT_TAX_AMOUNT, source.ALLOC_TYPE, source.PICKUP_REFERENCE_NUMBER, source.WM_RECEIPT_ALLOCATED, source.ADJUSTED_ORDER_QTY, source.WAVE_PROC_TYPE, source.IS_STACKABLE, source.LAST_UPDATED_SOURCE, source.CRITCL_DIM_3, source.REPL_WAVE_RUN, source.UNIT_WT, source.RETAIL_PRICE, source.ORDER_QTY, source.MASTER_ORDER_ID, source.UNIT_PRICE_AMOUNT, source.REF_NUM1, source.REF_NUM3, source.DELIVERY_END_DTTM, source.REF_NUM2, source.REF_NUM5, source.REF_NUM4, source.ACTUAL_COST, source.PURCHASE_ORDER_NUMBER, source.REASON_CODE, source.ALLOCATION_SOURCE, source.DELIVERY_REFERENCE_NUMBER, source.SHIPPED_WEIGHT, source.UN_NUMBER_ID, source.VAS_PROCESS_TYPE, source.FULFILLMENT_TYPE, source.MERCH_TYPE, source.CRITCL_DIM_1, source.CRITCL_DIM_2, source.REPL_PROC_TYPE, source.CUBE_MULTIPLE_QTY, source.UNITS_PAKD, source.SINGLE_UNIT_FLAG, source.PLANNED_WEIGHT, source.SKU_GTIN, source.ORIG_BUDG_COST, source.STACK_DIAMETER_VALUE, source.IS_CHASE_CREATED_LINE, source.ORIG_ORDER_QTY, source.HIBERNATE_VERSION, source.PPACK_QTY, source.CUSTOM_TAG, source.LPN_BRK_ATTRIB, source.PACK_ZONE, source.LOCKED, source.BATCH_REQUIREMENT_TYPE, source.ALLOCATED_QTY, source.SIZE2_VALUE, source.ITEM_ID, source.ALLOCATION_SOURCE_ID, source.STACK_HEIGHT_STANDARD_UOM, source.RTS_LINE_ITEM_ID, source.HAS_ERRORS, source.STD_PALLET_QTY, source.TOTAL_MONETARY_VALUE, source.UNIT_MONETARY_VALUE, source.BUDG_COST, source.REF_BOOLEAN1, source.EXP_INFO_CODE, source.REF_BOOLEAN2, source.STD_SUB_PACK_QTY, source.HARD_ALLOC_REASON_CODE, source.RECEIVED_QTY, source.REFERENCE_LINE_ITEM_ID, source.PLANNED_VOLUME, source.CREATED_DTTM, source.CUSTOMER_ITEM, source.SHIPPED_VOLUME, source.REF_FIELD10, source.RECEIVED_SIZE2, source.RECEIVED_SIZE1, source.REF_FIELD1, source.REF_FIELD4, source.REF_FIELD5, source.REF_FIELD2, source.REF_FIELD3, source.PRE_RECEIPT_STATUS, source.REF_FIELD8, source.REF_FIELD9, source.REF_FIELD6, source.SKU_SUB_CODE_ID, source.REF_FIELD7, source.SIZE1_VALUE, source.RTS_ID, source.IS_GIFT, source.SEGMENT_NAME, source.ITEM_ATTR_4, source.ITEM_ATTR_5, source.ITEM_ATTR_2, source.PRODUCT_CLASS_ID, source.ITEM_ATTR_3, source.SIZE1_UOM_ID, source.REPL_WAVE_NBR, source.ITEM_ATTR_1, source.LAST_UPDATED_SOURCE_TYPE, source.FREIGHT_REVENUE, source.PRICE, source.SKU_BREAK_ATTR, source.ALLOCATION_SOURCE_LINE_ID, source.BATCH_NBR, source.STACK_RANK, source.ASSORT_NBR, source.TC_COMPANY_ID, source.STD_LPN_QTY, source.CHUTE_ASSIGN_TYPE, source.PACKAGE_TYPE_ID, source.ORDER_CONSOL_ATTR, source.SHIPPED_QTY, source.EVENT_CODE, source.PROD_STAT, source.STACK_HEIGHT_VALUE, source.EFFECTIVE_RANK, source.STACK_WIDTH_STANDARD_UOM, source.SHIP_WAVE_NBR, source.STD_PACK_QTY, source.IS_CANCELLED, source.VOLUME_UOM_ID_BASE, source.RTL_TO_BE_DISTROED_QTY, source.QTY_CONV_FACTOR, source.PRICE_TKT_TYPE, source.ORIGINAL_ORDERED_ITEM_ID, source.PICKUP_END_DTTM, source.USER_CANCELED_QTY, source.MERCHANDIZING_DEPARTMENT_ID, source.SHIPPED_SIZE1, source.SHIPPED_SIZE2, source.VOLUME_UOM_ID, source.SERIAL_NUMBER_REQUIRED_FLAG, current_timestamp(), source._FIVETRAN_DELETED, source._FIVETRAN_SYNCED);
            RETURN 'SUCCESS';
END;


-------------------------------------------------------------------------------------| SP_SILVER
CALL ETL.SILVER_ARCH.SP_UPDATE_ETL_ORDER_LINE_ITEM_SILVER();
CREATE OR REPLACE PROCEDURE ETL.SILVER_ARCH.SP_UPDATE_ETL_ORDER_LINE_ITEM_SILVER()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS 
    BEGIN
        MERGE INTO ETL.SILVER_ARCH.ORDER_LINE_ITEM AS target
            USING (
                SELECT *, current_timestamp() as ARCHIVE_DTTM
                FROM XBPRDWMSILVER.PRD_SILVER_GA_XBDBTJ3WM.ORDER_LINE_ITEM
                WHERE CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())
            ) AS source
            ON target.LINE_ITEM_ID = source.LINE_ITEM_ID
            WHEN MATCHED AND target.LAST_UPDATED_DTTM < source.LAST_UPDATED_DTTM THEN
                UPDATE SET 
                    target.ORDER_ID = source.ORDER_ID,
                    target.WEIGHT_UOM_ID_BASE = source.WEIGHT_UOM_ID_BASE,
                    target.UNIT_COST = source.UNIT_COST,
                    target.PPACK_GRP_CODE = source.PPACK_GRP_CODE,
                    target.ITEM_NAME = source.ITEM_NAME,
                    target.DO_DTL_STATUS = source.DO_DTL_STATUS,
                    target.INTERNAL_ORDER_SEQ_NBR = source.INTERNAL_ORDER_SEQ_NBR,
                    target.BACK_ORD_REASON = source.BACK_ORD_REASON,
                    target.STD_BUNDLE_QTY = source.STD_BUNDLE_QTY,
                    target.COMMODITY_CODE_ID = source.COMMODITY_CODE_ID,
                    target.PICK_LOCN_ID = source.PICK_LOCN_ID,
                    target.REFERENCE_ORDER_ID = source.REFERENCE_ORDER_ID,
                    target.EXT_PURCHASE_ORDER = source.EXT_PURCHASE_ORDER,
                    target.REF_SYSCODE1 = source.REF_SYSCODE1,
                    target.REF_SYSCODE2 = source.REF_SYSCODE2,
                    target.REF_SYSCODE3 = source.REF_SYSCODE3,
                    target.STACK_LENGTH_STANDARD_UOM = source.STACK_LENGTH_STANDARD_UOM,
                    target.TC_ORDER_LINE_ID = source.TC_ORDER_LINE_ID,
                    target.MINOR_ORDER_NBR = source.MINOR_ORDER_NBR,
                    target.INTERNAL_ORDER_ID = source.INTERNAL_ORDER_ID,
                    target.RECEIVED_VOLUME = source.RECEIVED_VOLUME,
                    target.MV_SIZE_UOM_ID = source.MV_SIZE_UOM_ID,
                    target.EXT_SYS_LINE_ITEM_ID = source.EXT_SYS_LINE_ITEM_ID,
                    target.GIFT_CARD_VALUE = source.GIFT_CARD_VALUE,
                    target.UNIT_VOL = source.UNIT_VOL,
                    target.MV_CURRENCY_CODE = source.MV_CURRENCY_CODE,
                    target.STACK_LENGTH_VALUE = source.STACK_LENGTH_VALUE,
                    target.PARTL_FILL = source.PARTL_FILL,
                    target.QTY_UOM_ID = source.QTY_UOM_ID,
                    target.IS_HAZMAT = source.IS_HAZMAT,
                    target.STACK_DIAMETER_STANDARD_UOM = source.STACK_DIAMETER_STANDARD_UOM,
                    target.LPN_TYPE = source.LPN_TYPE,
                    target.CREATED_SOURCE_TYPE = source.CREATED_SOURCE_TYPE,
                    target.PICKUP_START_DTTM = source.PICKUP_START_DTTM,
                    target.STACK_WIDTH_VALUE = source.STACK_WIDTH_VALUE,
                    target.ALLOW_REVIVAL_RECEIPT_ALLOC = source.ALLOW_REVIVAL_RECEIPT_ALLOC,
                    target.STD_LPN_VOL = source.STD_LPN_VOL,
                    target.DESCRIPTION = source.DESCRIPTION,
                    target.MERCH_GRP = source.MERCH_GRP,
                    target.MANUFACTURING_DTTM = source.MANUFACTURING_DTTM,
                    target.LINE_TYPE = source.LINE_TYPE,
                    target.PACK_RATE = source.PACK_RATE,
                    target.WAVE_NBR = source.WAVE_NBR,
                    target.STD_LPN_WT = source.STD_LPN_WT,
                    target.INVN_TYPE = source.INVN_TYPE,
                    target.SUBSTITUTED_PARENT_LINE_ID = source.SUBSTITUTED_PARENT_LINE_ID,
                    target.PLANNED_SHIP_DATE = source.PLANNED_SHIP_DATE,
                    target.PROTECTION_LEVEL_ID = source.PROTECTION_LEVEL_ID,
                    target.QTY_UOM_ID_BASE = source.QTY_UOM_ID_BASE,
                    target.PARENT_LINE_ITEM_ID = source.PARENT_LINE_ITEM_ID,
                    target.PALLET_TYPE = source.PALLET_TYPE,
                    target.ALLOC_LINE_ID = source.ALLOC_LINE_ID,
                    target.SUBSTITUTION_TYPE = source.SUBSTITUTION_TYPE,
                    target.ACTUAL_SHIPPED_DTTM = source.ACTUAL_SHIPPED_DTTM,
                    target.DELIVERY_START_DTTM = source.DELIVERY_START_DTTM,
                    target.PICK_LOCN_ASSIGN_TYPE = source.PICK_LOCN_ASSIGN_TYPE,
                    target.FREIGHT_REVENUE_CURRENCY_CODE = source.FREIGHT_REVENUE_CURRENCY_CODE,
                    target.BUDG_COST_CURRENCY_CODE = source.BUDG_COST_CURRENCY_CODE,
                    target.ORDER_LINE_ID = source.ORDER_LINE_ID,
                    target.ACTUAL_COST_CURRENCY_CODE = source.ACTUAL_COST_CURRENCY_CODE,
                    target.PRIORITY = source.PRIORITY,
                    target.SHELF_DAYS = source.SHELF_DAYS,
                    target.COMMODITY_CLASS = source.COMMODITY_CLASS,
                    target.LPN_SIZE = source.LPN_SIZE,
                    target.SIZE2_UOM_ID = source.SIZE2_UOM_ID,
                    target.CREATED_SOURCE = source.CREATED_SOURCE,
                    target.WEIGHT_UOM_ID = source.WEIGHT_UOM_ID,
                    target.PURCHASE_ORDER_LINE_NUMBER = source.PURCHASE_ORDER_LINE_NUMBER,
                    target.STORE_DEPT = source.STORE_DEPT,
                    target.LAST_UPDATED_DTTM = source.LAST_UPDATED_DTTM,
                    target.RECEIVED_WEIGHT = source.RECEIVED_WEIGHT,
                    target.IS_EMERGENCY = source.IS_EMERGENCY,
                    target.SKU_SUB_CODE_VALUE = source.SKU_SUB_CODE_VALUE,
                    target.MO_LINE_ITEM_ID = source.MO_LINE_ITEM_ID,
                    target.CNTRY_OF_ORGN = source.CNTRY_OF_ORGN,
                    target.UNIT_TAX_AMOUNT = source.UNIT_TAX_AMOUNT,
                    target.ALLOC_TYPE = source.ALLOC_TYPE,
                    target.PICKUP_REFERENCE_NUMBER = source.PICKUP_REFERENCE_NUMBER,
                    target.WM_RECEIPT_ALLOCATED = source.WM_RECEIPT_ALLOCATED,
                    target.ADJUSTED_ORDER_QTY = source.ADJUSTED_ORDER_QTY,
                    target.WAVE_PROC_TYPE = source.WAVE_PROC_TYPE,
                    target.IS_STACKABLE = source.IS_STACKABLE,
                    target.LAST_UPDATED_SOURCE = source.LAST_UPDATED_SOURCE,
                    target.CRITCL_DIM_3 = source.CRITCL_DIM_3,
                    target.REPL_WAVE_RUN = source.REPL_WAVE_RUN,
                    target.UNIT_WT = source.UNIT_WT,
                    target.RETAIL_PRICE = source.RETAIL_PRICE,
                    target.ORDER_QTY = source.ORDER_QTY,
                    target.MASTER_ORDER_ID = source.MASTER_ORDER_ID,
                    target.UNIT_PRICE_AMOUNT = source.UNIT_PRICE_AMOUNT,
                    target.REF_NUM1 = source.REF_NUM1,
                    target.REF_NUM3 = source.REF_NUM3,
                    target.DELIVERY_END_DTTM = source.DELIVERY_END_DTTM,
                    target.REF_NUM2 = source.REF_NUM2,
                    target.REF_NUM5 = source.REF_NUM5,
                    target.REF_NUM4 = source.REF_NUM4,
                    target.ACTUAL_COST = source.ACTUAL_COST,
                    target.PURCHASE_ORDER_NUMBER = source.PURCHASE_ORDER_NUMBER,
                    target.REASON_CODE = source.REASON_CODE,
                    target.ALLOCATION_SOURCE = source.ALLOCATION_SOURCE,
                    target.DELIVERY_REFERENCE_NUMBER = source.DELIVERY_REFERENCE_NUMBER,
                    target.SHIPPED_WEIGHT = source.SHIPPED_WEIGHT,
                    target.UN_NUMBER_ID = source.UN_NUMBER_ID,
                    target.VAS_PROCESS_TYPE = source.VAS_PROCESS_TYPE,
                    target.FULFILLMENT_TYPE = source.FULFILLMENT_TYPE,
                    target.MERCH_TYPE = source.MERCH_TYPE,
                    target.CRITCL_DIM_1 = source.CRITCL_DIM_1,
                    target.CRITCL_DIM_2 = source.CRITCL_DIM_2,
                    target.REPL_PROC_TYPE = source.REPL_PROC_TYPE,
                    target.CUBE_MULTIPLE_QTY = source.CUBE_MULTIPLE_QTY,
                    target.UNITS_PAKD = source.UNITS_PAKD,
                    target.SINGLE_UNIT_FLAG = source.SINGLE_UNIT_FLAG,
                    target.PLANNED_WEIGHT = source.PLANNED_WEIGHT,
                    target.SKU_GTIN = source.SKU_GTIN,
                    target.ORIG_BUDG_COST = source.ORIG_BUDG_COST,
                    target.STACK_DIAMETER_VALUE = source.STACK_DIAMETER_VALUE,
                    target.IS_CHASE_CREATED_LINE = source.IS_CHASE_CREATED_LINE,
                    target.ORIG_ORDER_QTY = source.ORIG_ORDER_QTY,
                    target.HIBERNATE_VERSION = source.HIBERNATE_VERSION,
                    target.PPACK_QTY = source.PPACK_QTY,
                    target.CUSTOM_TAG = source.CUSTOM_TAG,
                    target.LPN_BRK_ATTRIB = source.LPN_BRK_ATTRIB,
                    target.PACK_ZONE = source.PACK_ZONE,
                    target.LOCKED = source.LOCKED,
                    target.BATCH_REQUIREMENT_TYPE = source.BATCH_REQUIREMENT_TYPE,
                    target.ALLOCATED_QTY = source.ALLOCATED_QTY,
                    target.SIZE2_VALUE = source.SIZE2_VALUE,
                    target.ITEM_ID = source.ITEM_ID,
                    target.ALLOCATION_SOURCE_ID = source.ALLOCATION_SOURCE_ID,
                    target.STACK_HEIGHT_STANDARD_UOM = source.STACK_HEIGHT_STANDARD_UOM,
                    target.RTS_LINE_ITEM_ID = source.RTS_LINE_ITEM_ID,
                    target.HAS_ERRORS = source.HAS_ERRORS,
                    target.STD_PALLET_QTY = source.STD_PALLET_QTY,
                    target.TOTAL_MONETARY_VALUE = source.TOTAL_MONETARY_VALUE,
                    target.UNIT_MONETARY_VALUE = source.UNIT_MONETARY_VALUE,
                    target.BUDG_COST = source.BUDG_COST,
                    target.REF_BOOLEAN1 = source.REF_BOOLEAN1,
                    target.EXP_INFO_CODE = source.EXP_INFO_CODE,
                    target.REF_BOOLEAN2 = source.REF_BOOLEAN2,
                    target.STD_SUB_PACK_QTY = source.STD_SUB_PACK_QTY,
                    target.HARD_ALLOC_REASON_CODE = source.HARD_ALLOC_REASON_CODE,
                    target.RECEIVED_QTY = source.RECEIVED_QTY,
                    target.REFERENCE_LINE_ITEM_ID = source.REFERENCE_LINE_ITEM_ID,
                    target.PLANNED_VOLUME = source.PLANNED_VOLUME,
                    target.CUSTOMER_ITEM = source.CUSTOMER_ITEM,
                    target.SHIPPED_VOLUME = source.SHIPPED_VOLUME,
                    target.REF_FIELD10 = source.REF_FIELD10,
                    target.RECEIVED_SIZE2 = source.RECEIVED_SIZE2,
                    target.RECEIVED_SIZE1 = source.RECEIVED_SIZE1,
                    target.REF_FIELD1 = source.REF_FIELD1,
                    target.REF_FIELD4 = source.REF_FIELD4,
                    target.REF_FIELD5 = source.REF_FIELD5,
                    target.REF_FIELD2 = source.REF_FIELD2,
                    target.REF_FIELD3 = source.REF_FIELD3,
                    target.PRE_RECEIPT_STATUS = source.PRE_RECEIPT_STATUS,
                    target.REF_FIELD8 = source.REF_FIELD8,
                    target.REF_FIELD9 = source.REF_FIELD9,
                    target.REF_FIELD6 = source.REF_FIELD6,
                    target.SKU_SUB_CODE_ID = source.SKU_SUB_CODE_ID,
                    target.REF_FIELD7 = source.REF_FIELD7,
                    target.SIZE1_VALUE = source.SIZE1_VALUE,
                    target.RTS_ID = source.RTS_ID,
                    target.IS_GIFT = source.IS_GIFT,
                    target.SEGMENT_NAME = source.SEGMENT_NAME,
                    target.ITEM_ATTR_4 = source.ITEM_ATTR_4,
                    target.ITEM_ATTR_5 = source.ITEM_ATTR_5,
                    target.ITEM_ATTR_2 = source.ITEM_ATTR_2,
                    target.PRODUCT_CLASS_ID = source.PRODUCT_CLASS_ID,
                    target.ITEM_ATTR_3 = source.ITEM_ATTR_3,
                    target.SIZE1_UOM_ID = source.SIZE1_UOM_ID,
                    target.REPL_WAVE_NBR = source.REPL_WAVE_NBR,
                    target.ITEM_ATTR_1 = source.ITEM_ATTR_1,
                    target.LAST_UPDATED_SOURCE_TYPE = source.LAST_UPDATED_SOURCE_TYPE,
                    target.FREIGHT_REVENUE = source.FREIGHT_REVENUE,
                    target.PRICE = source.PRICE,
                    target.SKU_BREAK_ATTR = source.SKU_BREAK_ATTR,
                    target.ALLOCATION_SOURCE_LINE_ID = source.ALLOCATION_SOURCE_LINE_ID,
                    target.BATCH_NBR = source.BATCH_NBR,
                    target.STACK_RANK = source.STACK_RANK,
                    target.ASSORT_NBR = source.ASSORT_NBR,
                    target.TC_COMPANY_ID = source.TC_COMPANY_ID,
                    target.STD_LPN_QTY = source.STD_LPN_QTY,
                    target.CHUTE_ASSIGN_TYPE = source.CHUTE_ASSIGN_TYPE,
                    target.PACKAGE_TYPE_ID = source.PACKAGE_TYPE_ID,
                    target.ORDER_CONSOL_ATTR = source.ORDER_CONSOL_ATTR,
                    target.SHIPPED_QTY = source.SHIPPED_QTY,
                    target.EVENT_CODE = source.EVENT_CODE,
                    target.PROD_STAT = source.PROD_STAT,
                    target.STACK_HEIGHT_VALUE = source.STACK_HEIGHT_VALUE,
                    target.EFFECTIVE_RANK = source.EFFECTIVE_RANK,
                    target.STACK_WIDTH_STANDARD_UOM = source.STACK_WIDTH_STANDARD_UOM,
                    target.SHIP_WAVE_NBR = source.SHIP_WAVE_NBR,
                    target.STD_PACK_QTY = source.STD_PACK_QTY,
                    target.IS_CANCELLED = source.IS_CANCELLED,
                    target.VOLUME_UOM_ID_BASE = source.VOLUME_UOM_ID_BASE,
                    target.RTL_TO_BE_DISTROED_QTY = source.RTL_TO_BE_DISTROED_QTY,
                    target.QTY_CONV_FACTOR = source.QTY_CONV_FACTOR,
                    target.PRICE_TKT_TYPE = source.PRICE_TKT_TYPE,
                    target.ORIGINAL_ORDERED_ITEM_ID = source.ORIGINAL_ORDERED_ITEM_ID,
                    target.PICKUP_END_DTTM = source.PICKUP_END_DTTM,
                    target.USER_CANCELED_QTY = source.USER_CANCELED_QTY,
                    target.MERCHANDIZING_DEPARTMENT_ID = source.MERCHANDIZING_DEPARTMENT_ID,
                    target.SHIPPED_SIZE1 = source.SHIPPED_SIZE1,
                    target.SHIPPED_SIZE2 = source.SHIPPED_SIZE2,
                    target.VOLUME_UOM_ID = source.VOLUME_UOM_ID,
                    target.SERIAL_NUMBER_REQUIRED_FLAG = source.SERIAL_NUMBER_REQUIRED_FLAG,
                    target.ARCHIVE_DTTM = current_timestamp(),
                    target._FIVETRAN_DELETED = source._FIVETRAN_DELETED,
                    target._FIVETRAN_SYNCED = source._FIVETRAN_SYNCED
            WHEN NOT MATCHED THEN
                    INSERT (LINE_ITEM_ID, ORDER_ID, WEIGHT_UOM_ID_BASE, UNIT_COST, PPACK_GRP_CODE, ITEM_NAME, DO_DTL_STATUS, INTERNAL_ORDER_SEQ_NBR, BACK_ORD_REASON, STD_BUNDLE_QTY, COMMODITY_CODE_ID, PICK_LOCN_ID, REFERENCE_ORDER_ID, EXT_PURCHASE_ORDER, REF_SYSCODE1, REF_SYSCODE2, REF_SYSCODE3, STACK_LENGTH_STANDARD_UOM, TC_ORDER_LINE_ID, MINOR_ORDER_NBR, INTERNAL_ORDER_ID, RECEIVED_VOLUME, MV_SIZE_UOM_ID, EXT_SYS_LINE_ITEM_ID, GIFT_CARD_VALUE, UNIT_VOL, MV_CURRENCY_CODE, STACK_LENGTH_VALUE, PARTL_FILL, QTY_UOM_ID, IS_HAZMAT, STACK_DIAMETER_STANDARD_UOM, LPN_TYPE, CREATED_SOURCE_TYPE, PICKUP_START_DTTM, STACK_WIDTH_VALUE, ALLOW_REVIVAL_RECEIPT_ALLOC, STD_LPN_VOL, DESCRIPTION, MERCH_GRP, MANUFACTURING_DTTM, LINE_TYPE, PACK_RATE, WAVE_NBR, STD_LPN_WT, INVN_TYPE, SUBSTITUTED_PARENT_LINE_ID, PLANNED_SHIP_DATE, PROTECTION_LEVEL_ID, QTY_UOM_ID_BASE, PARENT_LINE_ITEM_ID, PALLET_TYPE, ALLOC_LINE_ID, SUBSTITUTION_TYPE, ACTUAL_SHIPPED_DTTM, DELIVERY_START_DTTM, PICK_LOCN_ASSIGN_TYPE, FREIGHT_REVENUE_CURRENCY_CODE, BUDG_COST_CURRENCY_CODE, ORDER_LINE_ID, ACTUAL_COST_CURRENCY_CODE, PRIORITY, SHELF_DAYS, COMMODITY_CLASS, LPN_SIZE, SIZE2_UOM_ID, CREATED_SOURCE, WEIGHT_UOM_ID, PURCHASE_ORDER_LINE_NUMBER, STORE_DEPT, LAST_UPDATED_DTTM, RECEIVED_WEIGHT, IS_EMERGENCY, SKU_SUB_CODE_VALUE, MO_LINE_ITEM_ID, CNTRY_OF_ORGN, UNIT_TAX_AMOUNT, ALLOC_TYPE, PICKUP_REFERENCE_NUMBER, WM_RECEIPT_ALLOCATED, ADJUSTED_ORDER_QTY, WAVE_PROC_TYPE, IS_STACKABLE, LAST_UPDATED_SOURCE, CRITCL_DIM_3, REPL_WAVE_RUN, UNIT_WT, RETAIL_PRICE, ORDER_QTY, MASTER_ORDER_ID, UNIT_PRICE_AMOUNT, REF_NUM1, REF_NUM3, DELIVERY_END_DTTM, REF_NUM2, REF_NUM5, REF_NUM4, ACTUAL_COST, PURCHASE_ORDER_NUMBER, REASON_CODE, ALLOCATION_SOURCE, DELIVERY_REFERENCE_NUMBER, SHIPPED_WEIGHT, UN_NUMBER_ID, VAS_PROCESS_TYPE, FULFILLMENT_TYPE, MERCH_TYPE, CRITCL_DIM_1, CRITCL_DIM_2, REPL_PROC_TYPE, CUBE_MULTIPLE_QTY, UNITS_PAKD, SINGLE_UNIT_FLAG, PLANNED_WEIGHT, SKU_GTIN, ORIG_BUDG_COST, STACK_DIAMETER_VALUE, IS_CHASE_CREATED_LINE, ORIG_ORDER_QTY, HIBERNATE_VERSION, PPACK_QTY, CUSTOM_TAG, LPN_BRK_ATTRIB, PACK_ZONE, LOCKED, BATCH_REQUIREMENT_TYPE, ALLOCATED_QTY, SIZE2_VALUE, ITEM_ID, ALLOCATION_SOURCE_ID, STACK_HEIGHT_STANDARD_UOM, RTS_LINE_ITEM_ID, HAS_ERRORS, STD_PALLET_QTY, TOTAL_MONETARY_VALUE, UNIT_MONETARY_VALUE, BUDG_COST, REF_BOOLEAN1, EXP_INFO_CODE, REF_BOOLEAN2, STD_SUB_PACK_QTY, HARD_ALLOC_REASON_CODE, RECEIVED_QTY, REFERENCE_LINE_ITEM_ID, PLANNED_VOLUME, CREATED_DTTM, CUSTOMER_ITEM, SHIPPED_VOLUME, REF_FIELD10, RECEIVED_SIZE2, RECEIVED_SIZE1, REF_FIELD1, REF_FIELD4, REF_FIELD5, REF_FIELD2, REF_FIELD3, PRE_RECEIPT_STATUS, REF_FIELD8, REF_FIELD9, REF_FIELD6, SKU_SUB_CODE_ID, REF_FIELD7, SIZE1_VALUE, RTS_ID, IS_GIFT, SEGMENT_NAME, ITEM_ATTR_4, ITEM_ATTR_5, ITEM_ATTR_2, PRODUCT_CLASS_ID, ITEM_ATTR_3, SIZE1_UOM_ID, REPL_WAVE_NBR, ITEM_ATTR_1, LAST_UPDATED_SOURCE_TYPE, FREIGHT_REVENUE, PRICE, SKU_BREAK_ATTR, ALLOCATION_SOURCE_LINE_ID, BATCH_NBR, STACK_RANK, ASSORT_NBR, TC_COMPANY_ID, STD_LPN_QTY, CHUTE_ASSIGN_TYPE, PACKAGE_TYPE_ID, ORDER_CONSOL_ATTR, SHIPPED_QTY, EVENT_CODE, PROD_STAT, STACK_HEIGHT_VALUE, EFFECTIVE_RANK, STACK_WIDTH_STANDARD_UOM, SHIP_WAVE_NBR, STD_PACK_QTY, IS_CANCELLED, VOLUME_UOM_ID_BASE, RTL_TO_BE_DISTROED_QTY, QTY_CONV_FACTOR, PRICE_TKT_TYPE, ORIGINAL_ORDERED_ITEM_ID, PICKUP_END_DTTM, USER_CANCELED_QTY, MERCHANDIZING_DEPARTMENT_ID, SHIPPED_SIZE1, SHIPPED_SIZE2, VOLUME_UOM_ID, SERIAL_NUMBER_REQUIRED_FLAG, ARCHIVE_DTTM, _FIVETRAN_DELETED, _FIVETRAN_SYNCED)
                    VALUES (source.LINE_ITEM_ID, source.ORDER_ID, source.WEIGHT_UOM_ID_BASE, source.UNIT_COST, source.PPACK_GRP_CODE, source.ITEM_NAME, source.DO_DTL_STATUS, source.INTERNAL_ORDER_SEQ_NBR, source.BACK_ORD_REASON, source.STD_BUNDLE_QTY, source.COMMODITY_CODE_ID, source.PICK_LOCN_ID, source.REFERENCE_ORDER_ID, source.EXT_PURCHASE_ORDER, source.REF_SYSCODE1, source.REF_SYSCODE2, source.REF_SYSCODE3, source.STACK_LENGTH_STANDARD_UOM, source.TC_ORDER_LINE_ID, source.MINOR_ORDER_NBR, source.INTERNAL_ORDER_ID, source.RECEIVED_VOLUME, source.MV_SIZE_UOM_ID, source.EXT_SYS_LINE_ITEM_ID, source.GIFT_CARD_VALUE, source.UNIT_VOL, source.MV_CURRENCY_CODE, source.STACK_LENGTH_VALUE, source.PARTL_FILL, source.QTY_UOM_ID, source.IS_HAZMAT, source.STACK_DIAMETER_STANDARD_UOM, source.LPN_TYPE, source.CREATED_SOURCE_TYPE, source.PICKUP_START_DTTM, source.STACK_WIDTH_VALUE, source.ALLOW_REVIVAL_RECEIPT_ALLOC, source.STD_LPN_VOL, source.DESCRIPTION, source.MERCH_GRP, source.MANUFACTURING_DTTM, source.LINE_TYPE, source.PACK_RATE, source.WAVE_NBR, source.STD_LPN_WT, source.INVN_TYPE, source.SUBSTITUTED_PARENT_LINE_ID, source.PLANNED_SHIP_DATE, source.PROTECTION_LEVEL_ID, source.QTY_UOM_ID_BASE, source.PARENT_LINE_ITEM_ID, source.PALLET_TYPE, source.ALLOC_LINE_ID, source.SUBSTITUTION_TYPE, source.ACTUAL_SHIPPED_DTTM, source.DELIVERY_START_DTTM, source.PICK_LOCN_ASSIGN_TYPE, source.FREIGHT_REVENUE_CURRENCY_CODE, source.BUDG_COST_CURRENCY_CODE, source.ORDER_LINE_ID, source.ACTUAL_COST_CURRENCY_CODE, source.PRIORITY, source.SHELF_DAYS, source.COMMODITY_CLASS, source.LPN_SIZE, source.SIZE2_UOM_ID, source.CREATED_SOURCE, source.WEIGHT_UOM_ID, source.PURCHASE_ORDER_LINE_NUMBER, source.STORE_DEPT, source.LAST_UPDATED_DTTM, source.RECEIVED_WEIGHT, source.IS_EMERGENCY, source.SKU_SUB_CODE_VALUE, source.MO_LINE_ITEM_ID, source.CNTRY_OF_ORGN, source.UNIT_TAX_AMOUNT, source.ALLOC_TYPE, source.PICKUP_REFERENCE_NUMBER, source.WM_RECEIPT_ALLOCATED, source.ADJUSTED_ORDER_QTY, source.WAVE_PROC_TYPE, source.IS_STACKABLE, source.LAST_UPDATED_SOURCE, source.CRITCL_DIM_3, source.REPL_WAVE_RUN, source.UNIT_WT, source.RETAIL_PRICE, source.ORDER_QTY, source.MASTER_ORDER_ID, source.UNIT_PRICE_AMOUNT, source.REF_NUM1, source.REF_NUM3, source.DELIVERY_END_DTTM, source.REF_NUM2, source.REF_NUM5, source.REF_NUM4, source.ACTUAL_COST, source.PURCHASE_ORDER_NUMBER, source.REASON_CODE, source.ALLOCATION_SOURCE, source.DELIVERY_REFERENCE_NUMBER, source.SHIPPED_WEIGHT, source.UN_NUMBER_ID, source.VAS_PROCESS_TYPE, source.FULFILLMENT_TYPE, source.MERCH_TYPE, source.CRITCL_DIM_1, source.CRITCL_DIM_2, source.REPL_PROC_TYPE, source.CUBE_MULTIPLE_QTY, source.UNITS_PAKD, source.SINGLE_UNIT_FLAG, source.PLANNED_WEIGHT, source.SKU_GTIN, source.ORIG_BUDG_COST, source.STACK_DIAMETER_VALUE, source.IS_CHASE_CREATED_LINE, source.ORIG_ORDER_QTY, source.HIBERNATE_VERSION, source.PPACK_QTY, source.CUSTOM_TAG, source.LPN_BRK_ATTRIB, source.PACK_ZONE, source.LOCKED, source.BATCH_REQUIREMENT_TYPE, source.ALLOCATED_QTY, source.SIZE2_VALUE, source.ITEM_ID, source.ALLOCATION_SOURCE_ID, source.STACK_HEIGHT_STANDARD_UOM, source.RTS_LINE_ITEM_ID, source.HAS_ERRORS, source.STD_PALLET_QTY, source.TOTAL_MONETARY_VALUE, source.UNIT_MONETARY_VALUE, source.BUDG_COST, source.REF_BOOLEAN1, source.EXP_INFO_CODE, source.REF_BOOLEAN2, source.STD_SUB_PACK_QTY, source.HARD_ALLOC_REASON_CODE, source.RECEIVED_QTY, source.REFERENCE_LINE_ITEM_ID, source.PLANNED_VOLUME, source.CREATED_DTTM, source.CUSTOMER_ITEM, source.SHIPPED_VOLUME, source.REF_FIELD10, source.RECEIVED_SIZE2, source.RECEIVED_SIZE1, source.REF_FIELD1, source.REF_FIELD4, source.REF_FIELD5, source.REF_FIELD2, source.REF_FIELD3, source.PRE_RECEIPT_STATUS, source.REF_FIELD8, source.REF_FIELD9, source.REF_FIELD6, source.SKU_SUB_CODE_ID, source.REF_FIELD7, source.SIZE1_VALUE, source.RTS_ID, source.IS_GIFT, source.SEGMENT_NAME, source.ITEM_ATTR_4, source.ITEM_ATTR_5, source.ITEM_ATTR_2, source.PRODUCT_CLASS_ID, source.ITEM_ATTR_3, source.SIZE1_UOM_ID, source.REPL_WAVE_NBR, source.ITEM_ATTR_1, source.LAST_UPDATED_SOURCE_TYPE, source.FREIGHT_REVENUE, source.PRICE, source.SKU_BREAK_ATTR, source.ALLOCATION_SOURCE_LINE_ID, source.BATCH_NBR, source.STACK_RANK, source.ASSORT_NBR, source.TC_COMPANY_ID, source.STD_LPN_QTY, source.CHUTE_ASSIGN_TYPE, source.PACKAGE_TYPE_ID, source.ORDER_CONSOL_ATTR, source.SHIPPED_QTY, source.EVENT_CODE, source.PROD_STAT, source.STACK_HEIGHT_VALUE, source.EFFECTIVE_RANK, source.STACK_WIDTH_STANDARD_UOM, source.SHIP_WAVE_NBR, source.STD_PACK_QTY, source.IS_CANCELLED, source.VOLUME_UOM_ID_BASE, source.RTL_TO_BE_DISTROED_QTY, source.QTY_CONV_FACTOR, source.PRICE_TKT_TYPE, source.ORIGINAL_ORDERED_ITEM_ID, source.PICKUP_END_DTTM, source.USER_CANCELED_QTY, source.MERCHANDIZING_DEPARTMENT_ID, source.SHIPPED_SIZE1, source.SHIPPED_SIZE2, source.VOLUME_UOM_ID, source.SERIAL_NUMBER_REQUIRED_FLAG, current_timestamp(), source._FIVETRAN_DELETED, source._FIVETRAN_SYNCED);
            RETURN 'SUCCESS';
END;


-------------------------------------------------------------------------------------| SP_RY
CALL ETL.RY_ARCH.SP_UPDATE_ETL_ORDER_LINE_ITEM_RY();

CREATE OR REPLACE PROCEDURE ETL.RY_ARCH.SP_UPDATE_ETL_ORDER_LINE_ITEM_RY()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS 
    BEGIN

MERGE INTO ETL.RY_ARCH.ORDER_LINE_ITEM AS target
            USING (
                SELECT *, current_timestamp() as ARCHIVE_DTTM
                FROM XBPRDWMRY.PRD_RY_GA_XBORPRDWM.ORDER_LINE_ITEM
                WHERE CREATED_DTTM <= DATEADD(month, -2, CURRENT_DATE())
            ) AS source
            ON target.LINE_ITEM_ID = source.LINE_ITEM_ID
            WHEN MATCHED AND target.LAST_UPDATED_DTTM < source.LAST_UPDATED_DTTM THEN
                UPDATE SET 
                    target.ORDER_ID = source.ORDER_ID,
                    target.WEIGHT_UOM_ID_BASE = source.WEIGHT_UOM_ID_BASE,
                    target.UNIT_COST = source.UNIT_COST,
                    target.PPACK_GRP_CODE = source.PPACK_GRP_CODE,
                    target.ITEM_NAME = source.ITEM_NAME,
                    target.DO_DTL_STATUS = source.DO_DTL_STATUS,
                    target.INTERNAL_ORDER_SEQ_NBR = source.INTERNAL_ORDER_SEQ_NBR,
                    target.BACK_ORD_REASON = source.BACK_ORD_REASON,
                    target.STD_BUNDLE_QTY = source.STD_BUNDLE_QTY,
                    target.COMMODITY_CODE_ID = source.COMMODITY_CODE_ID,
                    target.PICK_LOCN_ID = source.PICK_LOCN_ID,
                    target.REFERENCE_ORDER_ID = source.REFERENCE_ORDER_ID,
                    target.EXT_PURCHASE_ORDER = source.EXT_PURCHASE_ORDER,
                    target.REF_SYSCODE1 = source.REF_SYSCODE1,
                    target.REF_SYSCODE2 = source.REF_SYSCODE2,
                    target.REF_SYSCODE3 = source.REF_SYSCODE3,
                    target.STACK_LENGTH_STANDARD_UOM = source.STACK_LENGTH_STANDARD_UOM,
                    target.TC_ORDER_LINE_ID = source.TC_ORDER_LINE_ID,
                    target.MINOR_ORDER_NBR = source.MINOR_ORDER_NBR,
                    target.INTERNAL_ORDER_ID = source.INTERNAL_ORDER_ID,
                    target.RECEIVED_VOLUME = source.RECEIVED_VOLUME,
                    target.MV_SIZE_UOM_ID = source.MV_SIZE_UOM_ID,
                    target.EXT_SYS_LINE_ITEM_ID = source.EXT_SYS_LINE_ITEM_ID,
                    target.GIFT_CARD_VALUE = source.GIFT_CARD_VALUE,
                    target.UNIT_VOL = source.UNIT_VOL,
                    target.MV_CURRENCY_CODE = source.MV_CURRENCY_CODE,
                    target.STACK_LENGTH_VALUE = source.STACK_LENGTH_VALUE,
                    target.PARTL_FILL = source.PARTL_FILL,
                    target.QTY_UOM_ID = source.QTY_UOM_ID,
                    target.IS_HAZMAT = source.IS_HAZMAT,
                    target.STACK_DIAMETER_STANDARD_UOM = source.STACK_DIAMETER_STANDARD_UOM,
                    target.LPN_TYPE = source.LPN_TYPE,
                    target.CREATED_SOURCE_TYPE = source.CREATED_SOURCE_TYPE,
                    target.PICKUP_START_DTTM = source.PICKUP_START_DTTM,
                    target.STACK_WIDTH_VALUE = source.STACK_WIDTH_VALUE,
                    target.ALLOW_REVIVAL_RECEIPT_ALLOC = source.ALLOW_REVIVAL_RECEIPT_ALLOC,
                    target.STD_LPN_VOL = source.STD_LPN_VOL,
                    target.DESCRIPTION = source.DESCRIPTION,
                    target.MERCH_GRP = source.MERCH_GRP,
                    target.MANUFACTURING_DTTM = source.MANUFACTURING_DTTM,
                    target.LINE_TYPE = source.LINE_TYPE,
                    target.PACK_RATE = source.PACK_RATE,
                    target.WAVE_NBR = source.WAVE_NBR,
                    target.STD_LPN_WT = source.STD_LPN_WT,
                    target.INVN_TYPE = source.INVN_TYPE,
                    target.SUBSTITUTED_PARENT_LINE_ID = source.SUBSTITUTED_PARENT_LINE_ID,
                    target.PLANNED_SHIP_DATE = source.PLANNED_SHIP_DATE,
                    target.PROTECTION_LEVEL_ID = source.PROTECTION_LEVEL_ID,
                    target.QTY_UOM_ID_BASE = source.QTY_UOM_ID_BASE,
                    target.PARENT_LINE_ITEM_ID = source.PARENT_LINE_ITEM_ID,
                    target.PALLET_TYPE = source.PALLET_TYPE,
                    target.ALLOC_LINE_ID = source.ALLOC_LINE_ID,
                    target.SUBSTITUTION_TYPE = source.SUBSTITUTION_TYPE,
                    target.ACTUAL_SHIPPED_DTTM = source.ACTUAL_SHIPPED_DTTM,
                    target.DELIVERY_START_DTTM = source.DELIVERY_START_DTTM,
                    target.PICK_LOCN_ASSIGN_TYPE = source.PICK_LOCN_ASSIGN_TYPE,
                    target.FREIGHT_REVENUE_CURRENCY_CODE = source.FREIGHT_REVENUE_CURRENCY_CODE,
                    target.BUDG_COST_CURRENCY_CODE = source.BUDG_COST_CURRENCY_CODE,
                    target.ORDER_LINE_ID = source.ORDER_LINE_ID,
                    target.ACTUAL_COST_CURRENCY_CODE = source.ACTUAL_COST_CURRENCY_CODE,
                    target.PRIORITY = source.PRIORITY,
                    target.SHELF_DAYS = source.SHELF_DAYS,
                    target.COMMODITY_CLASS = source.COMMODITY_CLASS,
                    target.LPN_SIZE = source.LPN_SIZE,
                    target.SIZE2_UOM_ID = source.SIZE2_UOM_ID,
                    target.CREATED_SOURCE = source.CREATED_SOURCE,
                    target.WEIGHT_UOM_ID = source.WEIGHT_UOM_ID,
                    target.PURCHASE_ORDER_LINE_NUMBER = source.PURCHASE_ORDER_LINE_NUMBER,
                    target.STORE_DEPT = source.STORE_DEPT,
                    target.LAST_UPDATED_DTTM = source.LAST_UPDATED_DTTM,
                    target.RECEIVED_WEIGHT = source.RECEIVED_WEIGHT,
                    target.IS_EMERGENCY = source.IS_EMERGENCY,
                    target.SKU_SUB_CODE_VALUE = source.SKU_SUB_CODE_VALUE,
                    target.MO_LINE_ITEM_ID = source.MO_LINE_ITEM_ID,
                    target.CNTRY_OF_ORGN = source.CNTRY_OF_ORGN,
                    target.UNIT_TAX_AMOUNT = source.UNIT_TAX_AMOUNT,
                    target.ALLOC_TYPE = source.ALLOC_TYPE,
                    target.PICKUP_REFERENCE_NUMBER = source.PICKUP_REFERENCE_NUMBER,
                    target.WM_RECEIPT_ALLOCATED = source.WM_RECEIPT_ALLOCATED,
                    target.ADJUSTED_ORDER_QTY = source.ADJUSTED_ORDER_QTY,
                    target.WAVE_PROC_TYPE = source.WAVE_PROC_TYPE,
                    target.IS_STACKABLE = source.IS_STACKABLE,
                    target.LAST_UPDATED_SOURCE = source.LAST_UPDATED_SOURCE,
                    target.CRITCL_DIM_3 = source.CRITCL_DIM_3,
                    target.REPL_WAVE_RUN = source.REPL_WAVE_RUN,
                    target.UNIT_WT = source.UNIT_WT,
                    target.RETAIL_PRICE = source.RETAIL_PRICE,
                    target.ORDER_QTY = source.ORDER_QTY,
                    target.MASTER_ORDER_ID = source.MASTER_ORDER_ID,
                    target.UNIT_PRICE_AMOUNT = source.UNIT_PRICE_AMOUNT,
                    target.REF_NUM1 = source.REF_NUM1,
                    target.REF_NUM3 = source.REF_NUM3,
                    target.DELIVERY_END_DTTM = source.DELIVERY_END_DTTM,
                    target.REF_NUM2 = source.REF_NUM2,
                    target.REF_NUM5 = source.REF_NUM5,
                    target.REF_NUM4 = source.REF_NUM4,
                    target.ACTUAL_COST = source.ACTUAL_COST,
                    target.PURCHASE_ORDER_NUMBER = source.PURCHASE_ORDER_NUMBER,
                    target.REASON_CODE = source.REASON_CODE,
                    target.ALLOCATION_SOURCE = source.ALLOCATION_SOURCE,
                    target.DELIVERY_REFERENCE_NUMBER = source.DELIVERY_REFERENCE_NUMBER,
                    target.SHIPPED_WEIGHT = source.SHIPPED_WEIGHT,
                    target.UN_NUMBER_ID = source.UN_NUMBER_ID,
                    target.VAS_PROCESS_TYPE = source.VAS_PROCESS_TYPE,
                    target.FULFILLMENT_TYPE = source.FULFILLMENT_TYPE,
                    target.MERCH_TYPE = source.MERCH_TYPE,
                    target.CRITCL_DIM_1 = source.CRITCL_DIM_1,
                    target.CRITCL_DIM_2 = source.CRITCL_DIM_2,
                    target.REPL_PROC_TYPE = source.REPL_PROC_TYPE,
                    target.CUBE_MULTIPLE_QTY = source.CUBE_MULTIPLE_QTY,
                    target.UNITS_PAKD = source.UNITS_PAKD,
                    target.SINGLE_UNIT_FLAG = source.SINGLE_UNIT_FLAG,
                    target.PLANNED_WEIGHT = source.PLANNED_WEIGHT,
                    target.SKU_GTIN = source.SKU_GTIN,
                    target.ORIG_BUDG_COST = source.ORIG_BUDG_COST,
                    target.STACK_DIAMETER_VALUE = source.STACK_DIAMETER_VALUE,
                    target.IS_CHASE_CREATED_LINE = source.IS_CHASE_CREATED_LINE,
                    target.ORIG_ORDER_QTY = source.ORIG_ORDER_QTY,
                    target.HIBERNATE_VERSION = source.HIBERNATE_VERSION,
                    target.PPACK_QTY = source.PPACK_QTY,
                    target.CUSTOM_TAG = source.CUSTOM_TAG,
                    target.LPN_BRK_ATTRIB = source.LPN_BRK_ATTRIB,
                    target.PACK_ZONE = source.PACK_ZONE,
                    target.LOCKED = source.LOCKED,
                    target.BATCH_REQUIREMENT_TYPE = source.BATCH_REQUIREMENT_TYPE,
                    target.ALLOCATED_QTY = source.ALLOCATED_QTY,
                    target.SIZE2_VALUE = source.SIZE2_VALUE,
                    target.ITEM_ID = source.ITEM_ID,
                    target.ALLOCATION_SOURCE_ID = source.ALLOCATION_SOURCE_ID,
                    target.STACK_HEIGHT_STANDARD_UOM = source.STACK_HEIGHT_STANDARD_UOM,
                    target.RTS_LINE_ITEM_ID = source.RTS_LINE_ITEM_ID,
                    target.HAS_ERRORS = source.HAS_ERRORS,
                    target.STD_PALLET_QTY = source.STD_PALLET_QTY,
                    target.TOTAL_MONETARY_VALUE = source.TOTAL_MONETARY_VALUE,
                    target.UNIT_MONETARY_VALUE = source.UNIT_MONETARY_VALUE,
                    target.BUDG_COST = source.BUDG_COST,
                    target.REF_BOOLEAN1 = source.REF_BOOLEAN1,
                    target.EXP_INFO_CODE = source.EXP_INFO_CODE,
                    target.REF_BOOLEAN2 = source.REF_BOOLEAN2,
                    target.STD_SUB_PACK_QTY = source.STD_SUB_PACK_QTY,
                    target.HARD_ALLOC_REASON_CODE = source.HARD_ALLOC_REASON_CODE,
                    target.RECEIVED_QTY = source.RECEIVED_QTY,
                    target.REFERENCE_LINE_ITEM_ID = source.REFERENCE_LINE_ITEM_ID,
                    target.PLANNED_VOLUME = source.PLANNED_VOLUME,
                    target.CUSTOMER_ITEM = source.CUSTOMER_ITEM,
                    target.SHIPPED_VOLUME = source.SHIPPED_VOLUME,
                    target.REF_FIELD10 = source.REF_FIELD10,
                    target.RECEIVED_SIZE2 = source.RECEIVED_SIZE2,
                    target.RECEIVED_SIZE1 = source.RECEIVED_SIZE1,
                    target.REF_FIELD1 = source.REF_FIELD1,
                    target.REF_FIELD4 = source.REF_FIELD4,
                    target.REF_FIELD5 = source.REF_FIELD5,
                    target.REF_FIELD2 = source.REF_FIELD2,
                    target.REF_FIELD3 = source.REF_FIELD3,
                    target.PRE_RECEIPT_STATUS = source.PRE_RECEIPT_STATUS,
                    target.REF_FIELD8 = source.REF_FIELD8,
                    target.REF_FIELD9 = source.REF_FIELD9,
                    target.REF_FIELD6 = source.REF_FIELD6,
                    target.SKU_SUB_CODE_ID = source.SKU_SUB_CODE_ID,
                    target.REF_FIELD7 = source.REF_FIELD7,
                    target.SIZE1_VALUE = source.SIZE1_VALUE,
                    target.RTS_ID = source.RTS_ID,
                    target.IS_GIFT = source.IS_GIFT,
                    target.SEGMENT_NAME = source.SEGMENT_NAME,
                    target.ITEM_ATTR_4 = source.ITEM_ATTR_4,
                    target.ITEM_ATTR_5 = source.ITEM_ATTR_5,
                    target.ITEM_ATTR_2 = source.ITEM_ATTR_2,
                    target.PRODUCT_CLASS_ID = source.PRODUCT_CLASS_ID,
                    target.ITEM_ATTR_3 = source.ITEM_ATTR_3,
                    target.SIZE1_UOM_ID = source.SIZE1_UOM_ID,
                    target.REPL_WAVE_NBR = source.REPL_WAVE_NBR,
                    target.ITEM_ATTR_1 = source.ITEM_ATTR_1,
                    target.LAST_UPDATED_SOURCE_TYPE = source.LAST_UPDATED_SOURCE_TYPE,
                    target.FREIGHT_REVENUE = source.FREIGHT_REVENUE,
                    target.PRICE = source.PRICE,
                    target.SKU_BREAK_ATTR = source.SKU_BREAK_ATTR,
                    target.ALLOCATION_SOURCE_LINE_ID = source.ALLOCATION_SOURCE_LINE_ID,
                    target.BATCH_NBR = source.BATCH_NBR,
                    target.STACK_RANK = source.STACK_RANK,
                    target.ASSORT_NBR = source.ASSORT_NBR,
                    target.TC_COMPANY_ID = source.TC_COMPANY_ID,
                    target.STD_LPN_QTY = source.STD_LPN_QTY,
                    target.CHUTE_ASSIGN_TYPE = source.CHUTE_ASSIGN_TYPE,
                    target.PACKAGE_TYPE_ID = source.PACKAGE_TYPE_ID,
                    target.ORDER_CONSOL_ATTR = source.ORDER_CONSOL_ATTR,
                    target.SHIPPED_QTY = source.SHIPPED_QTY,
                    target.EVENT_CODE = source.EVENT_CODE,
                    target.PROD_STAT = source.PROD_STAT,
                    target.STACK_HEIGHT_VALUE = source.STACK_HEIGHT_VALUE,
                    target.EFFECTIVE_RANK = source.EFFECTIVE_RANK,
                    target.STACK_WIDTH_STANDARD_UOM = source.STACK_WIDTH_STANDARD_UOM,
                    target.SHIP_WAVE_NBR = source.SHIP_WAVE_NBR,
                    target.STD_PACK_QTY = source.STD_PACK_QTY,
                    target.IS_CANCELLED = source.IS_CANCELLED,
                    target.VOLUME_UOM_ID_BASE = source.VOLUME_UOM_ID_BASE,
                    target.RTL_TO_BE_DISTROED_QTY = source.RTL_TO_BE_DISTROED_QTY,
                    target.QTY_CONV_FACTOR = source.QTY_CONV_FACTOR,
                    target.PRICE_TKT_TYPE = source.PRICE_TKT_TYPE,
                    target.ORIGINAL_ORDERED_ITEM_ID = source.ORIGINAL_ORDERED_ITEM_ID,
                    target.PICKUP_END_DTTM = source.PICKUP_END_DTTM,
                    target.USER_CANCELED_QTY = source.USER_CANCELED_QTY,
                    target.MERCHANDIZING_DEPARTMENT_ID = source.MERCHANDIZING_DEPARTMENT_ID,
                    target.SHIPPED_SIZE1 = source.SHIPPED_SIZE1,
                    target.SHIPPED_SIZE2 = source.SHIPPED_SIZE2,
                    target.VOLUME_UOM_ID = source.VOLUME_UOM_ID,
                    target.SERIAL_NUMBER_REQUIRED_FLAG = source.SERIAL_NUMBER_REQUIRED_FLAG,
                    target.ARCHIVE_DTTM = current_timestamp(),
                    target._FIVETRAN_DELETED = source._FIVETRAN_DELETED,
                    target._FIVETRAN_SYNCED = source._FIVETRAN_SYNCED
            WHEN NOT MATCHED THEN
                    INSERT (LINE_ITEM_ID, ORDER_ID, WEIGHT_UOM_ID_BASE, UNIT_COST, PPACK_GRP_CODE, ITEM_NAME, DO_DTL_STATUS, INTERNAL_ORDER_SEQ_NBR, BACK_ORD_REASON, STD_BUNDLE_QTY, COMMODITY_CODE_ID, PICK_LOCN_ID, REFERENCE_ORDER_ID, EXT_PURCHASE_ORDER, REF_SYSCODE1, REF_SYSCODE2, REF_SYSCODE3, STACK_LENGTH_STANDARD_UOM, TC_ORDER_LINE_ID, MINOR_ORDER_NBR, INTERNAL_ORDER_ID, RECEIVED_VOLUME, MV_SIZE_UOM_ID, EXT_SYS_LINE_ITEM_ID, GIFT_CARD_VALUE, UNIT_VOL, MV_CURRENCY_CODE, STACK_LENGTH_VALUE, PARTL_FILL, QTY_UOM_ID, IS_HAZMAT, STACK_DIAMETER_STANDARD_UOM, LPN_TYPE, CREATED_SOURCE_TYPE, PICKUP_START_DTTM, STACK_WIDTH_VALUE, ALLOW_REVIVAL_RECEIPT_ALLOC, STD_LPN_VOL, DESCRIPTION, MERCH_GRP, MANUFACTURING_DTTM, LINE_TYPE, PACK_RATE, WAVE_NBR, STD_LPN_WT, INVN_TYPE, SUBSTITUTED_PARENT_LINE_ID, PLANNED_SHIP_DATE, PROTECTION_LEVEL_ID, QTY_UOM_ID_BASE, PARENT_LINE_ITEM_ID, PALLET_TYPE, ALLOC_LINE_ID, SUBSTITUTION_TYPE, ACTUAL_SHIPPED_DTTM, DELIVERY_START_DTTM, PICK_LOCN_ASSIGN_TYPE, FREIGHT_REVENUE_CURRENCY_CODE, BUDG_COST_CURRENCY_CODE, ORDER_LINE_ID, ACTUAL_COST_CURRENCY_CODE, PRIORITY, SHELF_DAYS, COMMODITY_CLASS, LPN_SIZE, SIZE2_UOM_ID, CREATED_SOURCE, WEIGHT_UOM_ID, PURCHASE_ORDER_LINE_NUMBER, STORE_DEPT, LAST_UPDATED_DTTM, RECEIVED_WEIGHT, IS_EMERGENCY, SKU_SUB_CODE_VALUE, MO_LINE_ITEM_ID, CNTRY_OF_ORGN, UNIT_TAX_AMOUNT, ALLOC_TYPE, PICKUP_REFERENCE_NUMBER, WM_RECEIPT_ALLOCATED, ADJUSTED_ORDER_QTY, WAVE_PROC_TYPE, IS_STACKABLE, LAST_UPDATED_SOURCE, CRITCL_DIM_3, REPL_WAVE_RUN, UNIT_WT, RETAIL_PRICE, ORDER_QTY, MASTER_ORDER_ID, UNIT_PRICE_AMOUNT, REF_NUM1, REF_NUM3, DELIVERY_END_DTTM, REF_NUM2, REF_NUM5, REF_NUM4, ACTUAL_COST, PURCHASE_ORDER_NUMBER, REASON_CODE, ALLOCATION_SOURCE, DELIVERY_REFERENCE_NUMBER, SHIPPED_WEIGHT, UN_NUMBER_ID, VAS_PROCESS_TYPE, FULFILLMENT_TYPE, MERCH_TYPE, CRITCL_DIM_1, CRITCL_DIM_2, REPL_PROC_TYPE, CUBE_MULTIPLE_QTY, UNITS_PAKD, SINGLE_UNIT_FLAG, PLANNED_WEIGHT, SKU_GTIN, ORIG_BUDG_COST, STACK_DIAMETER_VALUE, IS_CHASE_CREATED_LINE, ORIG_ORDER_QTY, HIBERNATE_VERSION, PPACK_QTY, CUSTOM_TAG, LPN_BRK_ATTRIB, PACK_ZONE, LOCKED, BATCH_REQUIREMENT_TYPE, ALLOCATED_QTY, SIZE2_VALUE, ITEM_ID, ALLOCATION_SOURCE_ID, STACK_HEIGHT_STANDARD_UOM, RTS_LINE_ITEM_ID, HAS_ERRORS, STD_PALLET_QTY, TOTAL_MONETARY_VALUE, UNIT_MONETARY_VALUE, BUDG_COST, REF_BOOLEAN1, EXP_INFO_CODE, REF_BOOLEAN2, STD_SUB_PACK_QTY, HARD_ALLOC_REASON_CODE, RECEIVED_QTY, REFERENCE_LINE_ITEM_ID, PLANNED_VOLUME, CREATED_DTTM, CUSTOMER_ITEM, SHIPPED_VOLUME, REF_FIELD10, RECEIVED_SIZE2, RECEIVED_SIZE1, REF_FIELD1, REF_FIELD4, REF_FIELD5, REF_FIELD2, REF_FIELD3, PRE_RECEIPT_STATUS, REF_FIELD8, REF_FIELD9, REF_FIELD6, SKU_SUB_CODE_ID, REF_FIELD7, SIZE1_VALUE, RTS_ID, IS_GIFT, SEGMENT_NAME, ITEM_ATTR_4, ITEM_ATTR_5, ITEM_ATTR_2, PRODUCT_CLASS_ID, ITEM_ATTR_3, SIZE1_UOM_ID, REPL_WAVE_NBR, ITEM_ATTR_1, LAST_UPDATED_SOURCE_TYPE, FREIGHT_REVENUE, PRICE, SKU_BREAK_ATTR, ALLOCATION_SOURCE_LINE_ID, BATCH_NBR, STACK_RANK, ASSORT_NBR, TC_COMPANY_ID, STD_LPN_QTY, CHUTE_ASSIGN_TYPE, PACKAGE_TYPE_ID, ORDER_CONSOL_ATTR, SHIPPED_QTY, EVENT_CODE, PROD_STAT, STACK_HEIGHT_VALUE, EFFECTIVE_RANK, STACK_WIDTH_STANDARD_UOM, SHIP_WAVE_NBR, STD_PACK_QTY, IS_CANCELLED, VOLUME_UOM_ID_BASE, RTL_TO_BE_DISTROED_QTY, QTY_CONV_FACTOR, PRICE_TKT_TYPE, ORIGINAL_ORDERED_ITEM_ID, PICKUP_END_DTTM, USER_CANCELED_QTY, MERCHANDIZING_DEPARTMENT_ID, SHIPPED_SIZE1, SHIPPED_SIZE2, VOLUME_UOM_ID, SERIAL_NUMBER_REQUIRED_FLAG, ARCHIVE_DTTM, _FIVETRAN_DELETED, _FIVETRAN_SYNCED)
                    VALUES (source.LINE_ITEM_ID, source.ORDER_ID, source.WEIGHT_UOM_ID_BASE, source.UNIT_COST, source.PPACK_GRP_CODE, source.ITEM_NAME, source.DO_DTL_STATUS, source.INTERNAL_ORDER_SEQ_NBR, source.BACK_ORD_REASON, source.STD_BUNDLE_QTY, source.COMMODITY_CODE_ID, source.PICK_LOCN_ID, source.REFERENCE_ORDER_ID, source.EXT_PURCHASE_ORDER, source.REF_SYSCODE1, source.REF_SYSCODE2, source.REF_SYSCODE3, source.STACK_LENGTH_STANDARD_UOM, source.TC_ORDER_LINE_ID, source.MINOR_ORDER_NBR, source.INTERNAL_ORDER_ID, source.RECEIVED_VOLUME, source.MV_SIZE_UOM_ID, source.EXT_SYS_LINE_ITEM_ID, source.GIFT_CARD_VALUE, source.UNIT_VOL, source.MV_CURRENCY_CODE, source.STACK_LENGTH_VALUE, source.PARTL_FILL, source.QTY_UOM_ID, source.IS_HAZMAT, source.STACK_DIAMETER_STANDARD_UOM, source.LPN_TYPE, source.CREATED_SOURCE_TYPE, source.PICKUP_START_DTTM, source.STACK_WIDTH_VALUE, source.ALLOW_REVIVAL_RECEIPT_ALLOC, source.STD_LPN_VOL, source.DESCRIPTION, source.MERCH_GRP, source.MANUFACTURING_DTTM, source.LINE_TYPE, source.PACK_RATE, source.WAVE_NBR, source.STD_LPN_WT, source.INVN_TYPE, source.SUBSTITUTED_PARENT_LINE_ID, source.PLANNED_SHIP_DATE, source.PROTECTION_LEVEL_ID, source.QTY_UOM_ID_BASE, source.PARENT_LINE_ITEM_ID, source.PALLET_TYPE, source.ALLOC_LINE_ID, source.SUBSTITUTION_TYPE, source.ACTUAL_SHIPPED_DTTM, source.DELIVERY_START_DTTM, source.PICK_LOCN_ASSIGN_TYPE, source.FREIGHT_REVENUE_CURRENCY_CODE, source.BUDG_COST_CURRENCY_CODE, source.ORDER_LINE_ID, source.ACTUAL_COST_CURRENCY_CODE, source.PRIORITY, source.SHELF_DAYS, source.COMMODITY_CLASS, source.LPN_SIZE, source.SIZE2_UOM_ID, source.CREATED_SOURCE, source.WEIGHT_UOM_ID, source.PURCHASE_ORDER_LINE_NUMBER, source.STORE_DEPT, source.LAST_UPDATED_DTTM, source.RECEIVED_WEIGHT, source.IS_EMERGENCY, source.SKU_SUB_CODE_VALUE, source.MO_LINE_ITEM_ID, source.CNTRY_OF_ORGN, source.UNIT_TAX_AMOUNT, source.ALLOC_TYPE, source.PICKUP_REFERENCE_NUMBER, source.WM_RECEIPT_ALLOCATED, source.ADJUSTED_ORDER_QTY, source.WAVE_PROC_TYPE, source.IS_STACKABLE, source.LAST_UPDATED_SOURCE, source.CRITCL_DIM_3, source.REPL_WAVE_RUN, source.UNIT_WT, source.RETAIL_PRICE, source.ORDER_QTY, source.MASTER_ORDER_ID, source.UNIT_PRICE_AMOUNT, source.REF_NUM1, source.REF_NUM3, source.DELIVERY_END_DTTM, source.REF_NUM2, source.REF_NUM5, source.REF_NUM4, source.ACTUAL_COST, source.PURCHASE_ORDER_NUMBER, source.REASON_CODE, source.ALLOCATION_SOURCE, source.DELIVERY_REFERENCE_NUMBER, source.SHIPPED_WEIGHT, source.UN_NUMBER_ID, source.VAS_PROCESS_TYPE, source.FULFILLMENT_TYPE, source.MERCH_TYPE, source.CRITCL_DIM_1, source.CRITCL_DIM_2, source.REPL_PROC_TYPE, source.CUBE_MULTIPLE_QTY, source.UNITS_PAKD, source.SINGLE_UNIT_FLAG, source.PLANNED_WEIGHT, source.SKU_GTIN, source.ORIG_BUDG_COST, source.STACK_DIAMETER_VALUE, source.IS_CHASE_CREATED_LINE, source.ORIG_ORDER_QTY, source.HIBERNATE_VERSION, source.PPACK_QTY, source.CUSTOM_TAG, source.LPN_BRK_ATTRIB, source.PACK_ZONE, source.LOCKED, source.BATCH_REQUIREMENT_TYPE, source.ALLOCATED_QTY, source.SIZE2_VALUE, source.ITEM_ID, source.ALLOCATION_SOURCE_ID, source.STACK_HEIGHT_STANDARD_UOM, source.RTS_LINE_ITEM_ID, source.HAS_ERRORS, source.STD_PALLET_QTY, source.TOTAL_MONETARY_VALUE, source.UNIT_MONETARY_VALUE, source.BUDG_COST, source.REF_BOOLEAN1, source.EXP_INFO_CODE, source.REF_BOOLEAN2, source.STD_SUB_PACK_QTY, source.HARD_ALLOC_REASON_CODE, source.RECEIVED_QTY, source.REFERENCE_LINE_ITEM_ID, source.PLANNED_VOLUME, source.CREATED_DTTM, source.CUSTOMER_ITEM, source.SHIPPED_VOLUME, source.REF_FIELD10, source.RECEIVED_SIZE2, source.RECEIVED_SIZE1, source.REF_FIELD1, source.REF_FIELD4, source.REF_FIELD5, source.REF_FIELD2, source.REF_FIELD3, source.PRE_RECEIPT_STATUS, source.REF_FIELD8, source.REF_FIELD9, source.REF_FIELD6, source.SKU_SUB_CODE_ID, source.REF_FIELD7, source.SIZE1_VALUE, source.RTS_ID, source.IS_GIFT, source.SEGMENT_NAME, source.ITEM_ATTR_4, source.ITEM_ATTR_5, source.ITEM_ATTR_2, source.PRODUCT_CLASS_ID, source.ITEM_ATTR_3, source.SIZE1_UOM_ID, source.REPL_WAVE_NBR, source.ITEM_ATTR_1, source.LAST_UPDATED_SOURCE_TYPE, source.FREIGHT_REVENUE, source.PRICE, source.SKU_BREAK_ATTR, source.ALLOCATION_SOURCE_LINE_ID, source.BATCH_NBR, source.STACK_RANK, source.ASSORT_NBR, source.TC_COMPANY_ID, source.STD_LPN_QTY, source.CHUTE_ASSIGN_TYPE, source.PACKAGE_TYPE_ID, source.ORDER_CONSOL_ATTR, source.SHIPPED_QTY, source.EVENT_CODE, source.PROD_STAT, source.STACK_HEIGHT_VALUE, source.EFFECTIVE_RANK, source.STACK_WIDTH_STANDARD_UOM, source.SHIP_WAVE_NBR, source.STD_PACK_QTY, source.IS_CANCELLED, source.VOLUME_UOM_ID_BASE, source.RTL_TO_BE_DISTROED_QTY, source.QTY_CONV_FACTOR, source.PRICE_TKT_TYPE, source.ORIGINAL_ORDERED_ITEM_ID, source.PICKUP_END_DTTM, source.USER_CANCELED_QTY, source.MERCHANDIZING_DEPARTMENT_ID, source.SHIPPED_SIZE1, source.SHIPPED_SIZE2, source.VOLUME_UOM_ID, source.SERIAL_NUMBER_REQUIRED_FLAG, current_timestamp(), source._FIVETRAN_DELETED, source._FIVETRAN_SYNCED);
            RETURN 'SUCCESS';
END;