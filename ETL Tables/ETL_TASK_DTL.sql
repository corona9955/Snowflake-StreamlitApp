---- GOLD
-- XBPRDWMGOLD.PRD_GOLD_GA_XBWM19WM.TASK_DTL
-- XBPRDWMGOLD.PRD_GOLD_D_XBWM19WM.TASK_DTL
-- XBPRDARCHGOLD.ARCH_GOLD_D_XBWM19ARCH.TASK_DTL
---- SILVER
-- XBPRDWMSILVER.PRD_SILVER_GA_XBDBTJ3WM.TASK_DTL
-- XBPRDWMSILVER.PRD_SILVER_D_XBDBTJ3WM.TASK_DTL
-- XBPRDARCHSILVER.ARCH_SILVER_D_XBWM19ARCH.TASK_DTL
---- RY
-- XBPRDWMRY.PRD_RY_GA_XBORPRDWM.TASK_DTL
-- XBPRDWMRY.PRD_RY_D_XBORPRDWM.TASK_DTL
-- XBPRDARCHREYNOSA.ARCHIVE_REYNOSA_XBORPRDARCH.TASK_DTL

---- GOLD
CREATE OR REPLACE TABLE ETL.GOLD_ARCH.TASK_DTL
AS
    SELECT
        NEXT_TASK_SEQ_NBR,
    	CARTON_SEQ_NBR,
    	RSN_CODE,
    	VOCOLLECT_SHORT_FLAG,
    	QTY_PULLD,
    	USER_ID,
    	DEST_LOCN_ID,
    	NEXT_TASK_TYPE,
    	TASK_GENRTN_REF_CODE,
    	CREATE_DATE_TIME,
    	ALLOCATION_KEY,
    	FULL_CNTR_ALLOCD,
    	TASK_CMPL_REF_NBR_SEQ,
    	CNTR_NBR,
    	ALLOC_UOM_QTY,
    	ERLST_START_DATE_TIME,
    	REQD_SKU_ATTR_3,
    	TASK_HDR_ID,
    	REQD_SKU_ATTR_4,
    	CD_MASTER_ID,
    	REQD_SKU_ATTR_5,
    	TASK_TYPE,
    	RESOURCE_GROUP_ID,
    	PKT_SEQ_NBR,
    	PAGE_NBR,
    	ALLOC_INVN_DTL_ID,
    	TASK_PRTY,
    	VOCOLLECT_POSN,
    	SKU_ATTR_2,
    	MISC_ALPHA_FIELD_3,
    	SKU_ATTR_3,
    	MISC_ALPHA_FIELD_1,
    	SKU_ATTR_1,
    	REQD_INVN_TYPE,
    	MISC_ALPHA_FIELD_2,
    	TASK_SEQ_NBR,
    	ITEM_ID,
    	SKU_ATTR_4,
    	SKU_ATTR_5,
    	SLOT_NBR,
    	BATCH_NBR,
    	DEST_LOCN_SEQ,
    	LTST_START_DATE_TIME,
    	TOTE_NBR,
    	WORK_RESOURCE_ID,
    	CNTRY_OF_ORGN,
    	LINE_ITEM_ID,
    	TASK_ID,
    	TASK_GENRTN_REF_NBR,
    	ORIG_REQMT,
    	STAT_CODE,
    	QTY_ALLOC,
    	CURR_WORK_GRP,
    	IS_CHASE_CREATED,
    	PROD_STAT,
    	LTST_CMPL_DATE_TIME,
    	REQD_PROD_STAT,
    	DISTRIBUTION_KEY,
    	PICK_SEQ_CODE,
    	PULL_LOCN_ID,
    	WM_VERSION_ID,
    	PIKR_NBR,
    	TASK_CMPL_REF_NBR,
    	CARTON_NBR,
    	PKT_CTRL_NBR,
    	SUBSTITUTION_FLAG,
    	SUBSLOT_NBR,
    	MOD_DATE_TIME,
    	NEXT_TASK_DESC,
    	REQD_BATCH_NBR,
    	CURR_WORK_AREA,
    	ALLOC_INVN_CODE,
    	REQD_SKU_ATTR_1,
    	REQD_SKU_ATTR_2,
    	WORK_RELEASE_BATCH_NUMBER,
    	INVN_NEED_TYPE,
    	TASK_DTL_ID,
    	TRANS_INVN_TYPE,
    	INVN_TYPE,
    	TASK_LOCN_SEQ,
    	REPL_DIVRT_LOCN,
    	ALLOC_UOM,
    	TASK_CMPL_REF_CODE,
    	NEXT_TASK_ID,
    	REQD_CNTRY_OF_ORGN,
    	TC_ORDER_ID,
    	current_timestamp() AS ARCHIVE_DTTM,
    	_FIVETRAN_DELETED,
    	_FIVETRAN_SYNCED
        
        FROM XBPRDWMGOLD.PRD_GOLD_GA_XBWM19WM.TASK_DTL
        WHERE TASK_DTL.CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE())

        UNION

        SELECT
        NEXT_TASK_SEQ_NBR,
    	CARTON_SEQ_NBR,
    	RSN_CODE,
    	VOCOLLECT_SHORT_FLAG,
    	QTY_PULLD,
    	USER_ID,
    	DEST_LOCN_ID,
    	NEXT_TASK_TYPE,
    	TASK_GENRTN_REF_CODE,
    	CREATE_DATE_TIME,
    	ALLOCATION_KEY,
    	FULL_CNTR_ALLOCD,
    	TASK_CMPL_REF_NBR_SEQ,
    	CNTR_NBR,
    	ALLOC_UOM_QTY,
    	ERLST_START_DATE_TIME,
    	REQD_SKU_ATTR_3,
    	TASK_HDR_ID,
    	REQD_SKU_ATTR_4,
    	CD_MASTER_ID,
    	REQD_SKU_ATTR_5,
    	TASK_TYPE,
    	RESOURCE_GROUP_ID,
    	PKT_SEQ_NBR,
    	PAGE_NBR,
    	ALLOC_INVN_DTL_ID,
    	TASK_PRTY,
    	VOCOLLECT_POSN,
    	SKU_ATTR_2,
    	MISC_ALPHA_FIELD_3,
    	SKU_ATTR_3,
    	MISC_ALPHA_FIELD_1,
    	SKU_ATTR_1,
    	REQD_INVN_TYPE,
    	MISC_ALPHA_FIELD_2,
    	TASK_SEQ_NBR,
    	ITEM_ID,
    	SKU_ATTR_4,
    	SKU_ATTR_5,
    	SLOT_NBR,
    	BATCH_NBR,
    	DEST_LOCN_SEQ,
    	LTST_START_DATE_TIME,
    	TOTE_NBR,
    	WORK_RESOURCE_ID,
    	CNTRY_OF_ORGN,
    	LINE_ITEM_ID,
    	TASK_ID,
    	TASK_GENRTN_REF_NBR,
    	ORIG_REQMT,
    	STAT_CODE,
    	QTY_ALLOC,
    	CURR_WORK_GRP,
    	IS_CHASE_CREATED,
    	PROD_STAT,
    	LTST_CMPL_DATE_TIME,
    	REQD_PROD_STAT,
    	DISTRIBUTION_KEY,
    	PICK_SEQ_CODE,
    	PULL_LOCN_ID,
    	WM_VERSION_ID,
    	PIKR_NBR,
    	TASK_CMPL_REF_NBR,
    	CARTON_NBR,
    	PKT_CTRL_NBR,
    	SUBSTITUTION_FLAG,
    	SUBSLOT_NBR,
    	MOD_DATE_TIME,
    	NEXT_TASK_DESC,
    	REQD_BATCH_NBR,
    	CURR_WORK_AREA,
    	ALLOC_INVN_CODE,
    	REQD_SKU_ATTR_1,
    	REQD_SKU_ATTR_2,
    	WORK_RELEASE_BATCH_NUMBER,
    	INVN_NEED_TYPE,
    	TASK_DTL_ID,
    	TRANS_INVN_TYPE,
    	INVN_TYPE,
    	TASK_LOCN_SEQ,
    	REPL_DIVRT_LOCN,
    	ALLOC_UOM,
    	TASK_CMPL_REF_CODE,
    	NEXT_TASK_ID,
    	REQD_CNTRY_OF_ORGN,
    	TC_ORDER_ID,
    	current_timestamp() AS ARCHIVE_DTTM,
    	_FIVETRAN_DELETED,
    	_FIVETRAN_SYNCED

        FROM XBPRDWMGOLD.PRD_GOLD_D_XBWM19WM.TASK_DTL
        WHERE TASK_DTL.TASK_DTL_ID  NOT IN (SELECT TASK_DTL_ID FROM XBPRDWMGOLD.PRD_GOLD_GA_XBWM19WM.TASK_DTL WHERE CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE()))

        UNION

        SELECT
        NEXT_TASK_SEQ_NBR,
    	CARTON_SEQ_NBR,
    	RSN_CODE,
    	VOCOLLECT_SHORT_FLAG,
    	QTY_PULLD,
    	USER_ID,
    	DEST_LOCN_ID,
    	NEXT_TASK_TYPE,
    	TASK_GENRTN_REF_CODE,
    	CREATE_DATE_TIME,
    	ALLOCATION_KEY,
    	FULL_CNTR_ALLOCD,
    	TASK_CMPL_REF_NBR_SEQ,
    	CNTR_NBR,
    	ALLOC_UOM_QTY,
    	ERLST_START_DATE_TIME,
    	REQD_SKU_ATTR_3,
    	TASK_HDR_ID,
    	REQD_SKU_ATTR_4,
    	CD_MASTER_ID,
    	REQD_SKU_ATTR_5,
    	TASK_TYPE,
    	RESOURCE_GROUP_ID,
    	PKT_SEQ_NBR,
    	PAGE_NBR,
    	ALLOC_INVN_DTL_ID,
    	TASK_PRTY,
    	VOCOLLECT_POSN,
    	SKU_ATTR_2,
    	MISC_ALPHA_FIELD_3,
    	SKU_ATTR_3,
    	MISC_ALPHA_FIELD_1,
    	SKU_ATTR_1,
    	REQD_INVN_TYPE,
    	MISC_ALPHA_FIELD_2,
    	TASK_SEQ_NBR,
    	ITEM_ID,
    	SKU_ATTR_4,
    	SKU_ATTR_5,
    	SLOT_NBR,
    	BATCH_NBR,
    	DEST_LOCN_SEQ,
    	LTST_START_DATE_TIME,
    	TOTE_NBR,
    	WORK_RESOURCE_ID,
    	CNTRY_OF_ORGN,
    	LINE_ITEM_ID,
    	TASK_ID,
    	TASK_GENRTN_REF_NBR,
    	ORIG_REQMT,
    	STAT_CODE,
    	QTY_ALLOC,
    	CURR_WORK_GRP,
    	IS_CHASE_CREATED,
    	PROD_STAT,
    	LTST_CMPL_DATE_TIME,
    	REQD_PROD_STAT,
    	DISTRIBUTION_KEY,
    	PICK_SEQ_CODE,
    	PULL_LOCN_ID,
    	WM_VERSION_ID,
    	PIKR_NBR,
    	TASK_CMPL_REF_NBR,
    	CARTON_NBR,
    	PKT_CTRL_NBR,
    	SUBSTITUTION_FLAG,
    	SUBSLOT_NBR,
    	MOD_DATE_TIME,
    	NEXT_TASK_DESC,
    	REQD_BATCH_NBR,
    	CURR_WORK_AREA,
    	ALLOC_INVN_CODE,
    	REQD_SKU_ATTR_1,
    	REQD_SKU_ATTR_2,
    	WORK_RELEASE_BATCH_NUMBER,
    	INVN_NEED_TYPE,
    	TASK_DTL_ID,
    	TRANS_INVN_TYPE,
    	INVN_TYPE,
    	TASK_LOCN_SEQ,
    	REPL_DIVRT_LOCN,
    	ALLOC_UOM,
    	TASK_CMPL_REF_CODE,
    	NEXT_TASK_ID,
    	REQD_CNTRY_OF_ORGN,
    	TC_ORDER_ID,
    	ARCHIVE_DTTM,
    	_FIVETRAN_DELETED,
    	_FIVETRAN_SYNCED
        
        FROM XBPRDARCHGOLD.ARCH_GOLD_D_XBWM19ARCH.TASK_DTL
        WHERE TASK_DTL.TASK_DTL_ID  NOT IN (
        SELECT TASK_DTL_ID FROM XBPRDWMGOLD.PRD_GOLD_GA_XBWM19WM.TASK_DTL WHERE TASK_DTL.CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE())
        )
        AND TASK_DTL.TASK_DTL_ID  NOT IN (SELECT TASK_DTL_ID FROM XBPRDWMGOLD.PRD_GOLD_D_XBWM19WM.TASK_DTL)
        ;
        
---- SILVER
CREATE OR REPLACE TABLE ETL.SILVER_ARCH.TASK_DTL
AS
    SELECT
        NEXT_TASK_SEQ_NBR,
    	CARTON_SEQ_NBR,
    	RSN_CODE,
    	VOCOLLECT_SHORT_FLAG,
    	QTY_PULLD,
    	USER_ID,
    	DEST_LOCN_ID,
    	NEXT_TASK_TYPE,
    	TASK_GENRTN_REF_CODE,
    	CREATE_DATE_TIME,
    	ALLOCATION_KEY,
    	FULL_CNTR_ALLOCD,
    	TASK_CMPL_REF_NBR_SEQ,
    	CNTR_NBR,
    	ALLOC_UOM_QTY,
    	ERLST_START_DATE_TIME,
    	REQD_SKU_ATTR_3,
    	TASK_HDR_ID,
    	REQD_SKU_ATTR_4,
    	CD_MASTER_ID,
    	REQD_SKU_ATTR_5,
    	TASK_TYPE,
    	RESOURCE_GROUP_ID,
    	PKT_SEQ_NBR,
    	PAGE_NBR,
    	ALLOC_INVN_DTL_ID,
    	TASK_PRTY,
    	VOCOLLECT_POSN,
    	SKU_ATTR_2,
    	MISC_ALPHA_FIELD_3,
    	SKU_ATTR_3,
    	MISC_ALPHA_FIELD_1,
    	SKU_ATTR_1,
    	REQD_INVN_TYPE,
    	MISC_ALPHA_FIELD_2,
    	TASK_SEQ_NBR,
    	ITEM_ID,
    	SKU_ATTR_4,
    	SKU_ATTR_5,
    	SLOT_NBR,
    	BATCH_NBR,
    	DEST_LOCN_SEQ,
    	LTST_START_DATE_TIME,
    	TOTE_NBR,
    	WORK_RESOURCE_ID,
    	CNTRY_OF_ORGN,
    	LINE_ITEM_ID,
    	TASK_ID,
    	TASK_GENRTN_REF_NBR,
    	ORIG_REQMT,
    	STAT_CODE,
    	QTY_ALLOC,
    	CURR_WORK_GRP,
    	IS_CHASE_CREATED,
    	PROD_STAT,
    	LTST_CMPL_DATE_TIME,
    	REQD_PROD_STAT,
    	DISTRIBUTION_KEY,
    	PICK_SEQ_CODE,
    	PULL_LOCN_ID,
    	WM_VERSION_ID,
    	PIKR_NBR,
    	TASK_CMPL_REF_NBR,
    	CARTON_NBR,
    	PKT_CTRL_NBR,
    	SUBSTITUTION_FLAG,
    	SUBSLOT_NBR,
    	MOD_DATE_TIME,
    	NEXT_TASK_DESC,
    	REQD_BATCH_NBR,
    	CURR_WORK_AREA,
    	ALLOC_INVN_CODE,
    	REQD_SKU_ATTR_1,
    	REQD_SKU_ATTR_2,
    	WORK_RELEASE_BATCH_NUMBER,
    	INVN_NEED_TYPE,
    	TASK_DTL_ID,
    	TRANS_INVN_TYPE,
    	INVN_TYPE,
    	TASK_LOCN_SEQ,
    	REPL_DIVRT_LOCN,
    	ALLOC_UOM,
    	TASK_CMPL_REF_CODE,
    	NEXT_TASK_ID,
    	REQD_CNTRY_OF_ORGN,
    	TC_ORDER_ID,
    	current_timestamp() AS ARCHIVE_DTTM,
    	_FIVETRAN_DELETED,
    	_FIVETRAN_SYNCED
        
        FROM XBPRDWMSILVER.PRD_SILVER_GA_XBDBTJ3WM.TASK_DTL
        WHERE TASK_DTL.CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE())

        UNION

        SELECT
        NEXT_TASK_SEQ_NBR,
    	CARTON_SEQ_NBR,
    	RSN_CODE,
    	VOCOLLECT_SHORT_FLAG,
    	QTY_PULLD,
    	USER_ID,
    	DEST_LOCN_ID,
    	NEXT_TASK_TYPE,
    	TASK_GENRTN_REF_CODE,
    	CREATE_DATE_TIME,
    	ALLOCATION_KEY,
    	FULL_CNTR_ALLOCD,
    	TASK_CMPL_REF_NBR_SEQ,
    	CNTR_NBR,
    	ALLOC_UOM_QTY,
    	ERLST_START_DATE_TIME,
    	REQD_SKU_ATTR_3,
    	TASK_HDR_ID,
    	REQD_SKU_ATTR_4,
    	CD_MASTER_ID,
    	REQD_SKU_ATTR_5,
    	TASK_TYPE,
    	RESOURCE_GROUP_ID,
    	PKT_SEQ_NBR,
    	PAGE_NBR,
    	ALLOC_INVN_DTL_ID,
    	TASK_PRTY,
    	VOCOLLECT_POSN,
    	SKU_ATTR_2,
    	MISC_ALPHA_FIELD_3,
    	SKU_ATTR_3,
    	MISC_ALPHA_FIELD_1,
    	SKU_ATTR_1,
    	REQD_INVN_TYPE,
    	MISC_ALPHA_FIELD_2,
    	TASK_SEQ_NBR,
    	ITEM_ID,
    	SKU_ATTR_4,
    	SKU_ATTR_5,
    	SLOT_NBR,
    	BATCH_NBR,
    	DEST_LOCN_SEQ,
    	LTST_START_DATE_TIME,
    	TOTE_NBR,
    	WORK_RESOURCE_ID,
    	CNTRY_OF_ORGN,
    	LINE_ITEM_ID,
    	TASK_ID,
    	TASK_GENRTN_REF_NBR,
    	ORIG_REQMT,
    	STAT_CODE,
    	QTY_ALLOC,
    	CURR_WORK_GRP,
    	IS_CHASE_CREATED,
    	PROD_STAT,
    	LTST_CMPL_DATE_TIME,
    	REQD_PROD_STAT,
    	DISTRIBUTION_KEY,
    	PICK_SEQ_CODE,
    	PULL_LOCN_ID,
    	WM_VERSION_ID,
    	PIKR_NBR,
    	TASK_CMPL_REF_NBR,
    	CARTON_NBR,
    	PKT_CTRL_NBR,
    	SUBSTITUTION_FLAG,
    	SUBSLOT_NBR,
    	MOD_DATE_TIME,
    	NEXT_TASK_DESC,
    	REQD_BATCH_NBR,
    	CURR_WORK_AREA,
    	ALLOC_INVN_CODE,
    	REQD_SKU_ATTR_1,
    	REQD_SKU_ATTR_2,
    	WORK_RELEASE_BATCH_NUMBER,
    	INVN_NEED_TYPE,
    	TASK_DTL_ID,
    	TRANS_INVN_TYPE,
    	INVN_TYPE,
    	TASK_LOCN_SEQ,
    	REPL_DIVRT_LOCN,
    	ALLOC_UOM,
    	TASK_CMPL_REF_CODE,
    	NEXT_TASK_ID,
    	REQD_CNTRY_OF_ORGN,
    	TC_ORDER_ID,
    	current_timestamp() AS ARCHIVE_DTTM,
    	_FIVETRAN_DELETED,
    	_FIVETRAN_SYNCED

        FROM XBPRDWMSILVER.PRD_SILVER_D_XBDBTJ3WM.TASK_DTL
        WHERE TASK_DTL.TASK_DTL_ID  NOT IN (SELECT TASK_DTL_ID FROM XBPRDWMSILVER.PRD_SILVER_GA_XBDBTJ3WM.TASK_DTL WHERE CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE()))

        UNION

        SELECT
        NEXT_TASK_SEQ_NBR,
    	CARTON_SEQ_NBR,
    	RSN_CODE,
    	VOCOLLECT_SHORT_FLAG,
    	QTY_PULLD,
    	USER_ID,
    	DEST_LOCN_ID,
    	NEXT_TASK_TYPE,
    	TASK_GENRTN_REF_CODE,
    	CREATE_DATE_TIME,
    	ALLOCATION_KEY,
    	FULL_CNTR_ALLOCD,
    	TASK_CMPL_REF_NBR_SEQ,
    	CNTR_NBR,
    	ALLOC_UOM_QTY,
    	ERLST_START_DATE_TIME,
    	REQD_SKU_ATTR_3,
    	TASK_HDR_ID,
    	REQD_SKU_ATTR_4,
    	CD_MASTER_ID,
    	REQD_SKU_ATTR_5,
    	TASK_TYPE,
    	RESOURCE_GROUP_ID,
    	PKT_SEQ_NBR,
    	PAGE_NBR,
    	ALLOC_INVN_DTL_ID,
    	TASK_PRTY,
    	VOCOLLECT_POSN,
    	SKU_ATTR_2,
    	MISC_ALPHA_FIELD_3,
    	SKU_ATTR_3,
    	MISC_ALPHA_FIELD_1,
    	SKU_ATTR_1,
    	REQD_INVN_TYPE,
    	MISC_ALPHA_FIELD_2,
    	TASK_SEQ_NBR,
    	ITEM_ID,
    	SKU_ATTR_4,
    	SKU_ATTR_5,
    	SLOT_NBR,
    	BATCH_NBR,
    	DEST_LOCN_SEQ,
    	LTST_START_DATE_TIME,
    	TOTE_NBR,
    	WORK_RESOURCE_ID,
    	CNTRY_OF_ORGN,
    	LINE_ITEM_ID,
    	TASK_ID,
    	TASK_GENRTN_REF_NBR,
    	ORIG_REQMT,
    	STAT_CODE,
    	QTY_ALLOC,
    	CURR_WORK_GRP,
    	IS_CHASE_CREATED,
    	PROD_STAT,
    	LTST_CMPL_DATE_TIME,
    	REQD_PROD_STAT,
    	DISTRIBUTION_KEY,
    	PICK_SEQ_CODE,
    	PULL_LOCN_ID,
    	WM_VERSION_ID,
    	PIKR_NBR,
    	TASK_CMPL_REF_NBR,
    	CARTON_NBR,
    	PKT_CTRL_NBR,
    	SUBSTITUTION_FLAG,
    	SUBSLOT_NBR,
    	MOD_DATE_TIME,
    	NEXT_TASK_DESC,
    	REQD_BATCH_NBR,
    	CURR_WORK_AREA,
    	ALLOC_INVN_CODE,
    	REQD_SKU_ATTR_1,
    	REQD_SKU_ATTR_2,
    	WORK_RELEASE_BATCH_NUMBER,
    	INVN_NEED_TYPE,
    	TASK_DTL_ID,
    	TRANS_INVN_TYPE,
    	INVN_TYPE,
    	TASK_LOCN_SEQ,
    	REPL_DIVRT_LOCN,
    	ALLOC_UOM,
    	TASK_CMPL_REF_CODE,
    	NEXT_TASK_ID,
    	REQD_CNTRY_OF_ORGN,
    	TC_ORDER_ID,
    	ARCHIVE_DTTM,
    	_FIVETRAN_DELETED,
    	_FIVETRAN_SYNCED
        
        FROM XBPRDARCHSILVER.ARCH_SILVER_D_XBWM19ARCH.TASK_DTL
        WHERE TASK_DTL.TASK_DTL_ID  NOT IN (
        SELECT TASK_DTL_ID FROM XBPRDWMSILVER.PRD_SILVER_GA_XBDBTJ3WM.TASK_DTL WHERE TASK_DTL.CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE())
        )
        AND TASK_DTL.TASK_DTL_ID  NOT IN (SELECT TASK_DTL_ID FROM XBPRDWMSILVER.PRD_SILVER_D_XBDBTJ3WM.TASK_DTL)
        ;

---- RY
CREATE OR REPLACE TABLE ETL.RY_ARCH.TASK_DTL
AS
    SELECT
        NEXT_TASK_SEQ_NBR,
    	CARTON_SEQ_NBR,
    	RSN_CODE,
    	VOCOLLECT_SHORT_FLAG,
    	QTY_PULLD,
    	USER_ID,
    	DEST_LOCN_ID,
    	NEXT_TASK_TYPE,
    	TASK_GENRTN_REF_CODE,
    	CREATE_DATE_TIME,
    	ALLOCATION_KEY,
    	FULL_CNTR_ALLOCD,
    	TASK_CMPL_REF_NBR_SEQ,
    	CNTR_NBR,
    	ALLOC_UOM_QTY,
    	ERLST_START_DATE_TIME,
    	REQD_SKU_ATTR_3,
    	TASK_HDR_ID,
    	REQD_SKU_ATTR_4,
    	CD_MASTER_ID,
    	REQD_SKU_ATTR_5,
    	TASK_TYPE,
    	RESOURCE_GROUP_ID,
    	PKT_SEQ_NBR,
    	PAGE_NBR,
    	ALLOC_INVN_DTL_ID,
    	TASK_PRTY,
    	VOCOLLECT_POSN,
    	SKU_ATTR_2,
    	MISC_ALPHA_FIELD_3,
    	SKU_ATTR_3,
    	MISC_ALPHA_FIELD_1,
    	SKU_ATTR_1,
    	REQD_INVN_TYPE,
    	MISC_ALPHA_FIELD_2,
    	TASK_SEQ_NBR,
    	ITEM_ID,
    	SKU_ATTR_4,
    	SKU_ATTR_5,
    	SLOT_NBR,
    	BATCH_NBR,
    	DEST_LOCN_SEQ,
    	LTST_START_DATE_TIME,
    	TOTE_NBR,
    	WORK_RESOURCE_ID,
    	CNTRY_OF_ORGN,
    	LINE_ITEM_ID,
    	TASK_ID,
    	TASK_GENRTN_REF_NBR,
    	ORIG_REQMT,
    	STAT_CODE,
    	QTY_ALLOC,
    	CURR_WORK_GRP,
    	IS_CHASE_CREATED,
    	PROD_STAT,
    	LTST_CMPL_DATE_TIME,
    	REQD_PROD_STAT,
    	DISTRIBUTION_KEY,
    	PICK_SEQ_CODE,
    	PULL_LOCN_ID,
    	WM_VERSION_ID,
    	PIKR_NBR,
    	TASK_CMPL_REF_NBR,
    	CARTON_NBR,
    	PKT_CTRL_NBR,
    	SUBSTITUTION_FLAG,
    	SUBSLOT_NBR,
    	MOD_DATE_TIME,
    	NEXT_TASK_DESC,
    	REQD_BATCH_NBR,
    	CURR_WORK_AREA,
    	ALLOC_INVN_CODE,
    	REQD_SKU_ATTR_1,
    	REQD_SKU_ATTR_2,
    	WORK_RELEASE_BATCH_NUMBER,
    	INVN_NEED_TYPE,
    	TASK_DTL_ID,
    	TRANS_INVN_TYPE,
    	INVN_TYPE,
    	TASK_LOCN_SEQ,
    	REPL_DIVRT_LOCN,
    	ALLOC_UOM,
    	TASK_CMPL_REF_CODE,
    	NEXT_TASK_ID,
    	REQD_CNTRY_OF_ORGN,
    	TC_ORDER_ID,
    	current_timestamp() AS ARCHIVE_DTTM,
    	_FIVETRAN_DELETED,
    	_FIVETRAN_SYNCED
        
        FROM XBPRDWMRY.PRD_RY_GA_XBORPRDWM.TASK_DTL
        WHERE TASK_DTL.CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE())

        UNION

        SELECT
        NEXT_TASK_SEQ_NBR,
    	CARTON_SEQ_NBR,
    	RSN_CODE,
    	VOCOLLECT_SHORT_FLAG,
    	QTY_PULLD,
    	USER_ID,
    	DEST_LOCN_ID,
    	NEXT_TASK_TYPE,
    	TASK_GENRTN_REF_CODE,
    	CREATE_DATE_TIME,
    	ALLOCATION_KEY,
    	FULL_CNTR_ALLOCD,
    	TASK_CMPL_REF_NBR_SEQ,
    	CNTR_NBR,
    	ALLOC_UOM_QTY,
    	ERLST_START_DATE_TIME,
    	REQD_SKU_ATTR_3,
    	TASK_HDR_ID,
    	REQD_SKU_ATTR_4,
    	CD_MASTER_ID,
    	REQD_SKU_ATTR_5,
    	TASK_TYPE,
    	RESOURCE_GROUP_ID,
    	PKT_SEQ_NBR,
    	PAGE_NBR,
    	ALLOC_INVN_DTL_ID,
    	TASK_PRTY,
    	VOCOLLECT_POSN,
    	SKU_ATTR_2,
    	MISC_ALPHA_FIELD_3,
    	SKU_ATTR_3,
    	MISC_ALPHA_FIELD_1,
    	SKU_ATTR_1,
    	REQD_INVN_TYPE,
    	MISC_ALPHA_FIELD_2,
    	TASK_SEQ_NBR,
    	ITEM_ID,
    	SKU_ATTR_4,
    	SKU_ATTR_5,
    	SLOT_NBR,
    	BATCH_NBR,
    	DEST_LOCN_SEQ,
    	LTST_START_DATE_TIME,
    	TOTE_NBR,
    	WORK_RESOURCE_ID,
    	CNTRY_OF_ORGN,
    	LINE_ITEM_ID,
    	TASK_ID,
    	TASK_GENRTN_REF_NBR,
    	ORIG_REQMT,
    	STAT_CODE,
    	QTY_ALLOC,
    	CURR_WORK_GRP,
    	IS_CHASE_CREATED,
    	PROD_STAT,
    	LTST_CMPL_DATE_TIME,
    	REQD_PROD_STAT,
    	DISTRIBUTION_KEY,
    	PICK_SEQ_CODE,
    	PULL_LOCN_ID,
    	WM_VERSION_ID,
    	PIKR_NBR,
    	TASK_CMPL_REF_NBR,
    	CARTON_NBR,
    	PKT_CTRL_NBR,
    	SUBSTITUTION_FLAG,
    	SUBSLOT_NBR,
    	MOD_DATE_TIME,
    	NEXT_TASK_DESC,
    	REQD_BATCH_NBR,
    	CURR_WORK_AREA,
    	ALLOC_INVN_CODE,
    	REQD_SKU_ATTR_1,
    	REQD_SKU_ATTR_2,
    	WORK_RELEASE_BATCH_NUMBER,
    	INVN_NEED_TYPE,
    	TASK_DTL_ID,
    	TRANS_INVN_TYPE,
    	INVN_TYPE,
    	TASK_LOCN_SEQ,
    	REPL_DIVRT_LOCN,
    	ALLOC_UOM,
    	TASK_CMPL_REF_CODE,
    	NEXT_TASK_ID,
    	REQD_CNTRY_OF_ORGN,
    	TC_ORDER_ID,
    	current_timestamp() AS ARCHIVE_DTTM,
    	_FIVETRAN_DELETED,
    	_FIVETRAN_SYNCED

        FROM XBPRDWMRY.PRD_RY_D_XBORPRDWM.TASK_DTL
        WHERE TASK_DTL.TASK_DTL_ID  NOT IN (SELECT TASK_DTL_ID FROM XBPRDWMRY.PRD_RY_GA_XBORPRDWM.TASK_DTL WHERE CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE()))

        UNION

        SELECT
        NEXT_TASK_SEQ_NBR,
    	CARTON_SEQ_NBR,
    	RSN_CODE,
    	VOCOLLECT_SHORT_FLAG,
    	QTY_PULLD,
    	USER_ID,
    	DEST_LOCN_ID,
    	NEXT_TASK_TYPE,
    	TASK_GENRTN_REF_CODE,
    	CREATE_DATE_TIME,
    	ALLOCATION_KEY,
    	FULL_CNTR_ALLOCD,
    	TASK_CMPL_REF_NBR_SEQ,
    	CNTR_NBR,
    	ALLOC_UOM_QTY,
    	ERLST_START_DATE_TIME,
    	REQD_SKU_ATTR_3,
    	TASK_HDR_ID,
    	REQD_SKU_ATTR_4,
    	CD_MASTER_ID,
    	REQD_SKU_ATTR_5,
    	TASK_TYPE,
    	RESOURCE_GROUP_ID,
    	PKT_SEQ_NBR,
    	PAGE_NBR,
    	ALLOC_INVN_DTL_ID,
    	TASK_PRTY,
    	VOCOLLECT_POSN,
    	SKU_ATTR_2,
    	MISC_ALPHA_FIELD_3,
    	SKU_ATTR_3,
    	MISC_ALPHA_FIELD_1,
    	SKU_ATTR_1,
    	REQD_INVN_TYPE,
    	MISC_ALPHA_FIELD_2,
    	TASK_SEQ_NBR,
    	ITEM_ID,
    	SKU_ATTR_4,
    	SKU_ATTR_5,
    	SLOT_NBR,
    	BATCH_NBR,
    	DEST_LOCN_SEQ,
    	LTST_START_DATE_TIME,
    	TOTE_NBR,
    	WORK_RESOURCE_ID,
    	CNTRY_OF_ORGN,
    	LINE_ITEM_ID,
    	TASK_ID,
    	TASK_GENRTN_REF_NBR,
    	ORIG_REQMT,
    	STAT_CODE,
    	QTY_ALLOC,
    	CURR_WORK_GRP,
    	IS_CHASE_CREATED,
    	PROD_STAT,
    	LTST_CMPL_DATE_TIME,
    	REQD_PROD_STAT,
    	DISTRIBUTION_KEY,
    	PICK_SEQ_CODE,
    	PULL_LOCN_ID,
    	WM_VERSION_ID,
    	PIKR_NBR,
    	TASK_CMPL_REF_NBR,
    	CARTON_NBR,
    	PKT_CTRL_NBR,
    	SUBSTITUTION_FLAG,
    	SUBSLOT_NBR,
    	MOD_DATE_TIME,
    	NEXT_TASK_DESC,
    	REQD_BATCH_NBR,
    	CURR_WORK_AREA,
    	ALLOC_INVN_CODE,
    	REQD_SKU_ATTR_1,
    	REQD_SKU_ATTR_2,
    	WORK_RELEASE_BATCH_NUMBER,
    	INVN_NEED_TYPE,
    	TASK_DTL_ID,
    	TRANS_INVN_TYPE,
    	INVN_TYPE,
    	TASK_LOCN_SEQ,
    	REPL_DIVRT_LOCN,
    	ALLOC_UOM,
    	TASK_CMPL_REF_CODE,
    	NEXT_TASK_ID,
    	REQD_CNTRY_OF_ORGN,
    	TC_ORDER_ID,
    	ARCHIVE_DTTM,
    	_FIVETRAN_DELETED,
    	_FIVETRAN_SYNCED

        FROM XBPRDARCHREYNOSA.ARCHIVE_REYNOSA_XBORPRDARCH.TASK_DTL
        WHERE TASK_DTL.TASK_DTL_ID  NOT IN (
        SELECT TASK_DTL_ID FROM XBPRDWMRY.PRD_RY_GA_XBORPRDWM.TASK_DTL WHERE TASK_DTL.CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE())
        )
        AND TASK_DTL.TASK_DTL_ID  NOT IN (SELECT TASK_DTL_ID FROM XBPRDWMRY.PRD_RY_D_XBORPRDWM.TASK_DTL)
        ;


--- SP_GOLD
CREATE OR REPLACE PROCEDURE ETL.GOLD_ARCH.SP_UPDATE_ETL_TASK_DTL_GOLD()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS
    BEGIN
        MERGE INTO ETL.GOLD_ARCH.TASK_DTL AS TARGET
        USING
        (
            SELECT *, current_timestamp() AS ARCHIVE_DTTM 
            FROM XBPRDWMGOLD.PRD_GOLD_GA_XBWM19WM.TASK_DTL
            WHERE CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE())
        ) AS SOURCE
        ON TARGET.TASK_DTL_ID = SOURCE.TASK_DTL_ID
        WHEN MATCHED AND TARGET.MOD_DATE_TIME < SOURCE.MOD_DATE_TIME 
                    THEN UPDATE SET
                    		TARGET.NEXT_TASK_SEQ_NBR = SOURCE.NEXT_TASK_SEQ_NBR,
                        	TARGET.CARTON_SEQ_NBR = SOURCE.CARTON_SEQ_NBR,
                        	TARGET.RSN_CODE = SOURCE.RSN_CODE,
                        	TARGET.VOCOLLECT_SHORT_FLAG = SOURCE.VOCOLLECT_SHORT_FLAG,
                        	TARGET.QTY_PULLD = SOURCE.QTY_PULLD,
                        	TARGET.USER_ID = SOURCE.USER_ID,
                        	TARGET.DEST_LOCN_ID = SOURCE.DEST_LOCN_ID,
                        	TARGET.NEXT_TASK_TYPE = SOURCE.NEXT_TASK_TYPE,
                        	TARGET.TASK_GENRTN_REF_CODE = SOURCE.TASK_GENRTN_REF_CODE,
                        	TARGET.CREATE_DATE_TIME = SOURCE.CREATE_DATE_TIME,
                        	TARGET.ALLOCATION_KEY = SOURCE.ALLOCATION_KEY,
                        	TARGET.FULL_CNTR_ALLOCD = SOURCE.FULL_CNTR_ALLOCD,
                        	TARGET.TASK_CMPL_REF_NBR_SEQ = SOURCE.TASK_CMPL_REF_NBR_SEQ,
                        	TARGET.CNTR_NBR = SOURCE.CNTR_NBR,
                        	TARGET.ALLOC_UOM_QTY = SOURCE.ALLOC_UOM_QTY,
                        	TARGET.ERLST_START_DATE_TIME = SOURCE.ERLST_START_DATE_TIME,
                        	TARGET.REQD_SKU_ATTR_3 = SOURCE.REQD_SKU_ATTR_3,
                        	TARGET.TASK_HDR_ID = SOURCE.TASK_HDR_ID,
                        	TARGET.REQD_SKU_ATTR_4 = SOURCE.REQD_SKU_ATTR_4,
                        	TARGET.CD_MASTER_ID = SOURCE.CD_MASTER_ID,
                        	TARGET.REQD_SKU_ATTR_5 = SOURCE.REQD_SKU_ATTR_5,
                        	TARGET.TASK_TYPE = SOURCE.TASK_TYPE,
                        	TARGET.RESOURCE_GROUP_ID = SOURCE.RESOURCE_GROUP_ID,
                        	TARGET.PKT_SEQ_NBR = SOURCE.PKT_SEQ_NBR,
                        	TARGET.PAGE_NBR = SOURCE.PAGE_NBR,
                        	TARGET.ALLOC_INVN_DTL_ID = SOURCE.ALLOC_INVN_DTL_ID,
                        	TARGET.TASK_PRTY = SOURCE.TASK_PRTY,
                        	TARGET.VOCOLLECT_POSN = SOURCE.VOCOLLECT_POSN,
                        	TARGET.SKU_ATTR_2 = SOURCE.SKU_ATTR_2,
                        	TARGET.MISC_ALPHA_FIELD_3 = SOURCE.MISC_ALPHA_FIELD_3,
                        	TARGET.SKU_ATTR_3 = SOURCE.SKU_ATTR_3,
                        	TARGET.MISC_ALPHA_FIELD_1 = SOURCE.MISC_ALPHA_FIELD_1,
                        	TARGET.SKU_ATTR_1 = SOURCE.SKU_ATTR_1,
                        	TARGET.REQD_INVN_TYPE = SOURCE.REQD_INVN_TYPE,
                        	TARGET.MISC_ALPHA_FIELD_2 = SOURCE.MISC_ALPHA_FIELD_2,
                        	TARGET.TASK_SEQ_NBR = SOURCE.TASK_SEQ_NBR,
                        	TARGET.ITEM_ID = SOURCE.ITEM_ID,
                        	TARGET.SKU_ATTR_4 = SOURCE.SKU_ATTR_4,
                        	TARGET.SKU_ATTR_5 = SOURCE.SKU_ATTR_5,
                        	TARGET.SLOT_NBR = SOURCE.SLOT_NBR,
                        	TARGET.BATCH_NBR = SOURCE.BATCH_NBR,
                        	TARGET.DEST_LOCN_SEQ = SOURCE.DEST_LOCN_SEQ,
                        	TARGET.LTST_START_DATE_TIME = SOURCE.LTST_START_DATE_TIME,
                        	TARGET.TOTE_NBR = SOURCE.TOTE_NBR,
                        	TARGET.WORK_RESOURCE_ID = SOURCE.WORK_RESOURCE_ID,
                        	TARGET.CNTRY_OF_ORGN = SOURCE.CNTRY_OF_ORGN,
                        	TARGET.LINE_ITEM_ID = SOURCE.LINE_ITEM_ID,
                        	TARGET.TASK_ID = SOURCE.TASK_ID,
                        	TARGET.TASK_GENRTN_REF_NBR = SOURCE.TASK_GENRTN_REF_NBR,
                        	TARGET.ORIG_REQMT = SOURCE.ORIG_REQMT,
                        	TARGET.STAT_CODE = SOURCE.STAT_CODE,
                        	TARGET.QTY_ALLOC = SOURCE.QTY_ALLOC,
                        	TARGET.CURR_WORK_GRP = SOURCE.CURR_WORK_GRP,
                        	TARGET.IS_CHASE_CREATED = SOURCE.IS_CHASE_CREATED,
                        	TARGET.PROD_STAT = SOURCE.PROD_STAT,
                        	TARGET.LTST_CMPL_DATE_TIME = SOURCE.LTST_CMPL_DATE_TIME,
                        	TARGET.REQD_PROD_STAT = SOURCE.REQD_PROD_STAT,
                        	TARGET.DISTRIBUTION_KEY = SOURCE.DISTRIBUTION_KEY,
                        	TARGET.PICK_SEQ_CODE = SOURCE.PICK_SEQ_CODE,
                        	TARGET.PULL_LOCN_ID = SOURCE.PULL_LOCN_ID,
                        	TARGET.WM_VERSION_ID = SOURCE.WM_VERSION_ID,
                        	TARGET.PIKR_NBR = SOURCE.PIKR_NBR,
                        	TARGET.TASK_CMPL_REF_NBR = SOURCE.TASK_CMPL_REF_NBR,
                        	TARGET.CARTON_NBR = SOURCE.CARTON_NBR,
                        	TARGET.PKT_CTRL_NBR = SOURCE.PKT_CTRL_NBR,
                        	TARGET.SUBSTITUTION_FLAG = SOURCE.SUBSTITUTION_FLAG,
                        	TARGET.SUBSLOT_NBR = SOURCE.SUBSLOT_NBR,
                        	TARGET.MOD_DATE_TIME = SOURCE.MOD_DATE_TIME,
                        	TARGET.NEXT_TASK_DESC = SOURCE.NEXT_TASK_DESC,
                        	TARGET.REQD_BATCH_NBR = SOURCE.REQD_BATCH_NBR,
                        	TARGET.CURR_WORK_AREA = SOURCE.CURR_WORK_AREA,
                        	TARGET.ALLOC_INVN_CODE = SOURCE.ALLOC_INVN_CODE,
                        	TARGET.REQD_SKU_ATTR_1 = SOURCE.REQD_SKU_ATTR_1,
                        	TARGET.REQD_SKU_ATTR_2 = SOURCE.REQD_SKU_ATTR_2,
                        	TARGET.WORK_RELEASE_BATCH_NUMBER = SOURCE.WORK_RELEASE_BATCH_NUMBER,
                        	TARGET.INVN_NEED_TYPE = SOURCE.INVN_NEED_TYPE,
                        	TARGET.TASK_DTL_ID = SOURCE.TASK_DTL_ID,
                        	TARGET.TRANS_INVN_TYPE = SOURCE.TRANS_INVN_TYPE,
                        	TARGET.INVN_TYPE = SOURCE.INVN_TYPE,
                        	TARGET.TASK_LOCN_SEQ = SOURCE.TASK_LOCN_SEQ,
                        	TARGET.REPL_DIVRT_LOCN = SOURCE.REPL_DIVRT_LOCN,
                        	TARGET.ALLOC_UOM = SOURCE.ALLOC_UOM,
                        	TARGET.TASK_CMPL_REF_CODE = SOURCE.TASK_CMPL_REF_CODE,
                        	TARGET.NEXT_TASK_ID = SOURCE.NEXT_TASK_ID,
                        	TARGET.REQD_CNTRY_OF_ORGN = SOURCE.REQD_CNTRY_OF_ORGN,
                        	TARGET.TC_ORDER_ID = SOURCE.TC_ORDER_ID,
                        	TARGET.ARCHIVE_DTTM = SOURCE.ARCHIVE_DTTM,
                        	TARGET._FIVETRAN_DELETED = SOURCE._FIVETRAN_DELETED,
                        	TARGET._FIVETRAN_SYNCED = SOURCE._FIVETRAN_SYNCED                  	
        WHEN NOT MATCHED 
        THEN
        INSERT
        (
            NEXT_TASK_SEQ_NBR,
        	CARTON_SEQ_NBR,
        	RSN_CODE,
        	VOCOLLECT_SHORT_FLAG,
        	QTY_PULLD,
        	USER_ID,
        	DEST_LOCN_ID,
        	NEXT_TASK_TYPE,
        	TASK_GENRTN_REF_CODE,
        	CREATE_DATE_TIME,
        	ALLOCATION_KEY,
        	FULL_CNTR_ALLOCD,
        	TASK_CMPL_REF_NBR_SEQ,
        	CNTR_NBR,
        	ALLOC_UOM_QTY,
        	ERLST_START_DATE_TIME,
        	REQD_SKU_ATTR_3,
        	TASK_HDR_ID,
        	REQD_SKU_ATTR_4,
        	CD_MASTER_ID,
        	REQD_SKU_ATTR_5,
        	TASK_TYPE,
        	RESOURCE_GROUP_ID,
        	PKT_SEQ_NBR,
        	PAGE_NBR,
        	ALLOC_INVN_DTL_ID,
        	TASK_PRTY,
        	VOCOLLECT_POSN,
        	SKU_ATTR_2,
        	MISC_ALPHA_FIELD_3,
        	SKU_ATTR_3,
        	MISC_ALPHA_FIELD_1,
        	SKU_ATTR_1,
        	REQD_INVN_TYPE,
        	MISC_ALPHA_FIELD_2,
        	TASK_SEQ_NBR,
        	ITEM_ID,
        	SKU_ATTR_4,
        	SKU_ATTR_5,
        	SLOT_NBR,
        	BATCH_NBR,
        	DEST_LOCN_SEQ,
        	LTST_START_DATE_TIME,
        	TOTE_NBR,
        	WORK_RESOURCE_ID,
        	CNTRY_OF_ORGN,
        	LINE_ITEM_ID,
        	TASK_ID,
        	TASK_GENRTN_REF_NBR,
        	ORIG_REQMT,
        	STAT_CODE,
        	QTY_ALLOC,
        	CURR_WORK_GRP,
        	IS_CHASE_CREATED,
        	PROD_STAT,
        	LTST_CMPL_DATE_TIME,
        	REQD_PROD_STAT,
        	DISTRIBUTION_KEY,
        	PICK_SEQ_CODE,
        	PULL_LOCN_ID,
        	WM_VERSION_ID,
        	PIKR_NBR,
        	TASK_CMPL_REF_NBR,
        	CARTON_NBR,
        	PKT_CTRL_NBR,
        	SUBSTITUTION_FLAG,
        	SUBSLOT_NBR,
        	MOD_DATE_TIME,
        	NEXT_TASK_DESC,
        	REQD_BATCH_NBR,
        	CURR_WORK_AREA,
        	ALLOC_INVN_CODE,
        	REQD_SKU_ATTR_1,
        	REQD_SKU_ATTR_2,
        	WORK_RELEASE_BATCH_NUMBER,
        	INVN_NEED_TYPE,
        	TASK_DTL_ID,
        	TRANS_INVN_TYPE,
        	INVN_TYPE,
        	TASK_LOCN_SEQ,
        	REPL_DIVRT_LOCN,
        	ALLOC_UOM,
        	TASK_CMPL_REF_CODE,
        	NEXT_TASK_ID,
        	REQD_CNTRY_OF_ORGN,
        	TC_ORDER_ID,
        	ARCHIVE_DTTM,
        	_FIVETRAN_DELETED,
        	_FIVETRAN_SYNCED           
        )
        VALUES
        (
            SOURCE.NEXT_TASK_SEQ_NBR,
            SOURCE.CARTON_SEQ_NBR,
            SOURCE.RSN_CODE,
            SOURCE.VOCOLLECT_SHORT_FLAG,
            SOURCE.QTY_PULLD,
            SOURCE.USER_ID,
            SOURCE.DEST_LOCN_ID,
            SOURCE.NEXT_TASK_TYPE,
            SOURCE.TASK_GENRTN_REF_CODE,
            SOURCE.CREATE_DATE_TIME,
            SOURCE.ALLOCATION_KEY,
            SOURCE.FULL_CNTR_ALLOCD,
            SOURCE.TASK_CMPL_REF_NBR_SEQ,
            SOURCE.CNTR_NBR,
            SOURCE.ALLOC_UOM_QTY,
            SOURCE.ERLST_START_DATE_TIME,
            SOURCE.REQD_SKU_ATTR_3,
            SOURCE.TASK_HDR_ID,
            SOURCE.REQD_SKU_ATTR_4,
            SOURCE.CD_MASTER_ID,
            SOURCE.REQD_SKU_ATTR_5,
            SOURCE.TASK_TYPE,
            SOURCE.RESOURCE_GROUP_ID,
            SOURCE.PKT_SEQ_NBR,
            SOURCE.PAGE_NBR,
            SOURCE.ALLOC_INVN_DTL_ID,
            SOURCE.TASK_PRTY,
            SOURCE.VOCOLLECT_POSN,
            SOURCE.SKU_ATTR_2,
            SOURCE.MISC_ALPHA_FIELD_3,
            SOURCE.SKU_ATTR_3,
            SOURCE.MISC_ALPHA_FIELD_1,
            SOURCE.SKU_ATTR_1,
            SOURCE.REQD_INVN_TYPE,
            SOURCE.MISC_ALPHA_FIELD_2,
            SOURCE.TASK_SEQ_NBR,
            SOURCE.ITEM_ID,
            SOURCE.SKU_ATTR_4,
            SOURCE.SKU_ATTR_5,
            SOURCE.SLOT_NBR,
            SOURCE.BATCH_NBR,
            SOURCE.DEST_LOCN_SEQ,
            SOURCE.LTST_START_DATE_TIME,
            SOURCE.TOTE_NBR,
            SOURCE.WORK_RESOURCE_ID,
            SOURCE.CNTRY_OF_ORGN,
            SOURCE.LINE_ITEM_ID,
            SOURCE.TASK_ID,
            SOURCE.TASK_GENRTN_REF_NBR,
            SOURCE.ORIG_REQMT,
            SOURCE.STAT_CODE,
            SOURCE.QTY_ALLOC,
            SOURCE.CURR_WORK_GRP,
            SOURCE.IS_CHASE_CREATED,
            SOURCE.PROD_STAT,
            SOURCE.LTST_CMPL_DATE_TIME,
            SOURCE.REQD_PROD_STAT,
            SOURCE.DISTRIBUTION_KEY,
            SOURCE.PICK_SEQ_CODE,
            SOURCE.PULL_LOCN_ID,
            SOURCE.WM_VERSION_ID,
            SOURCE.PIKR_NBR,
            SOURCE.TASK_CMPL_REF_NBR,
            SOURCE.CARTON_NBR,
            SOURCE.PKT_CTRL_NBR,
            SOURCE.SUBSTITUTION_FLAG,
            SOURCE.SUBSLOT_NBR,
            SOURCE.MOD_DATE_TIME,
            SOURCE.NEXT_TASK_DESC,
            SOURCE.REQD_BATCH_NBR,
            SOURCE.CURR_WORK_AREA,
            SOURCE.ALLOC_INVN_CODE,
            SOURCE.REQD_SKU_ATTR_1,
            SOURCE.REQD_SKU_ATTR_2,
            SOURCE.WORK_RELEASE_BATCH_NUMBER,
            SOURCE.INVN_NEED_TYPE,
            SOURCE.TASK_DTL_ID,
            SOURCE.TRANS_INVN_TYPE,
            SOURCE.INVN_TYPE,
            SOURCE.TASK_LOCN_SEQ,
            SOURCE.REPL_DIVRT_LOCN,
            SOURCE.ALLOC_UOM,
            SOURCE.TASK_CMPL_REF_CODE,
            SOURCE.NEXT_TASK_ID,
            SOURCE.REQD_CNTRY_OF_ORGN,
            SOURCE.TC_ORDER_ID,
            SOURCE.ARCHIVE_DTTM,
            SOURCE._FIVETRAN_DELETED,
            SOURCE._FIVETRAN_SYNCED            
        );
        RETURN ('SUCCESS');
    END;
  
--- SP_SILVER
CREATE OR REPLACE PROCEDURE ETL.SILVER_ARCH.SP_UPDATE_ETL_TASK_DTL_SILVER()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS
    BEGIN
        MERGE INTO ETL.SILVER_ARCH.TASK_DTL AS TARGET
        USING
        (
            SELECT *, current_timestamp() AS ARCHIVE_DTTM 
            FROM XBPRDWMSILVER.PRD_SILVER_GA_XBDBTJ3WM.TASK_DTL
            WHERE CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE())
        ) AS SOURCE
        ON TARGET.TASK_DTL_ID = SOURCE.TASK_DTL_ID
        WHEN MATCHED AND TARGET.MOD_DATE_TIME < SOURCE.MOD_DATE_TIME 
                    THEN UPDATE SET
                    		TARGET.NEXT_TASK_SEQ_NBR = SOURCE.NEXT_TASK_SEQ_NBR,
                        	TARGET.CARTON_SEQ_NBR = SOURCE.CARTON_SEQ_NBR,
                        	TARGET.RSN_CODE = SOURCE.RSN_CODE,
                        	TARGET.VOCOLLECT_SHORT_FLAG = SOURCE.VOCOLLECT_SHORT_FLAG,
                        	TARGET.QTY_PULLD = SOURCE.QTY_PULLD,
                        	TARGET.USER_ID = SOURCE.USER_ID,
                        	TARGET.DEST_LOCN_ID = SOURCE.DEST_LOCN_ID,
                        	TARGET.NEXT_TASK_TYPE = SOURCE.NEXT_TASK_TYPE,
                        	TARGET.TASK_GENRTN_REF_CODE = SOURCE.TASK_GENRTN_REF_CODE,
                        	TARGET.CREATE_DATE_TIME = SOURCE.CREATE_DATE_TIME,
                        	TARGET.ALLOCATION_KEY = SOURCE.ALLOCATION_KEY,
                        	TARGET.FULL_CNTR_ALLOCD = SOURCE.FULL_CNTR_ALLOCD,
                        	TARGET.TASK_CMPL_REF_NBR_SEQ = SOURCE.TASK_CMPL_REF_NBR_SEQ,
                        	TARGET.CNTR_NBR = SOURCE.CNTR_NBR,
                        	TARGET.ALLOC_UOM_QTY = SOURCE.ALLOC_UOM_QTY,
                        	TARGET.ERLST_START_DATE_TIME = SOURCE.ERLST_START_DATE_TIME,
                        	TARGET.REQD_SKU_ATTR_3 = SOURCE.REQD_SKU_ATTR_3,
                        	TARGET.TASK_HDR_ID = SOURCE.TASK_HDR_ID,
                        	TARGET.REQD_SKU_ATTR_4 = SOURCE.REQD_SKU_ATTR_4,
                        	TARGET.CD_MASTER_ID = SOURCE.CD_MASTER_ID,
                        	TARGET.REQD_SKU_ATTR_5 = SOURCE.REQD_SKU_ATTR_5,
                        	TARGET.TASK_TYPE = SOURCE.TASK_TYPE,
                        	TARGET.RESOURCE_GROUP_ID = SOURCE.RESOURCE_GROUP_ID,
                        	TARGET.PKT_SEQ_NBR = SOURCE.PKT_SEQ_NBR,
                        	TARGET.PAGE_NBR = SOURCE.PAGE_NBR,
                        	TARGET.ALLOC_INVN_DTL_ID = SOURCE.ALLOC_INVN_DTL_ID,
                        	TARGET.TASK_PRTY = SOURCE.TASK_PRTY,
                        	TARGET.VOCOLLECT_POSN = SOURCE.VOCOLLECT_POSN,
                        	TARGET.SKU_ATTR_2 = SOURCE.SKU_ATTR_2,
                        	TARGET.MISC_ALPHA_FIELD_3 = SOURCE.MISC_ALPHA_FIELD_3,
                        	TARGET.SKU_ATTR_3 = SOURCE.SKU_ATTR_3,
                        	TARGET.MISC_ALPHA_FIELD_1 = SOURCE.MISC_ALPHA_FIELD_1,
                        	TARGET.SKU_ATTR_1 = SOURCE.SKU_ATTR_1,
                        	TARGET.REQD_INVN_TYPE = SOURCE.REQD_INVN_TYPE,
                        	TARGET.MISC_ALPHA_FIELD_2 = SOURCE.MISC_ALPHA_FIELD_2,
                        	TARGET.TASK_SEQ_NBR = SOURCE.TASK_SEQ_NBR,
                        	TARGET.ITEM_ID = SOURCE.ITEM_ID,
                        	TARGET.SKU_ATTR_4 = SOURCE.SKU_ATTR_4,
                        	TARGET.SKU_ATTR_5 = SOURCE.SKU_ATTR_5,
                        	TARGET.SLOT_NBR = SOURCE.SLOT_NBR,
                        	TARGET.BATCH_NBR = SOURCE.BATCH_NBR,
                        	TARGET.DEST_LOCN_SEQ = SOURCE.DEST_LOCN_SEQ,
                        	TARGET.LTST_START_DATE_TIME = SOURCE.LTST_START_DATE_TIME,
                        	TARGET.TOTE_NBR = SOURCE.TOTE_NBR,
                        	TARGET.WORK_RESOURCE_ID = SOURCE.WORK_RESOURCE_ID,
                        	TARGET.CNTRY_OF_ORGN = SOURCE.CNTRY_OF_ORGN,
                        	TARGET.LINE_ITEM_ID = SOURCE.LINE_ITEM_ID,
                        	TARGET.TASK_ID = SOURCE.TASK_ID,
                        	TARGET.TASK_GENRTN_REF_NBR = SOURCE.TASK_GENRTN_REF_NBR,
                        	TARGET.ORIG_REQMT = SOURCE.ORIG_REQMT,
                        	TARGET.STAT_CODE = SOURCE.STAT_CODE,
                        	TARGET.QTY_ALLOC = SOURCE.QTY_ALLOC,
                        	TARGET.CURR_WORK_GRP = SOURCE.CURR_WORK_GRP,
                        	TARGET.IS_CHASE_CREATED = SOURCE.IS_CHASE_CREATED,
                        	TARGET.PROD_STAT = SOURCE.PROD_STAT,
                        	TARGET.LTST_CMPL_DATE_TIME = SOURCE.LTST_CMPL_DATE_TIME,
                        	TARGET.REQD_PROD_STAT = SOURCE.REQD_PROD_STAT,
                        	TARGET.DISTRIBUTION_KEY = SOURCE.DISTRIBUTION_KEY,
                        	TARGET.PICK_SEQ_CODE = SOURCE.PICK_SEQ_CODE,
                        	TARGET.PULL_LOCN_ID = SOURCE.PULL_LOCN_ID,
                        	TARGET.WM_VERSION_ID = SOURCE.WM_VERSION_ID,
                        	TARGET.PIKR_NBR = SOURCE.PIKR_NBR,
                        	TARGET.TASK_CMPL_REF_NBR = SOURCE.TASK_CMPL_REF_NBR,
                        	TARGET.CARTON_NBR = SOURCE.CARTON_NBR,
                        	TARGET.PKT_CTRL_NBR = SOURCE.PKT_CTRL_NBR,
                        	TARGET.SUBSTITUTION_FLAG = SOURCE.SUBSTITUTION_FLAG,
                        	TARGET.SUBSLOT_NBR = SOURCE.SUBSLOT_NBR,
                        	TARGET.MOD_DATE_TIME = SOURCE.MOD_DATE_TIME,
                        	TARGET.NEXT_TASK_DESC = SOURCE.NEXT_TASK_DESC,
                        	TARGET.REQD_BATCH_NBR = SOURCE.REQD_BATCH_NBR,
                        	TARGET.CURR_WORK_AREA = SOURCE.CURR_WORK_AREA,
                        	TARGET.ALLOC_INVN_CODE = SOURCE.ALLOC_INVN_CODE,
                        	TARGET.REQD_SKU_ATTR_1 = SOURCE.REQD_SKU_ATTR_1,
                        	TARGET.REQD_SKU_ATTR_2 = SOURCE.REQD_SKU_ATTR_2,
                        	TARGET.WORK_RELEASE_BATCH_NUMBER = SOURCE.WORK_RELEASE_BATCH_NUMBER,
                        	TARGET.INVN_NEED_TYPE = SOURCE.INVN_NEED_TYPE,
                        	TARGET.TASK_DTL_ID = SOURCE.TASK_DTL_ID,
                        	TARGET.TRANS_INVN_TYPE = SOURCE.TRANS_INVN_TYPE,
                        	TARGET.INVN_TYPE = SOURCE.INVN_TYPE,
                        	TARGET.TASK_LOCN_SEQ = SOURCE.TASK_LOCN_SEQ,
                        	TARGET.REPL_DIVRT_LOCN = SOURCE.REPL_DIVRT_LOCN,
                        	TARGET.ALLOC_UOM = SOURCE.ALLOC_UOM,
                        	TARGET.TASK_CMPL_REF_CODE = SOURCE.TASK_CMPL_REF_CODE,
                        	TARGET.NEXT_TASK_ID = SOURCE.NEXT_TASK_ID,
                        	TARGET.REQD_CNTRY_OF_ORGN = SOURCE.REQD_CNTRY_OF_ORGN,
                        	TARGET.TC_ORDER_ID = SOURCE.TC_ORDER_ID,
                        	TARGET.ARCHIVE_DTTM = SOURCE.ARCHIVE_DTTM,
                        	TARGET._FIVETRAN_DELETED = SOURCE._FIVETRAN_DELETED,
                        	TARGET._FIVETRAN_SYNCED = SOURCE._FIVETRAN_SYNCED                  	
        WHEN NOT MATCHED 
        THEN
        INSERT
        (
            NEXT_TASK_SEQ_NBR,
        	CARTON_SEQ_NBR,
        	RSN_CODE,
        	VOCOLLECT_SHORT_FLAG,
        	QTY_PULLD,
        	USER_ID,
        	DEST_LOCN_ID,
        	NEXT_TASK_TYPE,
        	TASK_GENRTN_REF_CODE,
        	CREATE_DATE_TIME,
        	ALLOCATION_KEY,
        	FULL_CNTR_ALLOCD,
        	TASK_CMPL_REF_NBR_SEQ,
        	CNTR_NBR,
        	ALLOC_UOM_QTY,
        	ERLST_START_DATE_TIME,
        	REQD_SKU_ATTR_3,
        	TASK_HDR_ID,
        	REQD_SKU_ATTR_4,
        	CD_MASTER_ID,
        	REQD_SKU_ATTR_5,
        	TASK_TYPE,
        	RESOURCE_GROUP_ID,
        	PKT_SEQ_NBR,
        	PAGE_NBR,
        	ALLOC_INVN_DTL_ID,
        	TASK_PRTY,
        	VOCOLLECT_POSN,
        	SKU_ATTR_2,
        	MISC_ALPHA_FIELD_3,
        	SKU_ATTR_3,
        	MISC_ALPHA_FIELD_1,
        	SKU_ATTR_1,
        	REQD_INVN_TYPE,
        	MISC_ALPHA_FIELD_2,
        	TASK_SEQ_NBR,
        	ITEM_ID,
        	SKU_ATTR_4,
        	SKU_ATTR_5,
        	SLOT_NBR,
        	BATCH_NBR,
        	DEST_LOCN_SEQ,
        	LTST_START_DATE_TIME,
        	TOTE_NBR,
        	WORK_RESOURCE_ID,
        	CNTRY_OF_ORGN,
        	LINE_ITEM_ID,
        	TASK_ID,
        	TASK_GENRTN_REF_NBR,
        	ORIG_REQMT,
        	STAT_CODE,
        	QTY_ALLOC,
        	CURR_WORK_GRP,
        	IS_CHASE_CREATED,
        	PROD_STAT,
        	LTST_CMPL_DATE_TIME,
        	REQD_PROD_STAT,
        	DISTRIBUTION_KEY,
        	PICK_SEQ_CODE,
        	PULL_LOCN_ID,
        	WM_VERSION_ID,
        	PIKR_NBR,
        	TASK_CMPL_REF_NBR,
        	CARTON_NBR,
        	PKT_CTRL_NBR,
        	SUBSTITUTION_FLAG,
        	SUBSLOT_NBR,
        	MOD_DATE_TIME,
        	NEXT_TASK_DESC,
        	REQD_BATCH_NBR,
        	CURR_WORK_AREA,
        	ALLOC_INVN_CODE,
        	REQD_SKU_ATTR_1,
        	REQD_SKU_ATTR_2,
        	WORK_RELEASE_BATCH_NUMBER,
        	INVN_NEED_TYPE,
        	TASK_DTL_ID,
        	TRANS_INVN_TYPE,
        	INVN_TYPE,
        	TASK_LOCN_SEQ,
        	REPL_DIVRT_LOCN,
        	ALLOC_UOM,
        	TASK_CMPL_REF_CODE,
        	NEXT_TASK_ID,
        	REQD_CNTRY_OF_ORGN,
        	TC_ORDER_ID,
        	ARCHIVE_DTTM,
        	_FIVETRAN_DELETED,
        	_FIVETRAN_SYNCED           
        )
        VALUES
        (
            SOURCE.NEXT_TASK_SEQ_NBR,
            SOURCE.CARTON_SEQ_NBR,
            SOURCE.RSN_CODE,
            SOURCE.VOCOLLECT_SHORT_FLAG,
            SOURCE.QTY_PULLD,
            SOURCE.USER_ID,
            SOURCE.DEST_LOCN_ID,
            SOURCE.NEXT_TASK_TYPE,
            SOURCE.TASK_GENRTN_REF_CODE,
            SOURCE.CREATE_DATE_TIME,
            SOURCE.ALLOCATION_KEY,
            SOURCE.FULL_CNTR_ALLOCD,
            SOURCE.TASK_CMPL_REF_NBR_SEQ,
            SOURCE.CNTR_NBR,
            SOURCE.ALLOC_UOM_QTY,
            SOURCE.ERLST_START_DATE_TIME,
            SOURCE.REQD_SKU_ATTR_3,
            SOURCE.TASK_HDR_ID,
            SOURCE.REQD_SKU_ATTR_4,
            SOURCE.CD_MASTER_ID,
            SOURCE.REQD_SKU_ATTR_5,
            SOURCE.TASK_TYPE,
            SOURCE.RESOURCE_GROUP_ID,
            SOURCE.PKT_SEQ_NBR,
            SOURCE.PAGE_NBR,
            SOURCE.ALLOC_INVN_DTL_ID,
            SOURCE.TASK_PRTY,
            SOURCE.VOCOLLECT_POSN,
            SOURCE.SKU_ATTR_2,
            SOURCE.MISC_ALPHA_FIELD_3,
            SOURCE.SKU_ATTR_3,
            SOURCE.MISC_ALPHA_FIELD_1,
            SOURCE.SKU_ATTR_1,
            SOURCE.REQD_INVN_TYPE,
            SOURCE.MISC_ALPHA_FIELD_2,
            SOURCE.TASK_SEQ_NBR,
            SOURCE.ITEM_ID,
            SOURCE.SKU_ATTR_4,
            SOURCE.SKU_ATTR_5,
            SOURCE.SLOT_NBR,
            SOURCE.BATCH_NBR,
            SOURCE.DEST_LOCN_SEQ,
            SOURCE.LTST_START_DATE_TIME,
            SOURCE.TOTE_NBR,
            SOURCE.WORK_RESOURCE_ID,
            SOURCE.CNTRY_OF_ORGN,
            SOURCE.LINE_ITEM_ID,
            SOURCE.TASK_ID,
            SOURCE.TASK_GENRTN_REF_NBR,
            SOURCE.ORIG_REQMT,
            SOURCE.STAT_CODE,
            SOURCE.QTY_ALLOC,
            SOURCE.CURR_WORK_GRP,
            SOURCE.IS_CHASE_CREATED,
            SOURCE.PROD_STAT,
            SOURCE.LTST_CMPL_DATE_TIME,
            SOURCE.REQD_PROD_STAT,
            SOURCE.DISTRIBUTION_KEY,
            SOURCE.PICK_SEQ_CODE,
            SOURCE.PULL_LOCN_ID,
            SOURCE.WM_VERSION_ID,
            SOURCE.PIKR_NBR,
            SOURCE.TASK_CMPL_REF_NBR,
            SOURCE.CARTON_NBR,
            SOURCE.PKT_CTRL_NBR,
            SOURCE.SUBSTITUTION_FLAG,
            SOURCE.SUBSLOT_NBR,
            SOURCE.MOD_DATE_TIME,
            SOURCE.NEXT_TASK_DESC,
            SOURCE.REQD_BATCH_NBR,
            SOURCE.CURR_WORK_AREA,
            SOURCE.ALLOC_INVN_CODE,
            SOURCE.REQD_SKU_ATTR_1,
            SOURCE.REQD_SKU_ATTR_2,
            SOURCE.WORK_RELEASE_BATCH_NUMBER,
            SOURCE.INVN_NEED_TYPE,
            SOURCE.TASK_DTL_ID,
            SOURCE.TRANS_INVN_TYPE,
            SOURCE.INVN_TYPE,
            SOURCE.TASK_LOCN_SEQ,
            SOURCE.REPL_DIVRT_LOCN,
            SOURCE.ALLOC_UOM,
            SOURCE.TASK_CMPL_REF_CODE,
            SOURCE.NEXT_TASK_ID,
            SOURCE.REQD_CNTRY_OF_ORGN,
            SOURCE.TC_ORDER_ID,
            SOURCE.ARCHIVE_DTTM,
            SOURCE._FIVETRAN_DELETED,
            SOURCE._FIVETRAN_SYNCED            
        );
        RETURN ('SUCCESS');
    END;
  
--- SP_RY
CREATE OR REPLACE PROCEDURE ETL.RY_ARCH.SP_UPDATE_ETL_TASK_DTL_RY()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS
    BEGIN
        MERGE INTO ETL.RY_ARCH.TASK_DTL AS TARGET
        USING
        (
            SELECT *, current_timestamp() AS ARCHIVE_DTTM 
            FROM XBPRDWMRY.PRD_RY_GA_XBORPRDWM.TASK_DTL
            WHERE CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE())
        ) AS SOURCE
        ON TARGET.TASK_DTL_ID = SOURCE.TASK_DTL_ID
        WHEN MATCHED AND TARGET.MOD_DATE_TIME < SOURCE.MOD_DATE_TIME 
                    THEN UPDATE SET
                    		TARGET.NEXT_TASK_SEQ_NBR = SOURCE.NEXT_TASK_SEQ_NBR,
                        	TARGET.CARTON_SEQ_NBR = SOURCE.CARTON_SEQ_NBR,
                        	TARGET.RSN_CODE = SOURCE.RSN_CODE,
                        	TARGET.VOCOLLECT_SHORT_FLAG = SOURCE.VOCOLLECT_SHORT_FLAG,
                        	TARGET.QTY_PULLD = SOURCE.QTY_PULLD,
                        	TARGET.USER_ID = SOURCE.USER_ID,
                        	TARGET.DEST_LOCN_ID = SOURCE.DEST_LOCN_ID,
                        	TARGET.NEXT_TASK_TYPE = SOURCE.NEXT_TASK_TYPE,
                        	TARGET.TASK_GENRTN_REF_CODE = SOURCE.TASK_GENRTN_REF_CODE,
                        	TARGET.CREATE_DATE_TIME = SOURCE.CREATE_DATE_TIME,
                        	TARGET.ALLOCATION_KEY = SOURCE.ALLOCATION_KEY,
                        	TARGET.FULL_CNTR_ALLOCD = SOURCE.FULL_CNTR_ALLOCD,
                        	TARGET.TASK_CMPL_REF_NBR_SEQ = SOURCE.TASK_CMPL_REF_NBR_SEQ,
                        	TARGET.CNTR_NBR = SOURCE.CNTR_NBR,
                        	TARGET.ALLOC_UOM_QTY = SOURCE.ALLOC_UOM_QTY,
                        	TARGET.ERLST_START_DATE_TIME = SOURCE.ERLST_START_DATE_TIME,
                        	TARGET.REQD_SKU_ATTR_3 = SOURCE.REQD_SKU_ATTR_3,
                        	TARGET.TASK_HDR_ID = SOURCE.TASK_HDR_ID,
                        	TARGET.REQD_SKU_ATTR_4 = SOURCE.REQD_SKU_ATTR_4,
                        	TARGET.CD_MASTER_ID = SOURCE.CD_MASTER_ID,
                        	TARGET.REQD_SKU_ATTR_5 = SOURCE.REQD_SKU_ATTR_5,
                        	TARGET.TASK_TYPE = SOURCE.TASK_TYPE,
                        	TARGET.RESOURCE_GROUP_ID = SOURCE.RESOURCE_GROUP_ID,
                        	TARGET.PKT_SEQ_NBR = SOURCE.PKT_SEQ_NBR,
                        	TARGET.PAGE_NBR = SOURCE.PAGE_NBR,
                        	TARGET.ALLOC_INVN_DTL_ID = SOURCE.ALLOC_INVN_DTL_ID,
                        	TARGET.TASK_PRTY = SOURCE.TASK_PRTY,
                        	TARGET.VOCOLLECT_POSN = SOURCE.VOCOLLECT_POSN,
                        	TARGET.SKU_ATTR_2 = SOURCE.SKU_ATTR_2,
                        	TARGET.MISC_ALPHA_FIELD_3 = SOURCE.MISC_ALPHA_FIELD_3,
                        	TARGET.SKU_ATTR_3 = SOURCE.SKU_ATTR_3,
                        	TARGET.MISC_ALPHA_FIELD_1 = SOURCE.MISC_ALPHA_FIELD_1,
                        	TARGET.SKU_ATTR_1 = SOURCE.SKU_ATTR_1,
                        	TARGET.REQD_INVN_TYPE = SOURCE.REQD_INVN_TYPE,
                        	TARGET.MISC_ALPHA_FIELD_2 = SOURCE.MISC_ALPHA_FIELD_2,
                        	TARGET.TASK_SEQ_NBR = SOURCE.TASK_SEQ_NBR,
                        	TARGET.ITEM_ID = SOURCE.ITEM_ID,
                        	TARGET.SKU_ATTR_4 = SOURCE.SKU_ATTR_4,
                        	TARGET.SKU_ATTR_5 = SOURCE.SKU_ATTR_5,
                        	TARGET.SLOT_NBR = SOURCE.SLOT_NBR,
                        	TARGET.BATCH_NBR = SOURCE.BATCH_NBR,
                        	TARGET.DEST_LOCN_SEQ = SOURCE.DEST_LOCN_SEQ,
                        	TARGET.LTST_START_DATE_TIME = SOURCE.LTST_START_DATE_TIME,
                        	TARGET.TOTE_NBR = SOURCE.TOTE_NBR,
                        	TARGET.WORK_RESOURCE_ID = SOURCE.WORK_RESOURCE_ID,
                        	TARGET.CNTRY_OF_ORGN = SOURCE.CNTRY_OF_ORGN,
                        	TARGET.LINE_ITEM_ID = SOURCE.LINE_ITEM_ID,
                        	TARGET.TASK_ID = SOURCE.TASK_ID,
                        	TARGET.TASK_GENRTN_REF_NBR = SOURCE.TASK_GENRTN_REF_NBR,
                        	TARGET.ORIG_REQMT = SOURCE.ORIG_REQMT,
                        	TARGET.STAT_CODE = SOURCE.STAT_CODE,
                        	TARGET.QTY_ALLOC = SOURCE.QTY_ALLOC,
                        	TARGET.CURR_WORK_GRP = SOURCE.CURR_WORK_GRP,
                        	TARGET.IS_CHASE_CREATED = SOURCE.IS_CHASE_CREATED,
                        	TARGET.PROD_STAT = SOURCE.PROD_STAT,
                        	TARGET.LTST_CMPL_DATE_TIME = SOURCE.LTST_CMPL_DATE_TIME,
                        	TARGET.REQD_PROD_STAT = SOURCE.REQD_PROD_STAT,
                        	TARGET.DISTRIBUTION_KEY = SOURCE.DISTRIBUTION_KEY,
                        	TARGET.PICK_SEQ_CODE = SOURCE.PICK_SEQ_CODE,
                        	TARGET.PULL_LOCN_ID = SOURCE.PULL_LOCN_ID,
                        	TARGET.WM_VERSION_ID = SOURCE.WM_VERSION_ID,
                        	TARGET.PIKR_NBR = SOURCE.PIKR_NBR,
                        	TARGET.TASK_CMPL_REF_NBR = SOURCE.TASK_CMPL_REF_NBR,
                        	TARGET.CARTON_NBR = SOURCE.CARTON_NBR,
                        	TARGET.PKT_CTRL_NBR = SOURCE.PKT_CTRL_NBR,
                        	TARGET.SUBSTITUTION_FLAG = SOURCE.SUBSTITUTION_FLAG,
                        	TARGET.SUBSLOT_NBR = SOURCE.SUBSLOT_NBR,
                        	TARGET.MOD_DATE_TIME = SOURCE.MOD_DATE_TIME,
                        	TARGET.NEXT_TASK_DESC = SOURCE.NEXT_TASK_DESC,
                        	TARGET.REQD_BATCH_NBR = SOURCE.REQD_BATCH_NBR,
                        	TARGET.CURR_WORK_AREA = SOURCE.CURR_WORK_AREA,
                        	TARGET.ALLOC_INVN_CODE = SOURCE.ALLOC_INVN_CODE,
                        	TARGET.REQD_SKU_ATTR_1 = SOURCE.REQD_SKU_ATTR_1,
                        	TARGET.REQD_SKU_ATTR_2 = SOURCE.REQD_SKU_ATTR_2,
                        	TARGET.WORK_RELEASE_BATCH_NUMBER = SOURCE.WORK_RELEASE_BATCH_NUMBER,
                        	TARGET.INVN_NEED_TYPE = SOURCE.INVN_NEED_TYPE,
                        	TARGET.TASK_DTL_ID = SOURCE.TASK_DTL_ID,
                        	TARGET.TRANS_INVN_TYPE = SOURCE.TRANS_INVN_TYPE,
                        	TARGET.INVN_TYPE = SOURCE.INVN_TYPE,
                        	TARGET.TASK_LOCN_SEQ = SOURCE.TASK_LOCN_SEQ,
                        	TARGET.REPL_DIVRT_LOCN = SOURCE.REPL_DIVRT_LOCN,
                        	TARGET.ALLOC_UOM = SOURCE.ALLOC_UOM,
                        	TARGET.TASK_CMPL_REF_CODE = SOURCE.TASK_CMPL_REF_CODE,
                        	TARGET.NEXT_TASK_ID = SOURCE.NEXT_TASK_ID,
                        	TARGET.REQD_CNTRY_OF_ORGN = SOURCE.REQD_CNTRY_OF_ORGN,
                        	TARGET.TC_ORDER_ID = SOURCE.TC_ORDER_ID,
                        	TARGET.ARCHIVE_DTTM = SOURCE.ARCHIVE_DTTM,
                        	TARGET._FIVETRAN_DELETED = SOURCE._FIVETRAN_DELETED,
                        	TARGET._FIVETRAN_SYNCED = SOURCE._FIVETRAN_SYNCED                  	
        WHEN NOT MATCHED 
        THEN
        INSERT
        (
            NEXT_TASK_SEQ_NBR,
        	CARTON_SEQ_NBR,
        	RSN_CODE,
        	VOCOLLECT_SHORT_FLAG,
        	QTY_PULLD,
        	USER_ID,
        	DEST_LOCN_ID,
        	NEXT_TASK_TYPE,
        	TASK_GENRTN_REF_CODE,
        	CREATE_DATE_TIME,
        	ALLOCATION_KEY,
        	FULL_CNTR_ALLOCD,
        	TASK_CMPL_REF_NBR_SEQ,
        	CNTR_NBR,
        	ALLOC_UOM_QTY,
        	ERLST_START_DATE_TIME,
        	REQD_SKU_ATTR_3,
        	TASK_HDR_ID,
        	REQD_SKU_ATTR_4,
        	CD_MASTER_ID,
        	REQD_SKU_ATTR_5,
        	TASK_TYPE,
        	RESOURCE_GROUP_ID,
        	PKT_SEQ_NBR,
        	PAGE_NBR,
        	ALLOC_INVN_DTL_ID,
        	TASK_PRTY,
        	VOCOLLECT_POSN,
        	SKU_ATTR_2,
        	MISC_ALPHA_FIELD_3,
        	SKU_ATTR_3,
        	MISC_ALPHA_FIELD_1,
        	SKU_ATTR_1,
        	REQD_INVN_TYPE,
        	MISC_ALPHA_FIELD_2,
        	TASK_SEQ_NBR,
        	ITEM_ID,
        	SKU_ATTR_4,
        	SKU_ATTR_5,
        	SLOT_NBR,
        	BATCH_NBR,
        	DEST_LOCN_SEQ,
        	LTST_START_DATE_TIME,
        	TOTE_NBR,
        	WORK_RESOURCE_ID,
        	CNTRY_OF_ORGN,
        	LINE_ITEM_ID,
        	TASK_ID,
        	TASK_GENRTN_REF_NBR,
        	ORIG_REQMT,
        	STAT_CODE,
        	QTY_ALLOC,
        	CURR_WORK_GRP,
        	IS_CHASE_CREATED,
        	PROD_STAT,
        	LTST_CMPL_DATE_TIME,
        	REQD_PROD_STAT,
        	DISTRIBUTION_KEY,
        	PICK_SEQ_CODE,
        	PULL_LOCN_ID,
        	WM_VERSION_ID,
        	PIKR_NBR,
        	TASK_CMPL_REF_NBR,
        	CARTON_NBR,
        	PKT_CTRL_NBR,
        	SUBSTITUTION_FLAG,
        	SUBSLOT_NBR,
        	MOD_DATE_TIME,
        	NEXT_TASK_DESC,
        	REQD_BATCH_NBR,
        	CURR_WORK_AREA,
        	ALLOC_INVN_CODE,
        	REQD_SKU_ATTR_1,
        	REQD_SKU_ATTR_2,
        	WORK_RELEASE_BATCH_NUMBER,
        	INVN_NEED_TYPE,
        	TASK_DTL_ID,
        	TRANS_INVN_TYPE,
        	INVN_TYPE,
        	TASK_LOCN_SEQ,
        	REPL_DIVRT_LOCN,
        	ALLOC_UOM,
        	TASK_CMPL_REF_CODE,
        	NEXT_TASK_ID,
        	REQD_CNTRY_OF_ORGN,
        	TC_ORDER_ID,
        	ARCHIVE_DTTM,
        	_FIVETRAN_DELETED,
        	_FIVETRAN_SYNCED           
        )
        VALUES
        (
            SOURCE.NEXT_TASK_SEQ_NBR,
            SOURCE.CARTON_SEQ_NBR,
            SOURCE.RSN_CODE,
            SOURCE.VOCOLLECT_SHORT_FLAG,
            SOURCE.QTY_PULLD,
            SOURCE.USER_ID,
            SOURCE.DEST_LOCN_ID,
            SOURCE.NEXT_TASK_TYPE,
            SOURCE.TASK_GENRTN_REF_CODE,
            SOURCE.CREATE_DATE_TIME,
            SOURCE.ALLOCATION_KEY,
            SOURCE.FULL_CNTR_ALLOCD,
            SOURCE.TASK_CMPL_REF_NBR_SEQ,
            SOURCE.CNTR_NBR,
            SOURCE.ALLOC_UOM_QTY,
            SOURCE.ERLST_START_DATE_TIME,
            SOURCE.REQD_SKU_ATTR_3,
            SOURCE.TASK_HDR_ID,
            SOURCE.REQD_SKU_ATTR_4,
            SOURCE.CD_MASTER_ID,
            SOURCE.REQD_SKU_ATTR_5,
            SOURCE.TASK_TYPE,
            SOURCE.RESOURCE_GROUP_ID,
            SOURCE.PKT_SEQ_NBR,
            SOURCE.PAGE_NBR,
            SOURCE.ALLOC_INVN_DTL_ID,
            SOURCE.TASK_PRTY,
            SOURCE.VOCOLLECT_POSN,
            SOURCE.SKU_ATTR_2,
            SOURCE.MISC_ALPHA_FIELD_3,
            SOURCE.SKU_ATTR_3,
            SOURCE.MISC_ALPHA_FIELD_1,
            SOURCE.SKU_ATTR_1,
            SOURCE.REQD_INVN_TYPE,
            SOURCE.MISC_ALPHA_FIELD_2,
            SOURCE.TASK_SEQ_NBR,
            SOURCE.ITEM_ID,
            SOURCE.SKU_ATTR_4,
            SOURCE.SKU_ATTR_5,
            SOURCE.SLOT_NBR,
            SOURCE.BATCH_NBR,
            SOURCE.DEST_LOCN_SEQ,
            SOURCE.LTST_START_DATE_TIME,
            SOURCE.TOTE_NBR,
            SOURCE.WORK_RESOURCE_ID,
            SOURCE.CNTRY_OF_ORGN,
            SOURCE.LINE_ITEM_ID,
            SOURCE.TASK_ID,
            SOURCE.TASK_GENRTN_REF_NBR,
            SOURCE.ORIG_REQMT,
            SOURCE.STAT_CODE,
            SOURCE.QTY_ALLOC,
            SOURCE.CURR_WORK_GRP,
            SOURCE.IS_CHASE_CREATED,
            SOURCE.PROD_STAT,
            SOURCE.LTST_CMPL_DATE_TIME,
            SOURCE.REQD_PROD_STAT,
            SOURCE.DISTRIBUTION_KEY,
            SOURCE.PICK_SEQ_CODE,
            SOURCE.PULL_LOCN_ID,
            SOURCE.WM_VERSION_ID,
            SOURCE.PIKR_NBR,
            SOURCE.TASK_CMPL_REF_NBR,
            SOURCE.CARTON_NBR,
            SOURCE.PKT_CTRL_NBR,
            SOURCE.SUBSTITUTION_FLAG,
            SOURCE.SUBSLOT_NBR,
            SOURCE.MOD_DATE_TIME,
            SOURCE.NEXT_TASK_DESC,
            SOURCE.REQD_BATCH_NBR,
            SOURCE.CURR_WORK_AREA,
            SOURCE.ALLOC_INVN_CODE,
            SOURCE.REQD_SKU_ATTR_1,
            SOURCE.REQD_SKU_ATTR_2,
            SOURCE.WORK_RELEASE_BATCH_NUMBER,
            SOURCE.INVN_NEED_TYPE,
            SOURCE.TASK_DTL_ID,
            SOURCE.TRANS_INVN_TYPE,
            SOURCE.INVN_TYPE,
            SOURCE.TASK_LOCN_SEQ,
            SOURCE.REPL_DIVRT_LOCN,
            SOURCE.ALLOC_UOM,
            SOURCE.TASK_CMPL_REF_CODE,
            SOURCE.NEXT_TASK_ID,
            SOURCE.REQD_CNTRY_OF_ORGN,
            SOURCE.TC_ORDER_ID,
            SOURCE.ARCHIVE_DTTM,
            SOURCE._FIVETRAN_DELETED,
            SOURCE._FIVETRAN_SYNCED            
        );
        RETURN ('SUCCESS');
    END;
  