---- GOLD
-- XBPRDWMGOLD.PRD_GOLD_GA_XBWM19WM.TASK_HDR
-- XBPRDWMGOLD.PRD_GOLD_D_XBWM19WM.TASK_HDR
-- XBPRDARCHGOLD.ARCH_GOLD_F_XBWM19ARCH.TASK_HDR
---- SILVER
-- XBPRDWMSILVER.PRD_SILVER_GA_XBDBTJ3WM.TASK_HDR
-- XBPRDWMSILVER.PRD_SILVER_D_XBDBTJ3WM.TASK_HDR
-- XBPRDARCHSILVER.ARCH_SILVER_F_XBWM19ARCH.TASK_HDR
---- RY
-- XBPRDWMRY.PRD_RY_GA_XBORPRDWM.TASK_HDR
-- XBPRDWMRY.PRD_RY_D_XBORPRDWM.TASK_HDR
-- XBPRDARCHREYNOSA.ARCHIVE_REYNOSA_XBORPRDARCH.TASK_HDR

---- GOLD
CREATE OR REPLACE TABLE ETL.GOLD_ARCH.TASK_HDR
AS
    SELECT
        TASK_HDR_ID,
    	ESTIMATED_TIME,
    	USER_ID,
    	PRT_TASK_LIST_FLAG,
    	VOCO_INTRNL_REVERSE_ID,
    	TASK_GENRTN_REF_CODE,
    	CREATE_DATE_TIME,
    	END_CURR_WORK_GRP,
    	LOCN_HDR_ID,
    	END_DEST_WORK_AREA,
    	ERLST_START_DATE_TIME,
    	MHE_FLAG,
    	TASK_DESC,
    	TASK_TYPE,
    	DOC_ID,
    	PICK_CART_TYPE,
    	CURR_TASK_PRTY,
    	RULE_ID,
    	OWNER_USER_ID,
    	ITEM_ID,
    	END_AREA,
    	TASK_BATCH,
    	VOCOLLECT_ASSIGN_ID,
    	TASK_RULE_PARM_ID,
    	ORIG_TASK_ID,
    	START_CURR_WORK_AREA,
    	LTST_START_DATE_TIME,
    	START_DEST_WORK_GRP,
    	END_CURR_WORK_AREA,
    	START_DEST_WORK_AREA,
    	NEED_ID,
    	TASK_ID,
    	TASK_GENRTN_REF_NBR,
    	STAT_CODE,
    	ESTIMATED_DISTANCE,
    	START_CURR_WORK_GRP,
    	BEGIN_AISLE,
    	LTST_CMPL_DATE_TIME,
    	WHSE,
    	WM_VERSION_ID,
    	TASK_CMPL_REF_NBR,
    	PICK_TO_TOTE_FLAG,
    	CURR_LOCN_ID,
    	BEGIN_ZONE,
    	TASK_PARM_ID,
    	REPRINT_COUNT,
    	MOD_DATE_TIME,
    	END_DEST_WORK_GRP,
    	ONE_USER_PER_GRP,
    	XPECTD_DURTN,
    	END_AISLE,
    	DFLT_TASK_PRTY,
    	INVN_NEED_TYPE,
    	BEGIN_AREA,
    	RPT_PRTR_REQSTR,
    	INVN_TYPE,
    	EXCEPTION_CODE,
    	CURR_USER_ID,
    	END_ZONE,
    	TASK_CMPL_REF_CODE,
    	RLS_DATE_TIME,
    	NEXT_TASK_ID,
    	ACTL_DURTN,
    	current_timestamp() AS ARCHIVE_DTTM,
    	MHE_ORD_STATE,
    	_FIVETRAN_DELETED,
    	_FIVETRAN_SYNCED
        FROM XBPRDWMGOLD.PRD_GOLD_GA_XBWM19WM.TASK_HDR
        WHERE TASK_HDR.CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE())

        UNION

        SELECT
        TASK_HDR_ID,
    	ESTIMATED_TIME,
    	USER_ID,
    	PRT_TASK_LIST_FLAG,
    	VOCO_INTRNL_REVERSE_ID,
    	TASK_GENRTN_REF_CODE,
    	CREATE_DATE_TIME,
    	END_CURR_WORK_GRP,
    	LOCN_HDR_ID,
    	END_DEST_WORK_AREA,
    	ERLST_START_DATE_TIME,
    	MHE_FLAG,
    	TASK_DESC,
    	TASK_TYPE,
    	DOC_ID,
    	PICK_CART_TYPE,
    	CURR_TASK_PRTY,
    	RULE_ID,
    	OWNER_USER_ID,
    	ITEM_ID,
    	END_AREA,
    	TASK_BATCH,
    	VOCOLLECT_ASSIGN_ID,
    	TASK_RULE_PARM_ID,
    	ORIG_TASK_ID,
    	START_CURR_WORK_AREA,
    	LTST_START_DATE_TIME,
    	START_DEST_WORK_GRP,
    	END_CURR_WORK_AREA,
    	START_DEST_WORK_AREA,
    	NEED_ID,
    	TASK_ID,
    	TASK_GENRTN_REF_NBR,
    	STAT_CODE,
    	ESTIMATED_DISTANCE,
    	START_CURR_WORK_GRP,
    	BEGIN_AISLE,
    	LTST_CMPL_DATE_TIME,
    	WHSE,
    	WM_VERSION_ID,
    	TASK_CMPL_REF_NBR,
    	PICK_TO_TOTE_FLAG,
    	CURR_LOCN_ID,
    	BEGIN_ZONE,
    	TASK_PARM_ID,
    	REPRINT_COUNT,
    	MOD_DATE_TIME,
    	END_DEST_WORK_GRP,
    	ONE_USER_PER_GRP,
    	XPECTD_DURTN,
    	END_AISLE,
    	DFLT_TASK_PRTY,
    	INVN_NEED_TYPE,
    	BEGIN_AREA,
    	RPT_PRTR_REQSTR,
    	INVN_TYPE,
    	EXCEPTION_CODE,
    	CURR_USER_ID,
    	END_ZONE,
    	TASK_CMPL_REF_CODE,
    	RLS_DATE_TIME,
    	NEXT_TASK_ID,
    	ACTL_DURTN,
    	current_timestamp() AS ARCHIVE_DTTM,
    	MHE_ORD_STATE,
    	_FIVETRAN_DELETED,
    	_FIVETRAN_SYNCED

        FROM XBPRDWMGOLD.PRD_GOLD_D_XBWM19WM.TASK_HDR
        WHERE TASK_HDR.TASK_HDR_ID  NOT IN (SELECT TASK_HDR_ID FROM XBPRDWMGOLD.PRD_GOLD_GA_XBWM19WM.TASK_HDR WHERE CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE()))

        UNION

        SELECT
        TASK_HDR_ID,
    	ESTIMATED_TIME,
    	USER_ID,
    	PRT_TASK_LIST_FLAG,
    	VOCO_INTRNL_REVERSE_ID,
    	TASK_GENRTN_REF_CODE,
    	CREATE_DATE_TIME,
    	END_CURR_WORK_GRP,
    	LOCN_HDR_ID,
    	END_DEST_WORK_AREA,
    	ERLST_START_DATE_TIME,
    	MHE_FLAG,
    	TASK_DESC,
    	TASK_TYPE,
    	DOC_ID,
    	PICK_CART_TYPE,
    	CURR_TASK_PRTY,
    	RULE_ID,
    	OWNER_USER_ID,
    	ITEM_ID,
    	END_AREA,
    	TASK_BATCH,
    	VOCOLLECT_ASSIGN_ID,
    	TASK_RULE_PARM_ID,
    	ORIG_TASK_ID,
    	START_CURR_WORK_AREA,
    	LTST_START_DATE_TIME,
    	START_DEST_WORK_GRP,
    	END_CURR_WORK_AREA,
    	START_DEST_WORK_AREA,
    	NEED_ID,
    	TASK_ID,
    	TASK_GENRTN_REF_NBR,
    	STAT_CODE,
    	ESTIMATED_DISTANCE,
    	START_CURR_WORK_GRP,
    	BEGIN_AISLE,
    	LTST_CMPL_DATE_TIME,
    	WHSE,
    	WM_VERSION_ID,
    	TASK_CMPL_REF_NBR,
    	PICK_TO_TOTE_FLAG,
    	CURR_LOCN_ID,
    	BEGIN_ZONE,
    	TASK_PARM_ID,
    	REPRINT_COUNT,
    	MOD_DATE_TIME,
    	END_DEST_WORK_GRP,
    	ONE_USER_PER_GRP,
    	XPECTD_DURTN,
    	END_AISLE,
    	DFLT_TASK_PRTY,
    	INVN_NEED_TYPE,
    	BEGIN_AREA,
    	RPT_PRTR_REQSTR,
    	INVN_TYPE,
    	EXCEPTION_CODE,
    	CURR_USER_ID,
    	END_ZONE,
    	TASK_CMPL_REF_CODE,
    	RLS_DATE_TIME,
    	NEXT_TASK_ID,
    	ACTL_DURTN,
    	ARCHIVE_DTTM,
    	MHE_ORD_STATE,
    	_FIVETRAN_DELETED,
    	_FIVETRAN_SYNCED

        FROM XBPRDARCHGOLD.ARCH_GOLD_F_XBWM19ARCH.TASK_HDR
        WHERE TASK_HDR.TASK_HDR_ID  NOT IN (
        SELECT TASK_HDR_ID FROM XBPRDWMGOLD.PRD_GOLD_GA_XBWM19WM.TASK_HDR WHERE TASK_HDR.CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE())
        )
        AND TASK_HDR.TASK_HDR_ID  NOT IN (SELECT TASK_HDR_ID FROM XBPRDWMGOLD.PRD_GOLD_D_XBWM19WM.TASK_HDR)
        ;

--- SILVER
CREATE OR REPLACE TABLE ETL.SILVER_ARCH.TASK_HDR
AS
    SELECT
        TASK_HDR_ID,
    	ESTIMATED_TIME,
    	USER_ID,
    	PRT_TASK_LIST_FLAG,
    	VOCO_INTRNL_REVERSE_ID,
    	TASK_GENRTN_REF_CODE,
    	CREATE_DATE_TIME,
    	END_CURR_WORK_GRP,
    	LOCN_HDR_ID,
    	END_DEST_WORK_AREA,
    	ERLST_START_DATE_TIME,
    	MHE_FLAG,
    	TASK_DESC,
    	TASK_TYPE,
    	DOC_ID,
    	PICK_CART_TYPE,
    	CURR_TASK_PRTY,
    	RULE_ID,
    	OWNER_USER_ID,
    	ITEM_ID,
    	END_AREA,
    	TASK_BATCH,
    	VOCOLLECT_ASSIGN_ID,
    	TASK_RULE_PARM_ID,
    	ORIG_TASK_ID,
    	START_CURR_WORK_AREA,
    	LTST_START_DATE_TIME,
    	START_DEST_WORK_GRP,
    	END_CURR_WORK_AREA,
    	START_DEST_WORK_AREA,
    	NEED_ID,
    	TASK_ID,
    	TASK_GENRTN_REF_NBR,
    	STAT_CODE,
    	ESTIMATED_DISTANCE,
    	START_CURR_WORK_GRP,
    	BEGIN_AISLE,
    	LTST_CMPL_DATE_TIME,
    	WHSE,
    	WM_VERSION_ID,
    	TASK_CMPL_REF_NBR,
    	PICK_TO_TOTE_FLAG,
    	CURR_LOCN_ID,
    	BEGIN_ZONE,
    	TASK_PARM_ID,
    	REPRINT_COUNT,
    	MOD_DATE_TIME,
    	END_DEST_WORK_GRP,
    	ONE_USER_PER_GRP,
    	XPECTD_DURTN,
    	END_AISLE,
    	DFLT_TASK_PRTY,
    	INVN_NEED_TYPE,
    	BEGIN_AREA,
    	RPT_PRTR_REQSTR,
    	INVN_TYPE,
    	EXCEPTION_CODE,
    	CURR_USER_ID,
    	END_ZONE,
    	TASK_CMPL_REF_CODE,
    	RLS_DATE_TIME,
    	NEXT_TASK_ID,
    	ACTL_DURTN,
    	current_timestamp() AS ARCHIVE_DTTM,
    	MHE_ORD_STATE,
    	_FIVETRAN_DELETED,
    	_FIVETRAN_SYNCED
        FROM XBPRDWMSILVER.PRD_SILVER_GA_XBDBTJ3WM.TASK_HDR
        WHERE TASK_HDR.CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE())

        UNION

        SELECT
        TASK_HDR_ID,
    	ESTIMATED_TIME,
    	USER_ID,
    	PRT_TASK_LIST_FLAG,
    	VOCO_INTRNL_REVERSE_ID,
    	TASK_GENRTN_REF_CODE,
    	CREATE_DATE_TIME,
    	END_CURR_WORK_GRP,
    	LOCN_HDR_ID,
    	END_DEST_WORK_AREA,
    	ERLST_START_DATE_TIME,
    	MHE_FLAG,
    	TASK_DESC,
    	TASK_TYPE,
    	DOC_ID,
    	PICK_CART_TYPE,
    	CURR_TASK_PRTY,
    	RULE_ID,
    	OWNER_USER_ID,
    	ITEM_ID,
    	END_AREA,
    	TASK_BATCH,
    	VOCOLLECT_ASSIGN_ID,
    	TASK_RULE_PARM_ID,
    	ORIG_TASK_ID,
    	START_CURR_WORK_AREA,
    	LTST_START_DATE_TIME,
    	START_DEST_WORK_GRP,
    	END_CURR_WORK_AREA,
    	START_DEST_WORK_AREA,
    	NEED_ID,
    	TASK_ID,
    	TASK_GENRTN_REF_NBR,
    	STAT_CODE,
    	ESTIMATED_DISTANCE,
    	START_CURR_WORK_GRP,
    	BEGIN_AISLE,
    	LTST_CMPL_DATE_TIME,
    	WHSE,
    	WM_VERSION_ID,
    	TASK_CMPL_REF_NBR,
    	PICK_TO_TOTE_FLAG,
    	CURR_LOCN_ID,
    	BEGIN_ZONE,
    	TASK_PARM_ID,
    	REPRINT_COUNT,
    	MOD_DATE_TIME,
    	END_DEST_WORK_GRP,
    	ONE_USER_PER_GRP,
    	XPECTD_DURTN,
    	END_AISLE,
    	DFLT_TASK_PRTY,
    	INVN_NEED_TYPE,
    	BEGIN_AREA,
    	RPT_PRTR_REQSTR,
    	INVN_TYPE,
    	EXCEPTION_CODE,
    	CURR_USER_ID,
    	END_ZONE,
    	TASK_CMPL_REF_CODE,
    	RLS_DATE_TIME,
    	NEXT_TASK_ID,
    	ACTL_DURTN,
    	current_timestamp() AS ARCHIVE_DTTM,
    	MHE_ORD_STATE,
    	_FIVETRAN_DELETED,
    	_FIVETRAN_SYNCED

        FROM XBPRDWMSILVER.PRD_SILVER_D_XBDBTJ3WM.TASK_HDR
        WHERE TASK_HDR.TASK_HDR_ID  NOT IN (SELECT TASK_HDR_ID FROM XBPRDWMSILVER.PRD_SILVER_GA_XBDBTJ3WM.TASK_HDR WHERE CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE()))

        UNION

        SELECT
        TASK_HDR_ID,
    	ESTIMATED_TIME,
    	USER_ID,
    	PRT_TASK_LIST_FLAG,
    	VOCO_INTRNL_REVERSE_ID,
    	TASK_GENRTN_REF_CODE,
    	CREATE_DATE_TIME,
    	END_CURR_WORK_GRP,
    	LOCN_HDR_ID,
    	END_DEST_WORK_AREA,
    	ERLST_START_DATE_TIME,
    	MHE_FLAG,
    	TASK_DESC,
    	TASK_TYPE,
    	DOC_ID,
    	PICK_CART_TYPE,
    	CURR_TASK_PRTY,
    	RULE_ID,
    	OWNER_USER_ID,
    	ITEM_ID,
    	END_AREA,
    	TASK_BATCH,
    	VOCOLLECT_ASSIGN_ID,
    	TASK_RULE_PARM_ID,
    	ORIG_TASK_ID,
    	START_CURR_WORK_AREA,
    	LTST_START_DATE_TIME,
    	START_DEST_WORK_GRP,
    	END_CURR_WORK_AREA,
    	START_DEST_WORK_AREA,
    	NEED_ID,
    	TASK_ID,
    	TASK_GENRTN_REF_NBR,
    	STAT_CODE,
    	ESTIMATED_DISTANCE,
    	START_CURR_WORK_GRP,
    	BEGIN_AISLE,
    	LTST_CMPL_DATE_TIME,
    	WHSE,
    	WM_VERSION_ID,
    	TASK_CMPL_REF_NBR,
    	PICK_TO_TOTE_FLAG,
    	CURR_LOCN_ID,
    	BEGIN_ZONE,
    	TASK_PARM_ID,
    	REPRINT_COUNT,
    	MOD_DATE_TIME,
    	END_DEST_WORK_GRP,
    	ONE_USER_PER_GRP,
    	XPECTD_DURTN,
    	END_AISLE,
    	DFLT_TASK_PRTY,
    	INVN_NEED_TYPE,
    	BEGIN_AREA,
    	RPT_PRTR_REQSTR,
    	INVN_TYPE,
    	EXCEPTION_CODE,
    	CURR_USER_ID,
    	END_ZONE,
    	TASK_CMPL_REF_CODE,
    	RLS_DATE_TIME,
    	NEXT_TASK_ID,
    	ACTL_DURTN,
    	ARCHIVE_DTTM,
    	MHE_ORD_STATE,
    	_FIVETRAN_DELETED,
    	_FIVETRAN_SYNCED

        FROM XBPRDARCHSILVER.ARCH_SILVER_F_XBWM19ARCH.TASK_HDR
        WHERE TASK_HDR.TASK_HDR_ID  NOT IN (
        SELECT TASK_HDR_ID FROM XBPRDWMSILVER.PRD_SILVER_GA_XBDBTJ3WM.TASK_HDR WHERE TASK_HDR.CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE())
        )
        AND TASK_HDR.TASK_HDR_ID  NOT IN (SELECT TASK_HDR_ID FROM XBPRDWMSILVER.PRD_SILVER_D_XBDBTJ3WM.TASK_HDR)
        ;

--- RY
CREATE OR REPLACE TABLE ETL.RY_ARCH.TASK_HDR
AS
    SELECT
        TASK_HDR_ID,
    	ESTIMATED_TIME,
    	USER_ID,
    	PRT_TASK_LIST_FLAG,
    	VOCO_INTRNL_REVERSE_ID,
    	TASK_GENRTN_REF_CODE,
    	CREATE_DATE_TIME,
    	END_CURR_WORK_GRP,
    	LOCN_HDR_ID,
    	END_DEST_WORK_AREA,
    	ERLST_START_DATE_TIME,
    	MHE_FLAG,
    	TASK_DESC,
    	TASK_TYPE,
    	DOC_ID,
    	PICK_CART_TYPE,
    	CURR_TASK_PRTY,
    	RULE_ID,
    	OWNER_USER_ID,
    	ITEM_ID,
    	END_AREA,
    	TASK_BATCH,
    	VOCOLLECT_ASSIGN_ID,
    	TASK_RULE_PARM_ID,
    	ORIG_TASK_ID,
    	START_CURR_WORK_AREA,
    	LTST_START_DATE_TIME,
    	START_DEST_WORK_GRP,
    	END_CURR_WORK_AREA,
    	START_DEST_WORK_AREA,
    	NEED_ID,
    	TASK_ID,
    	TASK_GENRTN_REF_NBR,
    	STAT_CODE,
    	ESTIMATED_DISTANCE,
    	START_CURR_WORK_GRP,
    	BEGIN_AISLE,
    	LTST_CMPL_DATE_TIME,
    	WHSE,
    	WM_VERSION_ID,
    	TASK_CMPL_REF_NBR,
    	PICK_TO_TOTE_FLAG,
    	CURR_LOCN_ID,
    	BEGIN_ZONE,
    	TASK_PARM_ID,
    	REPRINT_COUNT,
    	MOD_DATE_TIME,
    	END_DEST_WORK_GRP,
    	ONE_USER_PER_GRP,
    	XPECTD_DURTN,
    	END_AISLE,
    	DFLT_TASK_PRTY,
    	INVN_NEED_TYPE,
    	BEGIN_AREA,
    	RPT_PRTR_REQSTR,
    	INVN_TYPE,
    	EXCEPTION_CODE,
    	CURR_USER_ID,
    	END_ZONE,
    	TASK_CMPL_REF_CODE,
    	RLS_DATE_TIME,
    	NEXT_TASK_ID,
    	ACTL_DURTN,
    	current_timestamp() AS ARCHIVE_DTTM,
    	MHE_ORD_STATE,
    	_FIVETRAN_DELETED,
    	_FIVETRAN_SYNCED
        FROM XBPRDWMRY.PRD_RY_GA_XBORPRDWM.TASK_HDR
        WHERE TASK_HDR.CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE())

        UNION

        SELECT
        TASK_HDR_ID,
    	ESTIMATED_TIME,
    	USER_ID,
    	PRT_TASK_LIST_FLAG,
    	VOCO_INTRNL_REVERSE_ID,
    	TASK_GENRTN_REF_CODE,
    	CREATE_DATE_TIME,
    	END_CURR_WORK_GRP,
    	LOCN_HDR_ID,
    	END_DEST_WORK_AREA,
    	ERLST_START_DATE_TIME,
    	MHE_FLAG,
    	TASK_DESC,
    	TASK_TYPE,
    	DOC_ID,
    	PICK_CART_TYPE,
    	CURR_TASK_PRTY,
    	RULE_ID,
    	OWNER_USER_ID,
    	ITEM_ID,
    	END_AREA,
    	TASK_BATCH,
    	VOCOLLECT_ASSIGN_ID,
    	TASK_RULE_PARM_ID,
    	ORIG_TASK_ID,
    	START_CURR_WORK_AREA,
    	LTST_START_DATE_TIME,
    	START_DEST_WORK_GRP,
    	END_CURR_WORK_AREA,
    	START_DEST_WORK_AREA,
    	NEED_ID,
    	TASK_ID,
    	TASK_GENRTN_REF_NBR,
    	STAT_CODE,
    	ESTIMATED_DISTANCE,
    	START_CURR_WORK_GRP,
    	BEGIN_AISLE,
    	LTST_CMPL_DATE_TIME,
    	WHSE,
    	WM_VERSION_ID,
    	TASK_CMPL_REF_NBR,
    	PICK_TO_TOTE_FLAG,
    	CURR_LOCN_ID,
    	BEGIN_ZONE,
    	TASK_PARM_ID,
    	REPRINT_COUNT,
    	MOD_DATE_TIME,
    	END_DEST_WORK_GRP,
    	ONE_USER_PER_GRP,
    	XPECTD_DURTN,
    	END_AISLE,
    	DFLT_TASK_PRTY,
    	INVN_NEED_TYPE,
    	BEGIN_AREA,
    	RPT_PRTR_REQSTR,
    	INVN_TYPE,
    	EXCEPTION_CODE,
    	CURR_USER_ID,
    	END_ZONE,
    	TASK_CMPL_REF_CODE,
    	RLS_DATE_TIME,
    	NEXT_TASK_ID,
    	ACTL_DURTN,
    	current_timestamp() AS ARCHIVE_DTTM,
    	MHE_ORD_STATE,
    	_FIVETRAN_DELETED,
    	_FIVETRAN_SYNCED

        FROM XBPRDWMRY.PRD_RY_D_XBORPRDWM.TASK_HDR
        WHERE TASK_HDR.TASK_HDR_ID  NOT IN (SELECT TASK_HDR_ID FROM XBPRDWMRY.PRD_RY_GA_XBORPRDWM.TASK_HDR WHERE CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE()))

        UNION

        SELECT
        TASK_HDR_ID,
    	ESTIMATED_TIME,
    	USER_ID,
    	PRT_TASK_LIST_FLAG,
    	VOCO_INTRNL_REVERSE_ID,
    	TASK_GENRTN_REF_CODE,
    	CREATE_DATE_TIME,
    	END_CURR_WORK_GRP,
    	LOCN_HDR_ID,
    	END_DEST_WORK_AREA,
    	ERLST_START_DATE_TIME,
    	MHE_FLAG,
    	TASK_DESC,
    	TASK_TYPE,
    	DOC_ID,
    	PICK_CART_TYPE,
    	CURR_TASK_PRTY,
    	RULE_ID,
    	OWNER_USER_ID,
    	ITEM_ID,
    	END_AREA,
    	TASK_BATCH,
    	VOCOLLECT_ASSIGN_ID,
    	TASK_RULE_PARM_ID,
    	ORIG_TASK_ID,
    	START_CURR_WORK_AREA,
    	LTST_START_DATE_TIME,
    	START_DEST_WORK_GRP,
    	END_CURR_WORK_AREA,
    	START_DEST_WORK_AREA,
    	NEED_ID,
    	TASK_ID,
    	TASK_GENRTN_REF_NBR,
    	STAT_CODE,
    	ESTIMATED_DISTANCE,
    	START_CURR_WORK_GRP,
    	BEGIN_AISLE,
    	LTST_CMPL_DATE_TIME,
    	WHSE,
    	WM_VERSION_ID,
    	TASK_CMPL_REF_NBR,
    	PICK_TO_TOTE_FLAG,
    	CURR_LOCN_ID,
    	BEGIN_ZONE,
    	TASK_PARM_ID,
    	REPRINT_COUNT,
    	MOD_DATE_TIME,
    	END_DEST_WORK_GRP,
    	ONE_USER_PER_GRP,
    	XPECTD_DURTN,
    	END_AISLE,
    	DFLT_TASK_PRTY,
    	INVN_NEED_TYPE,
    	BEGIN_AREA,
    	RPT_PRTR_REQSTR,
    	INVN_TYPE,
    	EXCEPTION_CODE,
    	CURR_USER_ID,
    	END_ZONE,
    	TASK_CMPL_REF_CODE,
    	RLS_DATE_TIME,
    	NEXT_TASK_ID,
    	ACTL_DURTN,
    	ARCHIVE_DTTM,
    	MHE_ORD_STATE,
    	_FIVETRAN_DELETED,
    	_FIVETRAN_SYNCED

        FROM XBPRDARCHREYNOSA.ARCHIVE_REYNOSA_XBORPRDARCH.TASK_HDR
        WHERE TASK_HDR.TASK_HDR_ID  NOT IN (
        SELECT TASK_HDR_ID FROM XBPRDWMRY.PRD_RY_GA_XBORPRDWM.TASK_HDR WHERE TASK_HDR.CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE())
        )
        AND TASK_HDR.TASK_HDR_ID  NOT IN (SELECT TASK_HDR_ID FROM XBPRDWMRY.PRD_RY_D_XBORPRDWM.TASK_HDR)
        ;

--- SP_GOLD
CREATE OR REPLACE PROCEDURE ETL.GOLD_ARCH.SP_UPDATE_ETL_TASK_HDR_GOLD()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS
    BEGIN
        MERGE INTO ETL.GOLD_ARCH.TASK_HDR AS TARGET
        USING
        (
            SELECT *, current_timestamp() AS ARCHIVE_DTTM 
            FROM XBPRDWMGOLD.PRD_GOLD_GA_XBWM19WM.TASK_HDR
            WHERE CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE())
        ) AS SOURCE
        ON TARGET.TASK_HDR_ID = SOURCE.TASK_HDR_ID
        WHEN MATCHED AND TARGET.MOD_DATE_TIME < SOURCE.MOD_DATE_TIME 
                    THEN UPDATE SET
                    		TARGET.TASK_HDR_ID = SOURCE.TASK_HDR_ID,
                        	TARGET.ESTIMATED_TIME = SOURCE.ESTIMATED_TIME,
                        	TARGET.USER_ID = SOURCE.USER_ID,
                        	TARGET.PRT_TASK_LIST_FLAG = SOURCE.PRT_TASK_LIST_FLAG,
                        	TARGET.VOCO_INTRNL_REVERSE_ID = SOURCE.VOCO_INTRNL_REVERSE_ID,
                        	TARGET.TASK_GENRTN_REF_CODE = SOURCE.TASK_GENRTN_REF_CODE,
                        	TARGET.CREATE_DATE_TIME = SOURCE.CREATE_DATE_TIME,
                        	TARGET.END_CURR_WORK_GRP = SOURCE.END_CURR_WORK_GRP,
                        	TARGET.LOCN_HDR_ID = SOURCE.LOCN_HDR_ID,
                        	TARGET.END_DEST_WORK_AREA = SOURCE.END_DEST_WORK_AREA,
                        	TARGET.ERLST_START_DATE_TIME = SOURCE.ERLST_START_DATE_TIME,
                        	TARGET.MHE_FLAG = SOURCE.MHE_FLAG,
                        	TARGET.TASK_DESC = SOURCE.TASK_DESC,
                        	TARGET.TASK_TYPE = SOURCE.TASK_TYPE,
                        	TARGET.DOC_ID = SOURCE.DOC_ID,
                        	TARGET.PICK_CART_TYPE = SOURCE.PICK_CART_TYPE,
                        	TARGET.CURR_TASK_PRTY = SOURCE.CURR_TASK_PRTY,
                        	TARGET.RULE_ID = SOURCE.RULE_ID,
                        	TARGET.OWNER_USER_ID = SOURCE.OWNER_USER_ID,
                        	TARGET.ITEM_ID = SOURCE.ITEM_ID,
                        	TARGET.END_AREA = SOURCE.END_AREA,
                        	TARGET.TASK_BATCH = SOURCE.TASK_BATCH,
                        	TARGET.VOCOLLECT_ASSIGN_ID = SOURCE.VOCOLLECT_ASSIGN_ID,
                        	TARGET.TASK_RULE_PARM_ID = SOURCE.TASK_RULE_PARM_ID,
                        	TARGET.ORIG_TASK_ID = SOURCE.ORIG_TASK_ID,
                        	TARGET.START_CURR_WORK_AREA = SOURCE.START_CURR_WORK_AREA,
                        	TARGET.LTST_START_DATE_TIME = SOURCE.LTST_START_DATE_TIME,
                        	TARGET.START_DEST_WORK_GRP = SOURCE.START_DEST_WORK_GRP,
                        	TARGET.END_CURR_WORK_AREA = SOURCE.END_CURR_WORK_AREA,
                        	TARGET.START_DEST_WORK_AREA = SOURCE.START_DEST_WORK_AREA,
                        	TARGET.NEED_ID = SOURCE.NEED_ID,
                        	TARGET.TASK_ID = SOURCE.TASK_ID,
                        	TARGET.TASK_GENRTN_REF_NBR = SOURCE.TASK_GENRTN_REF_NBR,
                        	TARGET.STAT_CODE = SOURCE.STAT_CODE,
                        	TARGET.ESTIMATED_DISTANCE = SOURCE.ESTIMATED_DISTANCE,
                        	TARGET.START_CURR_WORK_GRP = SOURCE.START_CURR_WORK_GRP,
                        	TARGET.BEGIN_AISLE = SOURCE.BEGIN_AISLE,
                        	TARGET.LTST_CMPL_DATE_TIME = SOURCE.LTST_CMPL_DATE_TIME,
                        	TARGET.WHSE = SOURCE.WHSE,
                        	TARGET.WM_VERSION_ID = SOURCE.WM_VERSION_ID,
                        	TARGET.TASK_CMPL_REF_NBR = SOURCE.TASK_CMPL_REF_NBR,
                        	TARGET.PICK_TO_TOTE_FLAG = SOURCE.PICK_TO_TOTE_FLAG,
                        	TARGET.CURR_LOCN_ID = SOURCE.CURR_LOCN_ID,
                        	TARGET.BEGIN_ZONE = SOURCE.BEGIN_ZONE,
                        	TARGET.TASK_PARM_ID = SOURCE.TASK_PARM_ID,
                        	TARGET.REPRINT_COUNT = SOURCE.REPRINT_COUNT,
                        	TARGET.MOD_DATE_TIME = SOURCE.MOD_DATE_TIME,
                        	TARGET.END_DEST_WORK_GRP = SOURCE.END_DEST_WORK_GRP,
                        	TARGET.ONE_USER_PER_GRP = SOURCE.ONE_USER_PER_GRP,
                        	TARGET.XPECTD_DURTN = SOURCE.XPECTD_DURTN,
                        	TARGET.END_AISLE = SOURCE.END_AISLE,
                        	TARGET.DFLT_TASK_PRTY = SOURCE.DFLT_TASK_PRTY,
                        	TARGET.INVN_NEED_TYPE = SOURCE.INVN_NEED_TYPE,
                        	TARGET.BEGIN_AREA = SOURCE.BEGIN_AREA,
                        	TARGET.RPT_PRTR_REQSTR = SOURCE.RPT_PRTR_REQSTR,
                        	TARGET.INVN_TYPE = SOURCE.INVN_TYPE,
                        	TARGET.EXCEPTION_CODE = SOURCE.EXCEPTION_CODE,
                        	TARGET.CURR_USER_ID = SOURCE.CURR_USER_ID,
                        	TARGET.END_ZONE = SOURCE.END_ZONE,
                        	TARGET.TASK_CMPL_REF_CODE = SOURCE.TASK_CMPL_REF_CODE,
                        	TARGET.RLS_DATE_TIME = SOURCE.RLS_DATE_TIME,
                        	TARGET.NEXT_TASK_ID = SOURCE.NEXT_TASK_ID,
                        	TARGET.ACTL_DURTN = SOURCE.ACTL_DURTN,
                        	TARGET.ARCHIVE_DTTM = SOURCE.ARCHIVE_DTTM,
                        	TARGET.MHE_ORD_STATE = SOURCE.MHE_ORD_STATE,
                        	TARGET._FIVETRAN_DELETED = SOURCE._FIVETRAN_DELETED,
                        	TARGET._FIVETRAN_SYNCED = SOURCE._FIVETRAN_SYNCED
        WHEN NOT MATCHED 
        THEN
        INSERT
        (
            TASK_HDR_ID,
            ESTIMATED_TIME,
            USER_ID,
            PRT_TASK_LIST_FLAG,
            VOCO_INTRNL_REVERSE_ID,
            TASK_GENRTN_REF_CODE,
            CREATE_DATE_TIME,
            END_CURR_WORK_GRP,
            LOCN_HDR_ID,
            END_DEST_WORK_AREA,
            ERLST_START_DATE_TIME,
            MHE_FLAG,
            TASK_DESC,
            TASK_TYPE,
            DOC_ID,
            PICK_CART_TYPE,
            CURR_TASK_PRTY,
            RULE_ID,
            OWNER_USER_ID,
            ITEM_ID,
            END_AREA,
            TASK_BATCH,
            VOCOLLECT_ASSIGN_ID,
            TASK_RULE_PARM_ID,
            ORIG_TASK_ID,
            START_CURR_WORK_AREA,
            LTST_START_DATE_TIME,
            START_DEST_WORK_GRP,
            END_CURR_WORK_AREA,
            START_DEST_WORK_AREA,
            NEED_ID,
            TASK_ID,
            TASK_GENRTN_REF_NBR,
            STAT_CODE,
            ESTIMATED_DISTANCE,
            START_CURR_WORK_GRP,
            BEGIN_AISLE,
            LTST_CMPL_DATE_TIME,
            WHSE,
            WM_VERSION_ID,
            TASK_CMPL_REF_NBR,
            PICK_TO_TOTE_FLAG,
            CURR_LOCN_ID,
            BEGIN_ZONE,
            TASK_PARM_ID,
            REPRINT_COUNT,
            MOD_DATE_TIME,
            END_DEST_WORK_GRP,
            ONE_USER_PER_GRP,
            XPECTD_DURTN,
            END_AISLE,
            DFLT_TASK_PRTY,
            INVN_NEED_TYPE,
            BEGIN_AREA,
            RPT_PRTR_REQSTR,
            INVN_TYPE,
            EXCEPTION_CODE,
            CURR_USER_ID,
            END_ZONE,
            TASK_CMPL_REF_CODE,
            RLS_DATE_TIME,
            NEXT_TASK_ID,
            ACTL_DURTN,
            ARCHIVE_DTTM,
            MHE_ORD_STATE,
            _FIVETRAN_DELETED,
            _FIVETRAN_SYNCED
        )
        VALUES
        (
            SOURCE.TASK_HDR_ID,
            SOURCE.ESTIMATED_TIME,
            SOURCE.USER_ID,
            SOURCE.PRT_TASK_LIST_FLAG,
            SOURCE.VOCO_INTRNL_REVERSE_ID,
            SOURCE.TASK_GENRTN_REF_CODE,
            SOURCE.CREATE_DATE_TIME,
            SOURCE.END_CURR_WORK_GRP,
            SOURCE.LOCN_HDR_ID,
            SOURCE.END_DEST_WORK_AREA,
            SOURCE.ERLST_START_DATE_TIME,
            SOURCE.MHE_FLAG,
            SOURCE.TASK_DESC,
            SOURCE.TASK_TYPE,
            SOURCE.DOC_ID,
            SOURCE.PICK_CART_TYPE,
            SOURCE.CURR_TASK_PRTY,
            SOURCE.RULE_ID,
            SOURCE.OWNER_USER_ID,
            SOURCE.ITEM_ID,
            SOURCE.END_AREA,
            SOURCE.TASK_BATCH,
            SOURCE.VOCOLLECT_ASSIGN_ID,
            SOURCE.TASK_RULE_PARM_ID,
            SOURCE.ORIG_TASK_ID,
            SOURCE.START_CURR_WORK_AREA,
            SOURCE.LTST_START_DATE_TIME,
            SOURCE.START_DEST_WORK_GRP,
            SOURCE.END_CURR_WORK_AREA,
            SOURCE.START_DEST_WORK_AREA,
            SOURCE.NEED_ID,
            SOURCE.TASK_ID,
            SOURCE.TASK_GENRTN_REF_NBR,
            SOURCE.STAT_CODE,
            SOURCE.ESTIMATED_DISTANCE,
            SOURCE.START_CURR_WORK_GRP,
            SOURCE.BEGIN_AISLE,
            SOURCE.LTST_CMPL_DATE_TIME,
            SOURCE.WHSE,
            SOURCE.WM_VERSION_ID,
            SOURCE.TASK_CMPL_REF_NBR,
            SOURCE.PICK_TO_TOTE_FLAG,
            SOURCE.CURR_LOCN_ID,
            SOURCE.BEGIN_ZONE,
            SOURCE.TASK_PARM_ID,
            SOURCE.REPRINT_COUNT,
            SOURCE.MOD_DATE_TIME,
            SOURCE.END_DEST_WORK_GRP,
            SOURCE.ONE_USER_PER_GRP,
            SOURCE.XPECTD_DURTN,
            SOURCE.END_AISLE,
            SOURCE.DFLT_TASK_PRTY,
            SOURCE.INVN_NEED_TYPE,
            SOURCE.BEGIN_AREA,
            SOURCE.RPT_PRTR_REQSTR,
            SOURCE.INVN_TYPE,
            SOURCE.EXCEPTION_CODE,
            SOURCE.CURR_USER_ID,
            SOURCE.END_ZONE,
            SOURCE.TASK_CMPL_REF_CODE,
            SOURCE.RLS_DATE_TIME,
            SOURCE.NEXT_TASK_ID,
            SOURCE.ACTL_DURTN,
            SOURCE.ARCHIVE_DTTM,
            SOURCE.MHE_ORD_STATE,
            SOURCE._FIVETRAN_DELETED,
            SOURCE._FIVETRAN_SYNCED
        );
        RETURN ('SUCCESS');
    END;
    
--- SP_SILVER
CREATE OR REPLACE PROCEDURE ETL.SILVER_ARCH.SP_UPDATE_ETL_TASK_HDR_SILVER()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS
    BEGIN
        MERGE INTO ETL.SILVER_ARCH.TASK_HDR AS TARGET
        USING
        (
            SELECT *, current_timestamp() AS ARCHIVE_DTTM 
            FROM XBPRDWMSILVER.PRD_SILVER_GA_XBDBTJ3WM.TASK_HDR
            WHERE CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE())
        ) AS SOURCE
        ON TARGET.TASK_HDR_ID = SOURCE.TASK_HDR_ID
        WHEN MATCHED AND TARGET.MOD_DATE_TIME < SOURCE.MOD_DATE_TIME 
                    THEN UPDATE SET
                    		TARGET.TASK_HDR_ID = SOURCE.TASK_HDR_ID,
                        	TARGET.ESTIMATED_TIME = SOURCE.ESTIMATED_TIME,
                        	TARGET.USER_ID = SOURCE.USER_ID,
                        	TARGET.PRT_TASK_LIST_FLAG = SOURCE.PRT_TASK_LIST_FLAG,
                        	TARGET.VOCO_INTRNL_REVERSE_ID = SOURCE.VOCO_INTRNL_REVERSE_ID,
                        	TARGET.TASK_GENRTN_REF_CODE = SOURCE.TASK_GENRTN_REF_CODE,
                        	TARGET.CREATE_DATE_TIME = SOURCE.CREATE_DATE_TIME,
                        	TARGET.END_CURR_WORK_GRP = SOURCE.END_CURR_WORK_GRP,
                        	TARGET.LOCN_HDR_ID = SOURCE.LOCN_HDR_ID,
                        	TARGET.END_DEST_WORK_AREA = SOURCE.END_DEST_WORK_AREA,
                        	TARGET.ERLST_START_DATE_TIME = SOURCE.ERLST_START_DATE_TIME,
                        	TARGET.MHE_FLAG = SOURCE.MHE_FLAG,
                        	TARGET.TASK_DESC = SOURCE.TASK_DESC,
                        	TARGET.TASK_TYPE = SOURCE.TASK_TYPE,
                        	TARGET.DOC_ID = SOURCE.DOC_ID,
                        	TARGET.PICK_CART_TYPE = SOURCE.PICK_CART_TYPE,
                        	TARGET.CURR_TASK_PRTY = SOURCE.CURR_TASK_PRTY,
                        	TARGET.RULE_ID = SOURCE.RULE_ID,
                        	TARGET.OWNER_USER_ID = SOURCE.OWNER_USER_ID,
                        	TARGET.ITEM_ID = SOURCE.ITEM_ID,
                        	TARGET.END_AREA = SOURCE.END_AREA,
                        	TARGET.TASK_BATCH = SOURCE.TASK_BATCH,
                        	TARGET.VOCOLLECT_ASSIGN_ID = SOURCE.VOCOLLECT_ASSIGN_ID,
                        	TARGET.TASK_RULE_PARM_ID = SOURCE.TASK_RULE_PARM_ID,
                        	TARGET.ORIG_TASK_ID = SOURCE.ORIG_TASK_ID,
                        	TARGET.START_CURR_WORK_AREA = SOURCE.START_CURR_WORK_AREA,
                        	TARGET.LTST_START_DATE_TIME = SOURCE.LTST_START_DATE_TIME,
                        	TARGET.START_DEST_WORK_GRP = SOURCE.START_DEST_WORK_GRP,
                        	TARGET.END_CURR_WORK_AREA = SOURCE.END_CURR_WORK_AREA,
                        	TARGET.START_DEST_WORK_AREA = SOURCE.START_DEST_WORK_AREA,
                        	TARGET.NEED_ID = SOURCE.NEED_ID,
                        	TARGET.TASK_ID = SOURCE.TASK_ID,
                        	TARGET.TASK_GENRTN_REF_NBR = SOURCE.TASK_GENRTN_REF_NBR,
                        	TARGET.STAT_CODE = SOURCE.STAT_CODE,
                        	TARGET.ESTIMATED_DISTANCE = SOURCE.ESTIMATED_DISTANCE,
                        	TARGET.START_CURR_WORK_GRP = SOURCE.START_CURR_WORK_GRP,
                        	TARGET.BEGIN_AISLE = SOURCE.BEGIN_AISLE,
                        	TARGET.LTST_CMPL_DATE_TIME = SOURCE.LTST_CMPL_DATE_TIME,
                        	TARGET.WHSE = SOURCE.WHSE,
                        	TARGET.WM_VERSION_ID = SOURCE.WM_VERSION_ID,
                        	TARGET.TASK_CMPL_REF_NBR = SOURCE.TASK_CMPL_REF_NBR,
                        	TARGET.PICK_TO_TOTE_FLAG = SOURCE.PICK_TO_TOTE_FLAG,
                        	TARGET.CURR_LOCN_ID = SOURCE.CURR_LOCN_ID,
                        	TARGET.BEGIN_ZONE = SOURCE.BEGIN_ZONE,
                        	TARGET.TASK_PARM_ID = SOURCE.TASK_PARM_ID,
                        	TARGET.REPRINT_COUNT = SOURCE.REPRINT_COUNT,
                        	TARGET.MOD_DATE_TIME = SOURCE.MOD_DATE_TIME,
                        	TARGET.END_DEST_WORK_GRP = SOURCE.END_DEST_WORK_GRP,
                        	TARGET.ONE_USER_PER_GRP = SOURCE.ONE_USER_PER_GRP,
                        	TARGET.XPECTD_DURTN = SOURCE.XPECTD_DURTN,
                        	TARGET.END_AISLE = SOURCE.END_AISLE,
                        	TARGET.DFLT_TASK_PRTY = SOURCE.DFLT_TASK_PRTY,
                        	TARGET.INVN_NEED_TYPE = SOURCE.INVN_NEED_TYPE,
                        	TARGET.BEGIN_AREA = SOURCE.BEGIN_AREA,
                        	TARGET.RPT_PRTR_REQSTR = SOURCE.RPT_PRTR_REQSTR,
                        	TARGET.INVN_TYPE = SOURCE.INVN_TYPE,
                        	TARGET.EXCEPTION_CODE = SOURCE.EXCEPTION_CODE,
                        	TARGET.CURR_USER_ID = SOURCE.CURR_USER_ID,
                        	TARGET.END_ZONE = SOURCE.END_ZONE,
                        	TARGET.TASK_CMPL_REF_CODE = SOURCE.TASK_CMPL_REF_CODE,
                        	TARGET.RLS_DATE_TIME = SOURCE.RLS_DATE_TIME,
                        	TARGET.NEXT_TASK_ID = SOURCE.NEXT_TASK_ID,
                        	TARGET.ACTL_DURTN = SOURCE.ACTL_DURTN,
                        	TARGET.ARCHIVE_DTTM = SOURCE.ARCHIVE_DTTM,
                        	TARGET.MHE_ORD_STATE = SOURCE.MHE_ORD_STATE,
                        	TARGET._FIVETRAN_DELETED = SOURCE._FIVETRAN_DELETED,
                        	TARGET._FIVETRAN_SYNCED = SOURCE._FIVETRAN_SYNCED
        WHEN NOT MATCHED 
        THEN
        INSERT
        (
            TASK_HDR_ID,
            ESTIMATED_TIME,
            USER_ID,
            PRT_TASK_LIST_FLAG,
            VOCO_INTRNL_REVERSE_ID,
            TASK_GENRTN_REF_CODE,
            CREATE_DATE_TIME,
            END_CURR_WORK_GRP,
            LOCN_HDR_ID,
            END_DEST_WORK_AREA,
            ERLST_START_DATE_TIME,
            MHE_FLAG,
            TASK_DESC,
            TASK_TYPE,
            DOC_ID,
            PICK_CART_TYPE,
            CURR_TASK_PRTY,
            RULE_ID,
            OWNER_USER_ID,
            ITEM_ID,
            END_AREA,
            TASK_BATCH,
            VOCOLLECT_ASSIGN_ID,
            TASK_RULE_PARM_ID,
            ORIG_TASK_ID,
            START_CURR_WORK_AREA,
            LTST_START_DATE_TIME,
            START_DEST_WORK_GRP,
            END_CURR_WORK_AREA,
            START_DEST_WORK_AREA,
            NEED_ID,
            TASK_ID,
            TASK_GENRTN_REF_NBR,
            STAT_CODE,
            ESTIMATED_DISTANCE,
            START_CURR_WORK_GRP,
            BEGIN_AISLE,
            LTST_CMPL_DATE_TIME,
            WHSE,
            WM_VERSION_ID,
            TASK_CMPL_REF_NBR,
            PICK_TO_TOTE_FLAG,
            CURR_LOCN_ID,
            BEGIN_ZONE,
            TASK_PARM_ID,
            REPRINT_COUNT,
            MOD_DATE_TIME,
            END_DEST_WORK_GRP,
            ONE_USER_PER_GRP,
            XPECTD_DURTN,
            END_AISLE,
            DFLT_TASK_PRTY,
            INVN_NEED_TYPE,
            BEGIN_AREA,
            RPT_PRTR_REQSTR,
            INVN_TYPE,
            EXCEPTION_CODE,
            CURR_USER_ID,
            END_ZONE,
            TASK_CMPL_REF_CODE,
            RLS_DATE_TIME,
            NEXT_TASK_ID,
            ACTL_DURTN,
            ARCHIVE_DTTM,
            MHE_ORD_STATE,
            _FIVETRAN_DELETED,
            _FIVETRAN_SYNCED
        )
        VALUES
        (
            SOURCE.TASK_HDR_ID,
            SOURCE.ESTIMATED_TIME,
            SOURCE.USER_ID,
            SOURCE.PRT_TASK_LIST_FLAG,
            SOURCE.VOCO_INTRNL_REVERSE_ID,
            SOURCE.TASK_GENRTN_REF_CODE,
            SOURCE.CREATE_DATE_TIME,
            SOURCE.END_CURR_WORK_GRP,
            SOURCE.LOCN_HDR_ID,
            SOURCE.END_DEST_WORK_AREA,
            SOURCE.ERLST_START_DATE_TIME,
            SOURCE.MHE_FLAG,
            SOURCE.TASK_DESC,
            SOURCE.TASK_TYPE,
            SOURCE.DOC_ID,
            SOURCE.PICK_CART_TYPE,
            SOURCE.CURR_TASK_PRTY,
            SOURCE.RULE_ID,
            SOURCE.OWNER_USER_ID,
            SOURCE.ITEM_ID,
            SOURCE.END_AREA,
            SOURCE.TASK_BATCH,
            SOURCE.VOCOLLECT_ASSIGN_ID,
            SOURCE.TASK_RULE_PARM_ID,
            SOURCE.ORIG_TASK_ID,
            SOURCE.START_CURR_WORK_AREA,
            SOURCE.LTST_START_DATE_TIME,
            SOURCE.START_DEST_WORK_GRP,
            SOURCE.END_CURR_WORK_AREA,
            SOURCE.START_DEST_WORK_AREA,
            SOURCE.NEED_ID,
            SOURCE.TASK_ID,
            SOURCE.TASK_GENRTN_REF_NBR,
            SOURCE.STAT_CODE,
            SOURCE.ESTIMATED_DISTANCE,
            SOURCE.START_CURR_WORK_GRP,
            SOURCE.BEGIN_AISLE,
            SOURCE.LTST_CMPL_DATE_TIME,
            SOURCE.WHSE,
            SOURCE.WM_VERSION_ID,
            SOURCE.TASK_CMPL_REF_NBR,
            SOURCE.PICK_TO_TOTE_FLAG,
            SOURCE.CURR_LOCN_ID,
            SOURCE.BEGIN_ZONE,
            SOURCE.TASK_PARM_ID,
            SOURCE.REPRINT_COUNT,
            SOURCE.MOD_DATE_TIME,
            SOURCE.END_DEST_WORK_GRP,
            SOURCE.ONE_USER_PER_GRP,
            SOURCE.XPECTD_DURTN,
            SOURCE.END_AISLE,
            SOURCE.DFLT_TASK_PRTY,
            SOURCE.INVN_NEED_TYPE,
            SOURCE.BEGIN_AREA,
            SOURCE.RPT_PRTR_REQSTR,
            SOURCE.INVN_TYPE,
            SOURCE.EXCEPTION_CODE,
            SOURCE.CURR_USER_ID,
            SOURCE.END_ZONE,
            SOURCE.TASK_CMPL_REF_CODE,
            SOURCE.RLS_DATE_TIME,
            SOURCE.NEXT_TASK_ID,
            SOURCE.ACTL_DURTN,
            SOURCE.ARCHIVE_DTTM,
            SOURCE.MHE_ORD_STATE,
            SOURCE._FIVETRAN_DELETED,
            SOURCE._FIVETRAN_SYNCED
        );
        RETURN ('SUCCESS');
    END;
    
--- SP_RY
CREATE OR REPLACE PROCEDURE ETL.RY_ARCH.SP_UPDATE_ETL_TASK_HDR_RY()
RETURNS VARCHAR(16777216)
LANGUAGE SQL
EXECUTE AS OWNER
AS
    BEGIN
        MERGE INTO ETL.RY_ARCH.TASK_HDR AS TARGET
        USING
        (
            SELECT *, current_timestamp() AS ARCHIVE_DTTM 
            FROM XBPRDWMRY.PRD_RY_GA_XBORPRDWM.TASK_HDR
            WHERE CREATE_DATE_TIME <= DATEADD(month, -2, CURRENT_DATE())
        ) AS SOURCE
        ON TARGET.TASK_HDR_ID = SOURCE.TASK_HDR_ID
        WHEN MATCHED AND TARGET.MOD_DATE_TIME < SOURCE.MOD_DATE_TIME 
                    THEN UPDATE SET
                    		TARGET.TASK_HDR_ID = SOURCE.TASK_HDR_ID,
                        	TARGET.ESTIMATED_TIME = SOURCE.ESTIMATED_TIME,
                        	TARGET.USER_ID = SOURCE.USER_ID,
                        	TARGET.PRT_TASK_LIST_FLAG = SOURCE.PRT_TASK_LIST_FLAG,
                        	TARGET.VOCO_INTRNL_REVERSE_ID = SOURCE.VOCO_INTRNL_REVERSE_ID,
                        	TARGET.TASK_GENRTN_REF_CODE = SOURCE.TASK_GENRTN_REF_CODE,
                        	TARGET.CREATE_DATE_TIME = SOURCE.CREATE_DATE_TIME,
                        	TARGET.END_CURR_WORK_GRP = SOURCE.END_CURR_WORK_GRP,
                        	TARGET.LOCN_HDR_ID = SOURCE.LOCN_HDR_ID,
                        	TARGET.END_DEST_WORK_AREA = SOURCE.END_DEST_WORK_AREA,
                        	TARGET.ERLST_START_DATE_TIME = SOURCE.ERLST_START_DATE_TIME,
                        	TARGET.MHE_FLAG = SOURCE.MHE_FLAG,
                        	TARGET.TASK_DESC = SOURCE.TASK_DESC,
                        	TARGET.TASK_TYPE = SOURCE.TASK_TYPE,
                        	TARGET.DOC_ID = SOURCE.DOC_ID,
                        	TARGET.PICK_CART_TYPE = SOURCE.PICK_CART_TYPE,
                        	TARGET.CURR_TASK_PRTY = SOURCE.CURR_TASK_PRTY,
                        	TARGET.RULE_ID = SOURCE.RULE_ID,
                        	TARGET.OWNER_USER_ID = SOURCE.OWNER_USER_ID,
                        	TARGET.ITEM_ID = SOURCE.ITEM_ID,
                        	TARGET.END_AREA = SOURCE.END_AREA,
                        	TARGET.TASK_BATCH = SOURCE.TASK_BATCH,
                        	TARGET.VOCOLLECT_ASSIGN_ID = SOURCE.VOCOLLECT_ASSIGN_ID,
                        	TARGET.TASK_RULE_PARM_ID = SOURCE.TASK_RULE_PARM_ID,
                        	TARGET.ORIG_TASK_ID = SOURCE.ORIG_TASK_ID,
                        	TARGET.START_CURR_WORK_AREA = SOURCE.START_CURR_WORK_AREA,
                        	TARGET.LTST_START_DATE_TIME = SOURCE.LTST_START_DATE_TIME,
                        	TARGET.START_DEST_WORK_GRP = SOURCE.START_DEST_WORK_GRP,
                        	TARGET.END_CURR_WORK_AREA = SOURCE.END_CURR_WORK_AREA,
                        	TARGET.START_DEST_WORK_AREA = SOURCE.START_DEST_WORK_AREA,
                        	TARGET.NEED_ID = SOURCE.NEED_ID,
                        	TARGET.TASK_ID = SOURCE.TASK_ID,
                        	TARGET.TASK_GENRTN_REF_NBR = SOURCE.TASK_GENRTN_REF_NBR,
                        	TARGET.STAT_CODE = SOURCE.STAT_CODE,
                        	TARGET.ESTIMATED_DISTANCE = SOURCE.ESTIMATED_DISTANCE,
                        	TARGET.START_CURR_WORK_GRP = SOURCE.START_CURR_WORK_GRP,
                        	TARGET.BEGIN_AISLE = SOURCE.BEGIN_AISLE,
                        	TARGET.LTST_CMPL_DATE_TIME = SOURCE.LTST_CMPL_DATE_TIME,
                        	TARGET.WHSE = SOURCE.WHSE,
                        	TARGET.WM_VERSION_ID = SOURCE.WM_VERSION_ID,
                        	TARGET.TASK_CMPL_REF_NBR = SOURCE.TASK_CMPL_REF_NBR,
                        	TARGET.PICK_TO_TOTE_FLAG = SOURCE.PICK_TO_TOTE_FLAG,
                        	TARGET.CURR_LOCN_ID = SOURCE.CURR_LOCN_ID,
                        	TARGET.BEGIN_ZONE = SOURCE.BEGIN_ZONE,
                        	TARGET.TASK_PARM_ID = SOURCE.TASK_PARM_ID,
                        	TARGET.REPRINT_COUNT = SOURCE.REPRINT_COUNT,
                        	TARGET.MOD_DATE_TIME = SOURCE.MOD_DATE_TIME,
                        	TARGET.END_DEST_WORK_GRP = SOURCE.END_DEST_WORK_GRP,
                        	TARGET.ONE_USER_PER_GRP = SOURCE.ONE_USER_PER_GRP,
                        	TARGET.XPECTD_DURTN = SOURCE.XPECTD_DURTN,
                        	TARGET.END_AISLE = SOURCE.END_AISLE,
                        	TARGET.DFLT_TASK_PRTY = SOURCE.DFLT_TASK_PRTY,
                        	TARGET.INVN_NEED_TYPE = SOURCE.INVN_NEED_TYPE,
                        	TARGET.BEGIN_AREA = SOURCE.BEGIN_AREA,
                        	TARGET.RPT_PRTR_REQSTR = SOURCE.RPT_PRTR_REQSTR,
                        	TARGET.INVN_TYPE = SOURCE.INVN_TYPE,
                        	TARGET.EXCEPTION_CODE = SOURCE.EXCEPTION_CODE,
                        	TARGET.CURR_USER_ID = SOURCE.CURR_USER_ID,
                        	TARGET.END_ZONE = SOURCE.END_ZONE,
                        	TARGET.TASK_CMPL_REF_CODE = SOURCE.TASK_CMPL_REF_CODE,
                        	TARGET.RLS_DATE_TIME = SOURCE.RLS_DATE_TIME,
                        	TARGET.NEXT_TASK_ID = SOURCE.NEXT_TASK_ID,
                        	TARGET.ACTL_DURTN = SOURCE.ACTL_DURTN,
                        	TARGET.ARCHIVE_DTTM = SOURCE.ARCHIVE_DTTM,
                        	TARGET.MHE_ORD_STATE = SOURCE.MHE_ORD_STATE,
                        	TARGET._FIVETRAN_DELETED = SOURCE._FIVETRAN_DELETED,
                        	TARGET._FIVETRAN_SYNCED = SOURCE._FIVETRAN_SYNCED
        WHEN NOT MATCHED 
        THEN
        INSERT
        (
            TASK_HDR_ID,
            ESTIMATED_TIME,
            USER_ID,
            PRT_TASK_LIST_FLAG,
            VOCO_INTRNL_REVERSE_ID,
            TASK_GENRTN_REF_CODE,
            CREATE_DATE_TIME,
            END_CURR_WORK_GRP,
            LOCN_HDR_ID,
            END_DEST_WORK_AREA,
            ERLST_START_DATE_TIME,
            MHE_FLAG,
            TASK_DESC,
            TASK_TYPE,
            DOC_ID,
            PICK_CART_TYPE,
            CURR_TASK_PRTY,
            RULE_ID,
            OWNER_USER_ID,
            ITEM_ID,
            END_AREA,
            TASK_BATCH,
            VOCOLLECT_ASSIGN_ID,
            TASK_RULE_PARM_ID,
            ORIG_TASK_ID,
            START_CURR_WORK_AREA,
            LTST_START_DATE_TIME,
            START_DEST_WORK_GRP,
            END_CURR_WORK_AREA,
            START_DEST_WORK_AREA,
            NEED_ID,
            TASK_ID,
            TASK_GENRTN_REF_NBR,
            STAT_CODE,
            ESTIMATED_DISTANCE,
            START_CURR_WORK_GRP,
            BEGIN_AISLE,
            LTST_CMPL_DATE_TIME,
            WHSE,
            WM_VERSION_ID,
            TASK_CMPL_REF_NBR,
            PICK_TO_TOTE_FLAG,
            CURR_LOCN_ID,
            BEGIN_ZONE,
            TASK_PARM_ID,
            REPRINT_COUNT,
            MOD_DATE_TIME,
            END_DEST_WORK_GRP,
            ONE_USER_PER_GRP,
            XPECTD_DURTN,
            END_AISLE,
            DFLT_TASK_PRTY,
            INVN_NEED_TYPE,
            BEGIN_AREA,
            RPT_PRTR_REQSTR,
            INVN_TYPE,
            EXCEPTION_CODE,
            CURR_USER_ID,
            END_ZONE,
            TASK_CMPL_REF_CODE,
            RLS_DATE_TIME,
            NEXT_TASK_ID,
            ACTL_DURTN,
            ARCHIVE_DTTM,
            MHE_ORD_STATE,
            _FIVETRAN_DELETED,
            _FIVETRAN_SYNCED
        )
        VALUES
        (
            SOURCE.TASK_HDR_ID,
            SOURCE.ESTIMATED_TIME,
            SOURCE.USER_ID,
            SOURCE.PRT_TASK_LIST_FLAG,
            SOURCE.VOCO_INTRNL_REVERSE_ID,
            SOURCE.TASK_GENRTN_REF_CODE,
            SOURCE.CREATE_DATE_TIME,
            SOURCE.END_CURR_WORK_GRP,
            SOURCE.LOCN_HDR_ID,
            SOURCE.END_DEST_WORK_AREA,
            SOURCE.ERLST_START_DATE_TIME,
            SOURCE.MHE_FLAG,
            SOURCE.TASK_DESC,
            SOURCE.TASK_TYPE,
            SOURCE.DOC_ID,
            SOURCE.PICK_CART_TYPE,
            SOURCE.CURR_TASK_PRTY,
            SOURCE.RULE_ID,
            SOURCE.OWNER_USER_ID,
            SOURCE.ITEM_ID,
            SOURCE.END_AREA,
            SOURCE.TASK_BATCH,
            SOURCE.VOCOLLECT_ASSIGN_ID,
            SOURCE.TASK_RULE_PARM_ID,
            SOURCE.ORIG_TASK_ID,
            SOURCE.START_CURR_WORK_AREA,
            SOURCE.LTST_START_DATE_TIME,
            SOURCE.START_DEST_WORK_GRP,
            SOURCE.END_CURR_WORK_AREA,
            SOURCE.START_DEST_WORK_AREA,
            SOURCE.NEED_ID,
            SOURCE.TASK_ID,
            SOURCE.TASK_GENRTN_REF_NBR,
            SOURCE.STAT_CODE,
            SOURCE.ESTIMATED_DISTANCE,
            SOURCE.START_CURR_WORK_GRP,
            SOURCE.BEGIN_AISLE,
            SOURCE.LTST_CMPL_DATE_TIME,
            SOURCE.WHSE,
            SOURCE.WM_VERSION_ID,
            SOURCE.TASK_CMPL_REF_NBR,
            SOURCE.PICK_TO_TOTE_FLAG,
            SOURCE.CURR_LOCN_ID,
            SOURCE.BEGIN_ZONE,
            SOURCE.TASK_PARM_ID,
            SOURCE.REPRINT_COUNT,
            SOURCE.MOD_DATE_TIME,
            SOURCE.END_DEST_WORK_GRP,
            SOURCE.ONE_USER_PER_GRP,
            SOURCE.XPECTD_DURTN,
            SOURCE.END_AISLE,
            SOURCE.DFLT_TASK_PRTY,
            SOURCE.INVN_NEED_TYPE,
            SOURCE.BEGIN_AREA,
            SOURCE.RPT_PRTR_REQSTR,
            SOURCE.INVN_TYPE,
            SOURCE.EXCEPTION_CODE,
            SOURCE.CURR_USER_ID,
            SOURCE.END_ZONE,
            SOURCE.TASK_CMPL_REF_CODE,
            SOURCE.RLS_DATE_TIME,
            SOURCE.NEXT_TASK_ID,
            SOURCE.ACTL_DURTN,
            SOURCE.ARCHIVE_DTTM,
            SOURCE.MHE_ORD_STATE,
            SOURCE._FIVETRAN_DELETED,
            SOURCE._FIVETRAN_SYNCED
        );
        RETURN ('SUCCESS');
    END;


