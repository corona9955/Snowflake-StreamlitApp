------------------- RL--------------
create or replace view RL.WM.WM_INVENTORY
as
SELECT 
	WM_INVENTORY_ID,
	WM_VERSION_ID,
	WM_ALLOCATED_QTY,
	TRANSITIONAL_INVENTORY_TYPE,
	TO_BE_FILLED_QTY,
	TO_BE_CONSOLIDATED_QTY,
	TC_LPN_ID,
	TC_COMPANY_ID,
	SUB_PACK_QTY,
	RECALL_ID,
	PRODUCT_STATUS,
	PACK_QTY,
	ON_HAND_QTY,
	MARKED_FOR_DELETE,
	LPN_ID,
	LPN_DETAIL_ID,
	LOCN_CLASS,
	LOCATION_ID,
	LOCATION_DTL_ID,
	LAST_UPDATED_SOURCE,
	LAST_UPDATED_SOURCE_TYPE,
	LAST_UPDATED_DTTM,
	ITEM_ID,
	ITEM_ATTR_5,
	ITEM_ATTR_4,
	ITEM_ATTR_3,
	ITEM_ATTR_2,
	ITEM_ATTR_1,
	INVENTORY_TYPE,
	INBOUND_OUTBOUND_INDICATOR,
	CUMULATIVE_QTY,
	CREATED_SOURCE,
	CREATED_SOURCE_TYPE,
	CREATED_DTTM,
	CNTRY_OF_ORGN,
	C_FACILITY_ID,
	BATCH_NBR,
    CAST(NULL AS TIMESTAMP_NTZ) AS ARCHIVE_DTTM,
	ALLOCATABLE,
	_FIVETRAN_SYNCED,
	_FIVETRAN_DELETED,
 'GOLD' XB_ENVIRONMENT
 FROM XBPRDWMGOLD.PRD_GOLD_GA_XBWM19WM.WM_INVENTORY
 WHERE C_FACILITY_ID <> '263'
UNION ALL
 SELECT 
	WM_INVENTORY_ID,
	WM_VERSION_ID,
	WM_ALLOCATED_QTY,
	TRANSITIONAL_INVENTORY_TYPE,
	TO_BE_FILLED_QTY,
	TO_BE_CONSOLIDATED_QTY,
	TC_LPN_ID,
	TC_COMPANY_ID,
	SUB_PACK_QTY,
	RECALL_ID,
	PRODUCT_STATUS,
	PACK_QTY,
	ON_HAND_QTY,
	MARKED_FOR_DELETE,
	LPN_ID,
	LPN_DETAIL_ID,
	LOCN_CLASS,
	LOCATION_ID,
	LOCATION_DTL_ID,
	LAST_UPDATED_SOURCE,
	LAST_UPDATED_SOURCE_TYPE,
	LAST_UPDATED_DTTM,
	ITEM_ID,
	ITEM_ATTR_5,
	ITEM_ATTR_4,
	ITEM_ATTR_3,
	ITEM_ATTR_2,
	ITEM_ATTR_1,
	INVENTORY_TYPE,
	INBOUND_OUTBOUND_INDICATOR,
	CUMULATIVE_QTY,
	CREATED_SOURCE,
	CREATED_SOURCE_TYPE,
	CREATED_DTTM,
	CNTRY_OF_ORGN,
	C_FACILITY_ID,
	BATCH_NBR,
    CAST(NULL AS TIMESTAMP_NTZ) AS ARCHIVE_DTTM,
	ALLOCATABLE,
	_FIVETRAN_SYNCED,
	_FIVETRAN_DELETED,
 'SILVER' XB_ENVIRONMENT
 FROM XBPRDWMSILVER.PRD_SILVER_GA_XBDBTJ3WM.WM_INVENTORY
 WHERE C_FACILITY_ID not in ('51','61')
UNION ALL
 SELECT 
	WM_INVENTORY_ID,
	WM_VERSION_ID,
	WM_ALLOCATED_QTY,
	TRANSITIONAL_INVENTORY_TYPE,
	TO_BE_FILLED_QTY,
	TO_BE_CONSOLIDATED_QTY,
	TC_LPN_ID,
	TC_COMPANY_ID,
	SUB_PACK_QTY,
	RECALL_ID,
	PRODUCT_STATUS,
	PACK_QTY,
	ON_HAND_QTY,
	MARKED_FOR_DELETE,
	LPN_ID,
	LPN_DETAIL_ID,
	LOCN_CLASS,
	LOCATION_ID,
	LOCATION_DTL_ID,
	LAST_UPDATED_SOURCE,
	LAST_UPDATED_SOURCE_TYPE,
	LAST_UPDATED_DTTM,
	ITEM_ID,
	ITEM_ATTR_5,
	ITEM_ATTR_4,
	ITEM_ATTR_3,
	ITEM_ATTR_2,
	ITEM_ATTR_1,
	INVENTORY_TYPE,
	INBOUND_OUTBOUND_INDICATOR,
	CUMULATIVE_QTY,
	CREATED_SOURCE,
	CREATED_SOURCE_TYPE,
	CREATED_DTTM,
	CNTRY_OF_ORGN,
	C_FACILITY_ID,
	BATCH_NBR,
    CAST(NULL AS TIMESTAMP_NTZ) AS ARCHIVE_DTTM,
	ALLOCATABLE,
	_FIVETRAN_SYNCED,
	_FIVETRAN_DELETED,
 'RY1' XB_ENVIRONMENT
 FROM XBPRDWMRY.PRD_RY_GA_XBORPRDWM.WM_INVENTORY ;

-------------- ARCHIVE RL--------------
create or replace view RL.WM.ARCH_WM_INVENTORY
as
SELECT 
	WM_INVENTORY_ID,
	WM_VERSION_ID,
	WM_ALLOCATED_QTY,
	TRANSITIONAL_INVENTORY_TYPE,
	TO_BE_FILLED_QTY,
	TO_BE_CONSOLIDATED_QTY,
	TC_LPN_ID,
	TC_COMPANY_ID,
	SUB_PACK_QTY,
	RECALL_ID,
	PRODUCT_STATUS,
	PACK_QTY,
	ON_HAND_QTY,
	MARKED_FOR_DELETE,
	LPN_ID,
	LPN_DETAIL_ID,
	LOCN_CLASS,
	LOCATION_ID,
	LOCATION_DTL_ID,
	LAST_UPDATED_SOURCE,
	LAST_UPDATED_SOURCE_TYPE,
	LAST_UPDATED_DTTM,
	ITEM_ID,
	ITEM_ATTR_5,
	ITEM_ATTR_4,
	ITEM_ATTR_3,
	ITEM_ATTR_2,
	ITEM_ATTR_1,
	INVENTORY_TYPE,
	INBOUND_OUTBOUND_INDICATOR,
	CUMULATIVE_QTY,
	CREATED_SOURCE,
	CREATED_SOURCE_TYPE,
	CREATED_DTTM,
	CNTRY_OF_ORGN,
	C_FACILITY_ID,
	BATCH_NBR,
    ARCHIVE_DTTM,
	ALLOCATABLE,
	_FIVETRAN_SYNCED,
	_FIVETRAN_DELETED,
 'GOLD' XB_ENVIRONMENT
 FROM XBPRDARCHGOLD.ARCH_GOLD_G_XBWM19ARCH.WM_INVENTORY
UNION ALL
 SELECT 
	WM_INVENTORY_ID,
	WM_VERSION_ID,
	WM_ALLOCATED_QTY,
	TRANSITIONAL_INVENTORY_TYPE,
	TO_BE_FILLED_QTY,
	TO_BE_CONSOLIDATED_QTY,
	TC_LPN_ID,
	TC_COMPANY_ID,
	SUB_PACK_QTY,
	RECALL_ID,
	PRODUCT_STATUS,
	PACK_QTY,
	ON_HAND_QTY,
	MARKED_FOR_DELETE,
	LPN_ID,
	LPN_DETAIL_ID,
	LOCN_CLASS,
	LOCATION_ID,
	LOCATION_DTL_ID,
	LAST_UPDATED_SOURCE,
	LAST_UPDATED_SOURCE_TYPE,
	LAST_UPDATED_DTTM,
	ITEM_ID,
	ITEM_ATTR_5,
	ITEM_ATTR_4,
	ITEM_ATTR_3,
	ITEM_ATTR_2,
	ITEM_ATTR_1,
	INVENTORY_TYPE,
	INBOUND_OUTBOUND_INDICATOR,
	CUMULATIVE_QTY,
	CREATED_SOURCE,
	CREATED_SOURCE_TYPE,
	CREATED_DTTM,
	CNTRY_OF_ORGN,
	C_FACILITY_ID,
	BATCH_NBR,
    ARCHIVE_DTTM,
	ALLOCATABLE,
	_FIVETRAN_SYNCED,
	_FIVETRAN_DELETED,
 'SILVER' XB_ENVIRONMENT
 FROM XBPRDARCHSILVER.ARCH_SILVER_G_XBWM19ARCH.WM_INVENTORY
UNION ALL
 SELECT 
	WM_INVENTORY_ID,
	WM_VERSION_ID,
	WM_ALLOCATED_QTY,
	TRANSITIONAL_INVENTORY_TYPE,
	TO_BE_FILLED_QTY,
	TO_BE_CONSOLIDATED_QTY,
	TC_LPN_ID,
	TC_COMPANY_ID,
	SUB_PACK_QTY,
	RECALL_ID,
	PRODUCT_STATUS,
	PACK_QTY,
	ON_HAND_QTY,
	MARKED_FOR_DELETE,
	LPN_ID,
	LPN_DETAIL_ID,
	LOCN_CLASS,
	LOCATION_ID,
	LOCATION_DTL_ID,
	LAST_UPDATED_SOURCE,
	LAST_UPDATED_SOURCE_TYPE,
	LAST_UPDATED_DTTM,
	ITEM_ID,
	ITEM_ATTR_5,
	ITEM_ATTR_4,
	ITEM_ATTR_3,
	ITEM_ATTR_2,
	ITEM_ATTR_1,
	INVENTORY_TYPE,
	INBOUND_OUTBOUND_INDICATOR,
	CUMULATIVE_QTY,
	CREATED_SOURCE,
	CREATED_SOURCE_TYPE,
	CREATED_DTTM,
	CNTRY_OF_ORGN,
	C_FACILITY_ID,
	BATCH_NBR,
    ARCHIVE_DTTM,
	ALLOCATABLE,
	_FIVETRAN_SYNCED,
	_FIVETRAN_DELETED,
 'RY1' XB_ENVIRONMENT
 FROM XBPRDARCHREYNOSA.ARCHIVE_REYNOSA_XBORPRDARCH.WM_INVENTORY ;


-------------------- QA_BI UNION --------------
create or replace view QA_BI.WM.VW_WM_INVENTORY_ 
AS
SELECT WM_INVENTORY.*
FROM
(
SELECT
WM_INVENTORY_ID,
	WM_VERSION_ID,
	WM_ALLOCATED_QTY,
	TRANSITIONAL_INVENTORY_TYPE,
	TO_BE_FILLED_QTY,
	TO_BE_CONSOLIDATED_QTY,
	TC_LPN_ID,
	TC_COMPANY_ID,
	SUB_PACK_QTY,
	RECALL_ID,
	PRODUCT_STATUS,
	PACK_QTY,
	ON_HAND_QTY,
	MARKED_FOR_DELETE,
	LPN_ID,
	LPN_DETAIL_ID,
	LOCN_CLASS,
	LOCATION_ID,
	LOCATION_DTL_ID,
	LAST_UPDATED_SOURCE,
	LAST_UPDATED_SOURCE_TYPE,
	LAST_UPDATED_DTTM,
	ITEM_ID,
	ITEM_ATTR_5,
	ITEM_ATTR_4,
	ITEM_ATTR_3,
	ITEM_ATTR_2,
	ITEM_ATTR_1,
	INVENTORY_TYPE,
	INBOUND_OUTBOUND_INDICATOR,
	CUMULATIVE_QTY,
	CREATED_SOURCE,
	CREATED_SOURCE_TYPE,
	CREATED_DTTM,
	CNTRY_OF_ORGN,
	C_FACILITY_ID,
	BATCH_NBR,
    ARCHIVE_DTTM,
	ALLOCATABLE,
	_FIVETRAN_SYNCED,
	_FIVETRAN_DELETED,
    XB_ENVIRONMENT
FROM RL.WM.WM_INVENTORY
UNION
SELECT
WM_INVENTORY_ID,
	WM_VERSION_ID,
	WM_ALLOCATED_QTY,
	TRANSITIONAL_INVENTORY_TYPE,
	TO_BE_FILLED_QTY,
	TO_BE_CONSOLIDATED_QTY,
	TC_LPN_ID,
	TC_COMPANY_ID,
	SUB_PACK_QTY,
	RECALL_ID,
	PRODUCT_STATUS,
	PACK_QTY,
	ON_HAND_QTY,
	MARKED_FOR_DELETE,
	LPN_ID,
	LPN_DETAIL_ID,
	LOCN_CLASS,
	LOCATION_ID,
	LOCATION_DTL_ID,
	LAST_UPDATED_SOURCE,
	LAST_UPDATED_SOURCE_TYPE,
	LAST_UPDATED_DTTM,
	ITEM_ID,
	ITEM_ATTR_5,
	ITEM_ATTR_4,
	ITEM_ATTR_3,
	ITEM_ATTR_2,
	ITEM_ATTR_1,
	INVENTORY_TYPE,
	INBOUND_OUTBOUND_INDICATOR,
	CUMULATIVE_QTY,
	CREATED_SOURCE,
	CREATED_SOURCE_TYPE,
	CREATED_DTTM,
	CNTRY_OF_ORGN,
	C_FACILITY_ID,
	BATCH_NBR,
    ARCHIVE_DTTM,
	ALLOCATABLE,
	_FIVETRAN_SYNCED,
	_FIVETRAN_DELETED,
    XB_ENVIRONMENT
    FROM RL.WM.ARCH_WM_INVENTORY
) WM_INVENTORY
INNER JOIN QA_BI.WM.VW_CAT_COMPANY CAT_COMPANY ON WM_INVENTORY.TC_COMPANY_ID = CAT_COMPANY.COMPANY_ID
;
